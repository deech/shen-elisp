;;; shen-elisp.el --- An implementation of the Shen programming language  -*- lexical-binding: t -*-

;; Copyright (C) 2015-2018  Aditya Siram

;; Author: Aditya Siram <aditya.siram@gmail.com>
;; Homepage: https://github.com/deech/shen-elisp
;; License: BSD 3-Clause License
;;   http://opensource.org/licenses/BSD-3-Clause

;;; Commentary:

;; This is an implemenatation of the Shen programming language in
;; Elisp. The end goal is to provide:
;;
;; 1. An easy way to play with Shen with no other installation
;;    hassle (assuming you use Emacs).
;; 2. A first-class development experience when writing Shen.
;;    The idea is that an editor that understands the code can
;;    be much more helpful than one that does not. To this end
;;    the roadmap involves a full gamut of source code
;;    introspection and debugging tools.

;;; Code:

(require 'shen-primitives)
(setq max-lisp-eval-depth 60000)
(setq max-specpdl-size 13000)

(defun shen/thaw (V3807)
  (shen/internal/apply-higher-order-function V3807 (list)))
(defun shen/eval (V3808)
  (shen/eval-kl
   (shen/shen.shen->kl
    (shen/shen.process-applications (shen/macroexpand V3808)
                                    (shen/shen.find-types V3808)))))
(defun shen/external (V3809)
  (shen/cond ((shen/= 'null V3809) nil)
             (shen/true
              (shen/trap-error
               (shen/get V3809 'shen.external-symbols
                         (shen/value '*property-vector*))
               (shen/lambda Z3810
                            (shen/simple-error
                             (shen/cn "package "
                                      (shen/shen.app V3809 " does not exist.\n;"
                                                     'shen.a))))))))
(defun shen/internal (V3811)
  (shen/cond ((shen/= 'null V3811) nil)
             (shen/true
              (shen/trap-error
               (shen/get V3811 'shen.internal-symbols
                         (shen/value '*property-vector*))
               (shen/lambda Z3812
                            (shen/simple-error
                             (shen/cn "package "
                                      (shen/shen.app V3811 " does not exist.\n;"
                                                     'shen.a))))))))
(defun shen/fail-if (V3813 V3814)
  (shen/if (shen/internal/apply-higher-order-function V3813 (list V3814))
           (shen/fail) V3814))
(defun shen/@s (V3815 V3816) (shen/cn V3815 V3816))
(defun shen/tc? nil (shen/value 'shen.*tc*))
(defun shen/ps (V3817)
  (shen/trap-error (shen/get V3817 'shen.source (shen/value '*property-vector*))
                   (shen/lambda Z3818
                                (shen/simple-error
                                 (shen/shen.app V3817 " not found.\n" 'shen.a)))))
(defun shen/stinput nil (shen/value '*stinput*))
(defun shen/vector (V3819)
  (shen/let W3820 (shen/absvector (1+ V3819))
            (shen/let W3821 (shen/address-> W3820 0 V3819)
                      (shen/let W3822
                                (shen/if (shen/= V3819 0) W3821
                                         (shen/shen.fillvector W3821 1 V3819
                                                               (shen/fail)))
                                W3822))))
(defun shen/shen.fillvector (V3824 V3825 V3826 V3827)
  (cl-flet
      ((tail-trampoline (V3824 V3825 V3826 V3827)
         (shen/cond ((shen/= V3825 V3826) (shen/address-> V3824 V3826 V3827))
                    (shen/true
                     (vector
                      (list (shen/address-> V3824 V3825 V3827) (1+ V3825) V3826
                            V3827))))))
    (let ((result (funcall #'tail-trampoline V3824 V3825 V3826 V3827)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/vector? (V3828)
  (shen/and (shen/absvector? V3828)
            (shen/let W3829
                      (shen/trap-error (shen/<-address V3828 0)
                                       (shen/lambda Z3830 -1))
                      (shen/and (shen/number? W3829) (shen/>= W3829 0)))))
(defun shen/vector-> (V3831 V3832 V3833)
  (shen/if (shen/= V3832 0)
           (shen/simple-error "cannot access 0th element of a vector\n")
           (shen/address-> V3831 V3832 V3833)))
(defun shen/<-vector (V3834 V3835)
  (shen/if (shen/= V3835 0)
           (shen/simple-error "cannot access 0th element of a vector\n")
           (shen/let W3836 (shen/<-address V3834 V3835)
                     (shen/if (shen/= W3836 (shen/fail))
                              (shen/simple-error "vector element not found\n")
                              W3836))))
(defun shen/shen.posint? (V3837)
  (shen/and (shen/integer? V3837) (shen/>= V3837 0)))
(defun shen/limit (V3838) (shen/<-address V3838 0))
(defun shen/symbol? (V3839)
  (shen/cond
   ((shen/or (shen/boolean? V3839)
             (shen/or (shen/number? V3839)
                      (shen/or (shen/string? V3839)
                               (shen/or (shen/cons? V3839)
                                        (shen/or (shen/empty? V3839)
                                                 (shen/vector? V3839))))))
    'false)
   ((shen/element? V3839
                   (list '{ '} (shen/intern ":") (shen/intern ";")
                         (shen/intern ",")))
    'true)
   (shen/true
    (shen/trap-error
     (shen/let W3840 (shen/str V3839) (shen/shen.analyse-symbol? W3840))
     (shen/lambda Z3841 'false)))))
(defun shen/shen.analyse-symbol? (V3844)
  (shen/cond
   ((shen/shen.+string? V3844)
    (shen/and (shen/shen.alpha? (shen/string->n (shen/hdstr V3844)))
              (shen/shen.alphanums? (shen/tlstr V3844))))
   (shen/true (shen/simple-error "implementation error in shen.analyse-symbol?"))))
(defun shen/shen.alphanums? (V3847)
  (shen/cond ((shen/= "" V3847) 'true)
             ((shen/shen.+string? V3847)
              (shen/let W3848 (shen/string->n (shen/hdstr V3847))
                        (shen/and
                         (shen/or (shen/shen.alpha? W3848)
                                  (shen/shen.digit? W3848))
                         (shen/shen.alphanums? (shen/tlstr V3847)))))
             (shen/true
              (shen/simple-error "implementation error in shen.alphanums?"))))
(defun shen/variable? (V3849)
  (shen/cond
   ((shen/or (shen/boolean? V3849)
             (shen/or (shen/number? V3849) (shen/string? V3849)))
    'false)
   (shen/true
    (shen/trap-error
     (shen/let W3850 (shen/str V3849) (shen/shen.analyse-variable? W3850))
     (shen/lambda Z3851 'false)))))
(defun shen/shen.analyse-variable? (V3854)
  (shen/cond
   ((shen/shen.+string? V3854)
    (shen/and (shen/shen.uppercase? (shen/string->n (shen/hdstr V3854)))
              (shen/shen.alphanums? (shen/tlstr V3854))))
   (shen/true
    (shen/simple-error "implementation error in shen.analyse-variable?"))))
(defun shen/gensym (V3855)
  (shen/concat V3855 (shen/set 'shen.*gensym* (1+ (shen/value 'shen.*gensym*)))))
(defun shen/concat (V3856 V3857)
  (shen/intern (shen/cn (shen/str V3856) (shen/str V3857))))
(defun shen/@p (V3858 V3859)
  (shen/let W3860 (shen/absvector 3)
            (shen/let W3861 (shen/address-> W3860 0 'shen.tuple)
                      (shen/let W3862 (shen/address-> W3860 1 V3858)
                                (shen/let W3863 (shen/address-> W3860 2 V3859)
                                          W3860)))))
(defun shen/fst (V3864) (shen/<-address V3864 1))
(defun shen/snd (V3865) (shen/<-address V3865 2))
(defun shen/tuple? (V3866)
  (shen/and (shen/absvector? V3866)
            (shen/= 'shen.tuple
                    (shen/trap-error (shen/<-address V3866 0)
                                     (shen/lambda Z3867 'shen.not-tuple)))))
(defun shen/append (Xs Ys) (append Xs Ys))
(defun shen/@v (V3874 V3875)
  (shen/let W3876 (shen/limit V3875)
            (shen/let W3877 (shen/vector (1+ W3876))
                      (shen/let W3878 (shen/vector-> W3877 1 V3874)
                                (shen/if (shen/= W3876 0) W3878
                                         (shen/shen.@v-help V3875 1 W3876 W3878))))))
(defun shen/shen.@v-help (V3880 V3881 V3882 V3883)
  (cl-flet
      ((tail-trampoline (V3880 V3881 V3882 V3883)
         (shen/cond
          ((shen/= V3881 V3882)
           (shen/shen.copyfromvector V3880 V3883 V3882 (1+ V3882)))
          (shen/true
           (vector
            (list V3880 (1+ V3881) V3882
                  (shen/shen.copyfromvector V3880 V3883 V3881 (1+ V3881))))))))
    (let ((result (funcall #'tail-trampoline V3880 V3881 V3882 V3883)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.copyfromvector (V3884 V3885 V3886 V3887)
  (shen/trap-error (shen/vector-> V3885 V3887 (shen/<-vector V3884 V3886))
                   (shen/lambda Z3888 V3885)))
(defun shen/hdv (V3889)
  (shen/trap-error (shen/<-vector V3889 1)
                   (shen/lambda Z3890
                                (shen/simple-error
                                 "hdv needs a non-empty vector as an argument\n"))))
(defun shen/tlv (V3891)
  (shen/let W3892 (shen/limit V3891)
            (shen/if (shen/= W3892 0)
                     (shen/simple-error
                      "cannot take the tail of the empty vector\n")
                     (shen/if (shen/= W3892 1) (shen/vector 0)
                              (shen/let W3893 (shen/vector (shen/- W3892 1))
                                        (shen/shen.tlv-help V3891 2 W3892
                                                            (shen/vector
                                                             (shen/- W3892 1))))))))
(defun shen/shen.tlv-help (V3895 V3896 V3897 V3898)
  (cl-flet
      ((tail-trampoline (V3895 V3896 V3897 V3898)
         (shen/cond
          ((shen/= V3896 V3897)
           (shen/shen.copyfromvector V3895 V3898 V3897 (shen/- V3897 1)))
          (shen/true
           (vector
            (list V3895 (1+ V3896) V3897
                  (shen/shen.copyfromvector V3895 V3898 V3896 (shen/- V3896 1))))))))
    (let ((result (funcall #'tail-trampoline V3895 V3896 V3897 V3898)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/assoc (V3910 V3911)
  (cl-flet
      ((tail-trampoline (V3910 V3911)
         (shen/cond ((shen/internal/predicate->shen (null V3911)) nil)
                    ((shen/and (shen/cons? V3911)
                               (shen/and (shen/cons? (shen/hd V3911))
                                         (shen/= V3910 (shen/hd (shen/hd V3911)))))
                     (shen/hd V3911))
                    ((shen/cons? V3911) (vector (list V3910 (nthcdr 1 V3911))))
                    (shen/true
                     (shen/simple-error
                      "attempt to search a non-list with assoc\n")))))
    (let ((result (funcall #'tail-trampoline V3910 V3911)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.assoc-set (V3915 V3916 V3917)
  (shen/cond
   ((shen/internal/predicate->shen (null V3917))
    (list (append (list V3915) V3916)))
   ((shen/and (shen/cons? V3917)
              (shen/and (shen/cons? (shen/hd V3917))
                        (shen/= V3915 (shen/hd (shen/hd V3917)))))
    (append (list (append (list (shen/hd (shen/hd V3917))) V3916))
            (nthcdr 1 V3917)))
   ((shen/cons? V3917)
    (append (list (shen/hd V3917))
            (shen/shen.assoc-set V3915 V3916 (nthcdr 1 V3917))))
   (shen/true (shen/shen.f-error 'shen.assoc-set))))
(defun shen/shen.assoc-rm (V3921 V3922)
  (shen/cond ((shen/internal/predicate->shen (null V3922)) nil)
             ((shen/and (shen/cons? V3922)
                        (shen/and (shen/cons? (shen/hd V3922))
                                  (shen/= V3921 (shen/hd (shen/hd V3922)))))
              (nthcdr 1 V3922))
             ((shen/cons? V3922)
              (append (list (shen/hd V3922))
                      (shen/shen.assoc-rm V3921 (nthcdr 1 V3922))))
             (shen/true (shen/shen.f-error 'shen.assoc-rm))))
(defun shen/boolean? (V3925)
  (shen/cond ((shen/= 'true V3925) 'true) ((shen/= 'false V3925) 'true)
             (shen/true 'false)))
(defun shen/nl (V3926)
  (cl-flet
      ((tail-trampoline (V3926)
         (shen/cond ((shen/= 0 V3926) 0)
                    (shen/true
                     (shen/do (shen/pr "\n" (shen/stoutput))
                              (vector (list (shen/- V3926 1))))))))
    (let ((result (funcall #'tail-trampoline V3926)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/difference (V3933 V3934)
  (cl-flet
      ((tail-trampoline (V3933 V3934)
         (shen/cond ((shen/internal/predicate->shen (null V3933)) nil)
                    ((shen/cons? V3933)
                     (shen/if (shen/element? (shen/hd V3933) V3934)
                              (vector (list (nthcdr 1 V3933) V3934))
                              (append (list (shen/hd V3933))
                                      (shen/difference (nthcdr 1 V3933) V3934))))
                    (shen/true
                     (shen/simple-error
                      "attempt to find the difference with a non-list\n")))))
    (let ((result (funcall #'tail-trampoline V3933 V3934)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/do (V3935 V3936) V3936)
(defun shen/element? (Element Xs)
  (let ((SearchList Xs) (Found nil) (Length (length Xs)) (Current 0))
    (while (and (not Found) SearchList)
      (setq Found (shen/internal/= Element (pop SearchList))))
    (shen/internal/predicate->shen Found)))
(defun shen/empty? (V3952)
  (shen/cond ((shen/internal/predicate->shen (null V3952)) 'true)
             (shen/true 'false)))
(defun shen/fix (V3953 V3954)
  (shen/shen.fix-help V3953 V3954
                      (shen/internal/apply-higher-order-function V3953
                                                                 (list V3954))))
(defun shen/shen.fix-help (V3960 V3961 V3962)
  (cl-flet
      ((tail-trampoline (V3960 V3961 V3962)
         (shen/cond ((shen/= V3961 V3962) V3962)
                    (shen/true
                     (vector
                      (list V3960 V3962
                            (shen/internal/apply-higher-order-function V3960
                                                                       (list
                                                                        V3962))))))))
    (let ((result (funcall #'tail-trampoline V3960 V3961 V3962)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/put (X Pointer Y Dict)
  (let*
      ((Contents (shen/<-address Dict 3))
       (X-Contents (shen/<-address Contents X)))
    (if X-Contents (progn (puthash Pointer Y X-Contents) Y)
      (progn
        (setq X-Contents (shen/absvector 100)) (puthash X X-Contents Contents)
        (puthash Pointer Y X-Contents) Y))))
(defun shen/unput (X Pointer Dict)
  (let*
      ((Contents (shen/<-address Dict 3))
       (X-Contents (shen/<-address Contents X)))
    (progn (if X-Contents (remhash Pointer X-Contents)) X)))
(defun shen/get (X Pointer Dict)
  (let*
      ((Contents (shen/<-address Dict 3))
       (X-Contents (shen/<-address Contents X))
       (Pointer-Contents (if X-Contents (shen/<-address X-Contents Pointer))))
    (if (not Pointer-Contents) (shen/simple-error "value not found")
      Pointer-Contents)))
(defun shen/hash (N Div) (sxhash N))
(defun shen/shen.hashkey (V3987)
  (shen/let W3988
            (shen/map (shen/lambda Z3989 (shen/string->n Z3989))
                      (shen/explode V3987))
            (shen/shen.prodbutzero W3988 1)))
(defun shen/shen.prodbutzero (V3990 V3991)
  (cl-flet
      ((tail-trampoline (V3990 V3991)
         (shen/cond ((shen/internal/predicate->shen (null V3990)) V3991)
                    ((shen/and (shen/cons? V3990) (shen/= 0 (shen/hd V3990)))
                     (vector (list (nthcdr 1 V3990) V3991)))
                    ((shen/cons? V3990)
                     (shen/if (shen/> V3991 10000000000)
                              (vector
                               (list (nthcdr 1 V3990)
                                     (shen/+ V3991 (shen/hd V3990))))
                              (vector
                               (list (nthcdr 1 V3990)
                                     (shen/* V3991 (shen/hd V3990))))))
                    (shen/true (shen/shen.f-error 'shen.prodbutzero)))))
    (let ((result (funcall #'tail-trampoline V3990 V3991)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.mod (N Div) (mod N Div))
(defun shen/shen.multiples (V3998 V3999)
  (cl-flet
      ((tail-trampoline (V3998 V3999)
         (shen/cond
          ((shen/and (shen/cons? V3999) (shen/> (shen/hd V3999) V3998))
           (nthcdr 1 V3999))
          ((shen/cons? V3999)
           (vector (list V3998 (append (list (shen/* 2 (shen/hd V3999))) V3999))))
          (shen/true
           (shen/simple-error "implementation error in shen.multiples")))))
    (let ((result (funcall #'tail-trampoline V3998 V3999)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.modh (V4006 V4007)
  (cl-flet
      ((tail-trampoline (V4006 V4007)
         (shen/cond ((shen/= 0 V4006) 0)
                    ((shen/internal/predicate->shen (null V4007)) V4006)
                    ((shen/and (shen/cons? V4007) (shen/> (shen/hd V4007) V4006))
                     (shen/if (shen/empty? (nthcdr 1 V4007)) V4006
                              (vector (list V4006 (nthcdr 1 V4007)))))
                    ((shen/cons? V4007)
                     (vector (list (shen/- V4006 (shen/hd V4007)) V4007)))
                    (shen/true
                     (shen/simple-error "implementation error in shen.modh")))))
    (let ((result (funcall #'tail-trampoline V4006 V4007)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/sum (Xs) (apply #'+ Xs))
(defun shen/head (V4015)
  (shen/cond ((shen/cons? V4015) (shen/hd V4015))
             (shen/true (shen/simple-error "head expects a non-empty list\n"))))
(defun shen/tail (V4020)
  (shen/cond ((shen/cons? V4020) (nthcdr 1 V4020))
             (shen/true (shen/simple-error "tail expects a non-empty list\n"))))
(defun shen/hdstr (V4021) (shen/pos V4021 0))
(defun shen/intersection (V4028 V4029)
  (cl-flet
      ((tail-trampoline (V4028 V4029)
         (shen/cond ((shen/internal/predicate->shen (null V4028)) nil)
                    ((shen/cons? V4028)
                     (shen/if (shen/element? (shen/hd V4028) V4029)
                              (append (list (shen/hd V4028))
                                      (shen/intersection (nthcdr 1 V4028) V4029))
                              (vector (list (nthcdr 1 V4028) V4029))))
                    (shen/true
                     (shen/simple-error
                      "attempt to find the intersection with a non-list\n")))))
    (let ((result (funcall #'tail-trampoline V4028 V4029)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/reverse (V4030) (shen/shen.reverse-help V4030 nil))
(defun shen/shen.reverse-help (V4035 V4036)
  (cl-flet
      ((tail-trampoline (V4035 V4036)
         (shen/cond ((shen/internal/predicate->shen (null V4035)) V4036)
                    ((shen/cons? V4035)
                     (vector
                      (list (nthcdr 1 V4035)
                            (append (list (shen/hd V4035)) V4036))))
                    (shen/true
                     (shen/simple-error "attempt to reverse a non-list\n")))))
    (let ((result (funcall #'tail-trampoline V4035 V4036)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/union (V4041 V4042)
  (cl-flet
      ((tail-trampoline (V4041 V4042)
         (shen/cond ((shen/internal/predicate->shen (null V4041)) V4042)
                    ((shen/cons? V4041)
                     (shen/if (shen/element? (shen/hd V4041) V4042)
                              (vector (list (nthcdr 1 V4041) V4042))
                              (append (list (shen/hd V4041))
                                      (shen/union (nthcdr 1 V4041) V4042))))
                    (shen/true
                     (shen/simple-error
                      "attempt to find the union with a non-list\n")))))
    (let ((result (funcall #'tail-trampoline V4041 V4042)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/y-or-n? (V4043)
  (cl-flet
      ((tail-trampoline (V4043)
         (shen/let W4044 (shen/pr (shen/shen.proc-nl V4043) (shen/stoutput))
                   (shen/let W4045 (shen/pr " (y/n) " (shen/stoutput))
                             (shen/let W4046
                                       (shen/shen.app (shen/read (shen/stinput))
                                                      "" 'shen.s)
                                       (shen/if (shen/= "y" W4046) 'true
                                                (shen/if (shen/= "n" W4046)
                                                         'false
                                                         (shen/do
                                                          (shen/pr
                                                           "please answer y or n\n"
                                                           (shen/stoutput))
                                                          (vector (list V4043))))))))))
    (let ((result (funcall #'tail-trampoline V4043)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/not (V4047) (shen/if V4047 'false 'true))
(defun shen/abort nil (shen/simple-error ""))
(defun shen/subst (V4053 V4054 V4055)
  (shen/cond ((shen/= V4054 V4055) V4053)
             ((shen/cons? V4055)
              (append (list (shen/subst V4053 V4054 (shen/hd V4055)))
                      (shen/subst V4053 V4054 (nthcdr 1 V4055))))
             (shen/true V4055)))
(defun shen/explode (V4056)
  (shen/shen.explode-h (shen/shen.app V4056 "" 'shen.a)))
(defun shen/shen.explode-h (V4059)
  (shen/cond ((shen/= "" V4059) nil)
             ((shen/shen.+string? V4059)
              (append (list (shen/hdstr V4059))
                      (shen/shen.explode-h (shen/tlstr V4059))))
             (shen/true (shen/simple-error "implementation error in explode-h"))))
(defun shen/cd (V4060)
  (shen/set '*home-directory*
            (shen/if (shen/= V4060 "") "" (shen/shen.app V4060 "/" 'shen.a))))
(defun shen/shen.for-each (V4061 V4062)
  (cl-flet
      ((tail-trampoline (V4061 V4062)
         (shen/cond ((shen/internal/predicate->shen (null V4062)) 'true)
                    ((shen/cons? V4062)
                     (shen/let W4063
                               (shen/internal/apply-higher-order-function V4061
                                                                          (list
                                                                           (shen/hd
                                                                            V4062)))
                               (vector (list V4061 (nthcdr 1 V4062)))))
                    (shen/true (shen/shen.f-error 'shen.for-each)))))
    (let ((result (funcall #'tail-trampoline V4061 V4062)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/map (F Xs)
  (mapcar (lambda (X) (shen/internal/apply-higher-order-function F (list X))) Xs))
(defun shen/shen.map-h (V4066 V4067 V4068)
  (cl-flet
      ((tail-trampoline (V4066 V4067 V4068)
         (shen/cond
          ((shen/internal/predicate->shen (null V4067)) (shen/reverse V4068))
          ((shen/cons? V4067)
           (vector
            (list V4066 (nthcdr 1 V4067)
                  (append
                   (list
                    (shen/internal/apply-higher-order-function V4066
                                                               (list
                                                                (shen/hd V4067))))
                   V4068))))
          (shen/true (shen/shen.f-error 'shen.map-h)))))
    (let ((result (funcall #'tail-trampoline V4066 V4067 V4068)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/length (V4069) (shen/shen.length-h V4069 0))
(defun shen/shen.length-h (V4074 V4075)
  (cl-flet
      ((tail-trampoline (V4074 V4075)
         (shen/cond ((shen/internal/predicate->shen (null V4074)) V4075)
                    (shen/true (vector (list (nthcdr 1 V4074) (1+ V4075)))))))
    (let ((result (funcall #'tail-trampoline V4074 V4075)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/occurrences (V4081 V4082)
  (shen/cond ((shen/= V4081 V4082) 1)
             ((shen/cons? V4082)
              (shen/+ (shen/occurrences V4081 (shen/hd V4082))
                      (shen/occurrences V4081 (nthcdr 1 V4082))))
             (shen/true 0)))
(defun shen/nth (I Xs) (nth I Xs))
(defun shen/integer? (N) (shen/internal/predicate->shen (integerp N)))
(defun shen/shen.abs (V4091) (shen/if (shen/> V4091 0) V4091 (shen/- 0 V4091)))
(defun shen/shen.magless (V4092 V4093)
  (cl-flet
      ((tail-trampoline (V4092 V4093)
         (shen/let W4094 (shen/* V4093 2)
                   (shen/if (shen/> W4094 V4092) V4093
                            (vector (list V4092 W4094))))))
    (let ((result (funcall #'tail-trampoline V4092 V4093)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.integer-test? (V4098 V4099)
  (cl-flet
      ((tail-trampoline (V4098 V4099)
         (shen/cond ((shen/= 0 V4098) 'true) ((shen/> 1 V4098) 'false)
                    (shen/true
                     (shen/let W4100 (shen/- V4098 V4099)
                               (shen/if (shen/> 0 W4100) (shen/integer? V4098)
                                        (vector (list W4100 V4099))))))))
    (let ((result (funcall #'tail-trampoline V4098 V4099)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/mapcan (V4107 V4108)
  (shen/cond ((shen/internal/predicate->shen (null V4108)) nil)
             ((shen/cons? V4108)
              (shen/append
               (shen/internal/apply-higher-order-function V4107
                                                          (list (shen/hd V4108)))
               (shen/mapcan V4107 (nthcdr 1 V4108))))
             (shen/true
              (shen/simple-error "attempt to mapcan over a non-list\n"))))
(defun shen/== (V4114 V4115)
  (shen/cond ((shen/= V4114 V4115) 'true) (shen/true 'false)))
(defun shen/bound? (V4116)
  (shen/and (shen/symbol? V4116)
            (shen/let W4117
                      (shen/trap-error (shen/value V4116)
                                       (shen/lambda Z4118
                                                    'shen.this-symbol-is-unbound))
                      (shen/if (shen/= W4117 'shen.this-symbol-is-unbound)
                               'false 'true))))
(defun shen/shen.string->bytes (S) (string-to-list S))
(defun shen/maxinferences (V4120) (shen/set 'shen.*maxinferences* V4120))
(defun shen/inferences nil (shen/value 'shen.*infs*))
(defun shen/protect (V4121) V4121)
(defun shen/sterror nil (shen/value '*sterror*))
(defun shen/stoutput nil (shen/value '*stoutput*))
(defun shen/string->symbol (V4122)
  (shen/let W4123 (shen/intern V4122)
            (shen/if (shen/symbol? W4123) W4123
                     (shen/simple-error
                      (shen/cn "cannot intern "
                               (shen/shen.app V4122 " to a symbol" 'shen.s))))))
(defun shen/optimise (V4126)
  (shen/cond ((shen/= '+ V4126) (shen/set 'shen.*optimise* 'true))
             ((shen/= '- V4126) (shen/set 'shen.*optimise* 'false))
             (shen/true (shen/simple-error "optimise expects a + or a -.\n"))))
(defun shen/os nil (shen/value '*os*))
(defun shen/language nil (shen/value '*language*))
(defun shen/version nil (shen/value '*version*))
(defun shen/port nil (shen/value '*port*))
(defun shen/porters nil (shen/value '*porters*))
(defun shen/implementation nil (shen/value '*implementation*))
(defun shen/release nil (shen/value '*release*))
(defun shen/package? (V4127)
  (shen/cond ((shen/= 'null V4127) 'true)
             (shen/true
              (shen/trap-error (shen/do (shen/external V4127) 'true)
                               (shen/lambda Z4128 'false)))))
(defun shen/fail nil 'shen.fail!)
(defun shen/enable-type-theory (V4131)
  (shen/cond
   ((shen/= '+ V4131) (shen/set 'shen.*shen-type-theory-enabled?* 'true))
   ((shen/= '- V4131) (shen/set 'shen.*shen-type-theory-enabled?* 'false))
   (shen/true (shen/simple-error "enable-type-theory expects a + or a -\n"))))
(defun shen/tc (V4134)
  (shen/cond ((shen/= '+ V4134) (shen/set 'shen.*tc* 'true))
             ((shen/= '- V4134) (shen/set 'shen.*tc* 'false))
             (shen/true (shen/simple-error "tc expects a + or -"))))
(defun shen/destroy (V4135)
  (shen/do
   (shen/set 'shen.*sigf* (shen/shen.unassoc V4135 (shen/value 'shen.*sigf*)))
   V4135))
(defun shen/shen.unassoc (V4145 V4146)
  (shen/cond ((shen/internal/predicate->shen (null V4146)) nil)
             ((shen/and (shen/cons? V4146)
                        (shen/and (shen/cons? (shen/hd V4146))
                                  (shen/= V4145 (shen/hd (shen/hd V4146)))))
              (nthcdr 1 V4146))
             ((shen/cons? V4146)
              (append (list (shen/hd V4146))
                      (shen/shen.unassoc V4145 (nthcdr 1 V4146))))
             (shen/true
              (shen/simple-error "implementation error in shen.unassoc"))))
(defun shen/in-package (V4147)
  (shen/if (shen/package? V4147) (shen/set 'shen.*package* V4147)
           (shen/simple-error
            (shen/cn "package "
                     (shen/shen.app V4147 " does not exist\n" 'shen.a)))))
(defun shen/write-to-file (V4148 V4149)
  (shen/let W4150 (shen/open V4148 'out)
            (shen/let W4151
                      (shen/if (shen/string? V4149) V4149
                               (shen/shen.app V4149 "" 'shen.s))
                      (shen/let W4152 (shen/pr W4151 W4150)
                                (shen/let W4153 (shen/close W4150) V4149)))))
(defun shen/fresh nil (shen/shen.freshterm (shen/gensym 'shen.t)))
(defun shen/update-lambda-table (V4154 V4155)
  (shen/let W4156 (shen/put V4154 'arity V4155 (shen/value '*property-vector*))
            (shen/let W4157 (shen/shen.lambda-entry V4154)
                      (shen/let W4158
                                (shen/shen.set-lambda-form-entry
                                 (append (list V4154) W4157))
                                V4154))))
(defun shen/specialise (V4161 V4162)
  (shen/cond
   ((shen/= 0 V4162)
    (shen/do
     (shen/set 'shen.*special* (shen/remove V4161 (shen/value 'shen.*special*)))
     (shen/do
      (shen/set 'shen.*extraspecial*
                (shen/remove V4161 (shen/value 'shen.*extraspecial*)))
      V4161)))
   ((shen/= 1 V4162)
    (shen/do
     (shen/set 'shen.*special* (shen/adjoin V4161 (shen/value 'shen.*special*)))
     (shen/do
      (shen/set 'shen.*extraspecial*
                (shen/remove V4161 (shen/value 'shen.*extraspecial*)))
      V4161)))
   ((shen/= 2 V4162)
    (shen/do
     (shen/set 'shen.*special* (shen/remove V4161 (shen/value 'shen.*special*)))
     (shen/do
      (shen/set 'shen.*extraspecial*
                (shen/adjoin V4161 (shen/value 'shen.*extraspecial*)))
      V4161)))
   (shen/true (shen/simple-error "specialise requires values of 0, 1 or 2\n"))))
(defun shen/print (V6764)
  (shen/let W6765 (shen/shen.insert V6764 "~S")
            (shen/let W6766 (shen/pr W6765 (shen/stoutput)) V6764)))
(defun shen/pr (V6767 V6768)
  (shen/if (shen/value '*hush*) V6767
           (shen/if (shen/shen.char-stoutput? V6768)
                    (shen/shen.write-string V6767 V6768)
                    (shen/shen.write-chars V6767 V6768
                                           (shen/shen.string->byte V6767 0) 1))))
(defun shen/shen.string->byte (V6769 V6770)
  (shen/trap-error (shen/string->n (shen/pos V6769 V6770))
                   (shen/lambda Z6771 'shen.eos)))
(defun shen/shen.write-chars (V6772 V6773 V6774 V6775)
  (cl-flet
      ((tail-trampoline (V6772 V6773 V6774 V6775)
         (shen/cond ((shen/= 'shen.eos V6774) V6772)
                    (shen/true
                     (vector
                      (list V6772 V6773
                            (shen/do (shen/write-byte V6774 V6773)
                                     (shen/shen.string->byte V6772 V6775))
                            (1+ V6775)))))))
    (let ((result (funcall #'tail-trampoline V6772 V6773 V6774 V6775)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.mkstr (V6776 V6777)
  (shen/cond
   ((shen/string? V6776) (shen/shen.mkstr-l (shen/shen.proc-nl V6776) V6777))
   (shen/true (shen/shen.mkstr-r (list 'shen.proc-nl V6776) V6777))))
(defun shen/shen.mkstr-l (V6782 V6783)
  (cl-flet
      ((tail-trampoline (V6782 V6783)
         (shen/cond ((shen/internal/predicate->shen (null V6783)) V6782)
                    ((shen/cons? V6783)
                     (vector
                      (list (shen/shen.insert-l (shen/hd V6783) V6782)
                            (nthcdr 1 V6783))))
                    (shen/true
                     (shen/simple-error "implementation error in shen.mkstr-l")))))
    (let ((result (funcall #'tail-trampoline V6782 V6783)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.insert-l (V6790 V6791)
  (shen/cond ((shen/= "" V6791) "")
             ((shen/and (shen/shen.+string? V6791)
                        (shen/and (shen/= "~" (shen/hdstr V6791))
                                  (shen/and
                                   (shen/shen.+string? (shen/tlstr V6791))
                                   (shen/= "A" (shen/hdstr (shen/tlstr V6791))))))
              (list 'shen.app V6790 (shen/tlstr (shen/tlstr V6791)) 'shen.a))
             ((shen/and (shen/shen.+string? V6791)
                        (shen/and (shen/= "~" (shen/hdstr V6791))
                                  (shen/and
                                   (shen/shen.+string? (shen/tlstr V6791))
                                   (shen/= "R" (shen/hdstr (shen/tlstr V6791))))))
              (list 'shen.app V6790 (shen/tlstr (shen/tlstr V6791)) 'shen.r))
             ((shen/and (shen/shen.+string? V6791)
                        (shen/and (shen/= "~" (shen/hdstr V6791))
                                  (shen/and
                                   (shen/shen.+string? (shen/tlstr V6791))
                                   (shen/= "S" (shen/hdstr (shen/tlstr V6791))))))
              (list 'shen.app V6790 (shen/tlstr (shen/tlstr V6791)) 'shen.s))
             ((shen/shen.+string? V6791)
              (shen/shen.factor-cn
               (list 'cn (shen/hdstr V6791)
                     (shen/shen.insert-l V6790 (shen/tlstr V6791)))))
             ((shen/and (shen/cons? V6791)
                        (shen/and (shen/= 'cn (shen/hd V6791))
                                  (shen/and (shen/cons? (nthcdr 1 V6791))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V6791))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V6791)))))))
              (list 'cn (shen/hd (nthcdr 1 V6791))
                    (shen/shen.insert-l V6790 (shen/hd (nthcdr 2 V6791)))))
             ((shen/and (shen/cons? V6791)
                        (shen/and (shen/= 'shen.app (shen/hd V6791))
                                  (shen/and (shen/cons? (nthcdr 1 V6791))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V6791))
                                             (shen/and
                                              (shen/cons? (nthcdr 3 V6791))
                                              (shen/internal/predicate->shen
                                               (null (nthcdr 4 V6791))))))))
              (append
               (list 'shen.app (shen/hd (nthcdr 1 V6791))
                     (shen/shen.insert-l V6790 (shen/hd (nthcdr 2 V6791))))
               (nthcdr 3 V6791)))
             (shen/true
              (shen/simple-error "implementation error in shen.insert-l"))))
(defun shen/shen.factor-cn (V6792)
  (shen/cond
   ((shen/and (shen/cons? V6792)
              (shen/and (shen/= 'cn (shen/hd V6792))
                        (shen/and (shen/cons? (nthcdr 1 V6792))
                                  (shen/and (shen/cons? (nthcdr 2 V6792))
                                            (shen/and
                                             (shen/cons?
                                              (shen/hd (nthcdr 2 V6792)))
                                             (shen/and
                                              (shen/= 'cn
                                                      (shen/hd
                                                       (shen/hd (nthcdr 2 V6792))))
                                              (shen/and
                                               (shen/cons?
                                                (nthcdr 1
                                                        (shen/hd
                                                         (nthcdr 2 V6792))))
                                               (shen/and
                                                (shen/cons?
                                                 (nthcdr 2
                                                         (shen/hd
                                                          (nthcdr 2 V6792))))
                                                (shen/and
                                                 (shen/internal/predicate->shen
                                                  (null
                                                   (nthcdr 3
                                                           (shen/hd
                                                            (nthcdr 2 V6792)))))
                                                 (shen/and
                                                  (shen/internal/predicate->shen
                                                   (null (nthcdr 3 V6792)))
                                                  (shen/and
                                                   (shen/string?
                                                    (shen/hd (nthcdr 1 V6792)))
                                                   (shen/string?
                                                    (shen/hd
                                                     (nthcdr 1
                                                             (shen/hd
                                                              (nthcdr 2 V6792))))))))))))))))
    (append
     (list 'cn
           (shen/cn (shen/hd (nthcdr 1 V6792))
                    (shen/hd (nthcdr 1 (shen/hd (nthcdr 2 V6792))))))
     (nthcdr 2 (shen/hd (nthcdr 2 V6792)))))
   (shen/true V6792)))
(defun shen/shen.proc-nl (V6795)
  (shen/cond ((shen/= "" V6795) "")
             ((shen/and (shen/shen.+string? V6795)
                        (shen/and (shen/= "~" (shen/hdstr V6795))
                                  (shen/and
                                   (shen/shen.+string? (shen/tlstr V6795))
                                   (shen/= "%" (shen/hdstr (shen/tlstr V6795))))))
              (shen/cn (shen/n->string 10)
                       (shen/shen.proc-nl (shen/tlstr (shen/tlstr V6795)))))
             ((shen/shen.+string? V6795)
              (shen/cn (shen/hdstr V6795) (shen/shen.proc-nl (shen/tlstr V6795))))
             (shen/true
              (shen/simple-error "implementation error in shen.proc-nl"))))
(defun shen/shen.mkstr-r (V6800 V6801)
  (cl-flet
      ((tail-trampoline (V6800 V6801)
         (shen/cond ((shen/internal/predicate->shen (null V6801)) V6800)
                    ((shen/cons? V6801)
                     (vector
                      (list (list 'shen.insert (shen/hd V6801) V6800)
                            (nthcdr 1 V6801))))
                    (shen/true
                     (shen/simple-error "implementation error in shen.mkstr-r")))))
    (let ((result (funcall #'tail-trampoline V6800 V6801)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.insert (V6802 V6803) (shen/shen.insert-h V6802 V6803 ""))
(defun shen/shen.insert-h (V6812 V6813 V6814)
  (cl-flet
      ((tail-trampoline (V6812 V6813 V6814)
         (shen/cond ((shen/= "" V6813) V6814)
                    ((shen/and (shen/shen.+string? V6813)
                               (shen/and (shen/= "~" (shen/hdstr V6813))
                                         (shen/and
                                          (shen/shen.+string? (shen/tlstr V6813))
                                          (shen/= "A"
                                                  (shen/hdstr (shen/tlstr V6813))))))
                     (shen/cn V6814
                              (shen/shen.app V6812
                                             (shen/tlstr (shen/tlstr V6813))
                                             'shen.a)))
                    ((shen/and (shen/shen.+string? V6813)
                               (shen/and (shen/= "~" (shen/hdstr V6813))
                                         (shen/and
                                          (shen/shen.+string? (shen/tlstr V6813))
                                          (shen/= "R"
                                                  (shen/hdstr (shen/tlstr V6813))))))
                     (shen/cn V6814
                              (shen/shen.app V6812
                                             (shen/tlstr (shen/tlstr V6813))
                                             'shen.r)))
                    ((shen/and (shen/shen.+string? V6813)
                               (shen/and (shen/= "~" (shen/hdstr V6813))
                                         (shen/and
                                          (shen/shen.+string? (shen/tlstr V6813))
                                          (shen/= "S"
                                                  (shen/hdstr (shen/tlstr V6813))))))
                     (shen/cn V6814
                              (shen/shen.app V6812
                                             (shen/tlstr (shen/tlstr V6813))
                                             'shen.s)))
                    ((shen/shen.+string? V6813)
                     (vector
                      (list V6812 (shen/tlstr V6813)
                            (shen/cn V6814 (shen/hdstr V6813)))))
                    (shen/true
                     (shen/simple-error "implementation error in shen.insert-h")))))
    (let ((result (funcall #'tail-trampoline V6812 V6813 V6814)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.app (V6815 V6816 V6817)
  (shen/cn (shen/shen.arg->str V6815 V6817) V6816))
(defun shen/shen.arg->str (V6821 V6822)
  (shen/cond ((shen/= V6821 (shen/fail)) "...")
             ((shen/shen.list? V6821) (shen/shen.list->str V6821 V6822))
             ((shen/string? V6821) (shen/shen.str->str V6821 V6822))
             ((shen/absvector? V6821) (shen/shen.vector->str V6821 V6822))
             (shen/true (shen/shen.atom->str V6821))))
(defun shen/shen.list->str (V6823 V6824)
  (shen/cond
   ((shen/= 'shen.r V6824)
    (concat (concat "(" (shen/shen.iter-list V6823 'shen.r (shen/shen.maxseq)))
            ")"))
   (shen/true
    (concat (concat "[" (shen/shen.iter-list V6823 V6824 (shen/shen.maxseq)))
            "]"))))
(defun shen/shen.maxseq nil (shen/value '*maximum-print-sequence-size*))
(defun shen/shen.iter-list (V6835 V6836 V6837)
  (shen/cond ((shen/internal/predicate->shen (null V6835)) "")
             ((shen/= 0 V6837) "... etc")
             ((shen/and (shen/cons? V6835)
                        (shen/internal/predicate->shen (null (nthcdr 1 V6835))))
              (shen/shen.arg->str (shen/hd V6835) V6836))
             ((shen/cons? V6835)
              (concat (concat (shen/shen.arg->str (shen/hd V6835) V6836) " ")
                      (shen/shen.iter-list (nthcdr 1 V6835) V6836
                                           (shen/- V6837 1))))
             (shen/true
              (concat (concat "|" " ") (shen/shen.arg->str V6835 V6836)))))
(defun shen/shen.str->str (V6840 V6841)
  (shen/cond ((shen/= 'shen.a V6841) V6840)
             (shen/true
              (concat (concat (shen/n->string 34) V6840) (shen/n->string 34)))))
(defun shen/shen.vector->str (V6842 V6843)
  (shen/if (shen/shen.print-vector? V6842)
           (shen/internal/apply-function-expression
            (shen/fn (shen/<-address V6842 0)) (list V6842))
           (shen/if (shen/vector? V6842)
                    (concat
                     (concat "<"
                             (shen/shen.iter-vector V6842 1 V6843
                                                    (shen/shen.maxseq)))
                     ">")
                    (concat
                     (concat "<" "<"
                             (shen/shen.iter-vector V6842 0 V6843
                                                    (shen/shen.maxseq)))
                     ">>"))))
(defun shen/shen.empty-absvector? (V6844)
  (shen/= V6844 (shen/value 'shen.*empty-absvector*)))
(defun shen/shen.print-vector? (V6845)
  (shen/and (shen/not (shen/shen.empty-absvector? V6845))
            (shen/let W6846 (shen/<-address V6845 0)
                      (shen/or (shen/= W6846 'shen.tuple)
                               (shen/or (shen/= W6846 'shen.pvar)
                                        (shen/or (shen/= W6846 'shen.dictionary)
                                                 (shen/and
                                                  (shen/not (shen/number? W6846))
                                                  (shen/shen.fbound? W6846))))))))
(defun shen/shen.fbound? (V6847) (shen/not (shen/= (shen/arity V6847) -1)))
(defun shen/shen.tuple (V6848)
  (shen/cn "(@p "
           (shen/shen.app (shen/<-address V6848 1)
                          (shen/cn " "
                                   (shen/shen.app (shen/<-address V6848 2) ")"
                                                  'shen.s))
                          'shen.s)))
(defun shen/shen.dictionary (V6849) "(dict ...)")
(defun shen/shen.iter-vector (V6856 V6857 V6858 V6859)
  (shen/cond ((shen/= 0 V6859) "... etc")
             (shen/true
              (shen/let W6860
                        (shen/trap-error (shen/<-address V6856 V6857)
                                         (shen/lambda Z6861 'shen.out-of-bounds))
                        (shen/let W6862
                                  (shen/trap-error
                                   (shen/<-address V6856 (1+ V6857))
                                   (shen/lambda Z6863 'shen.out-of-bounds))
                                  (shen/if (shen/= W6860 'shen.out-of-bounds) ""
                                           (shen/if
                                            (shen/= W6862 'shen.out-of-bounds)
                                            (shen/shen.arg->str W6860 V6858)
                                            (concat
                                             (concat
                                              (shen/shen.arg->str W6860 V6858)
                                              " ")
                                             (shen/shen.iter-vector V6856
                                                                    (1+ V6857)
                                                                    V6858
                                                                    (shen/-
                                                                     V6859 1))))))))))
(defun shen/shen.atom->str (V6864)
  (shen/trap-error (shen/str V6864) (shen/lambda Z6865 (shen/shen.funexstring))))
(defun shen/shen.funexstring nil
  (concat
   (concat "" "f" "u" "n" "e"
           (shen/shen.arg->str (shen/gensym (shen/intern "x")) 'shen.a))
   ""))
(defun shen/shen.list? (V6866) (shen/or (shen/empty? V6866) (shen/cons? V6866)))
(defun shen/shen.shen->kl (V503)
  (shen/let W504 (shen/shen.shen->kl-h V503)
            (shen/shen.record-and-evaluate W504)))
(defun shen/shen.record-and-evaluate (V505)
  (shen/cond
   ((shen/and (shen/cons? V505)
              (shen/and (shen/= 'defun (shen/hd V505))
                        (shen/and (shen/cons? (nthcdr 1 V505))
                                  (shen/and (shen/cons? (nthcdr 2 V505))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V505))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 4 V505))))))))
    (shen/let W506
              (shen/if (shen/shen.sysfunc? (shen/hd (nthcdr 1 V505)))
                       (shen/simple-error
                        (shen/shen.app (shen/hd (nthcdr 1 V505))
                                       " is not a legitimate function name\n"
                                       'shen.a))
                       'shen.skip)
              (shen/let W507
                        (shen/shen.store-arity (shen/hd (nthcdr 1 V505))
                                               (shen/length
                                                (shen/hd (nthcdr 2 V505))))
                        (shen/let W508
                                  (shen/shen.record-kl (shen/hd (nthcdr 1 V505))
                                                       V505)
                                  (shen/let W509 (shen/eval-kl V505)
                                            (shen/shen.fn-print
                                             (shen/hd (nthcdr 1 V505))))))))
   (shen/true V505)))
(defun shen/shen.shen->kl-h (V510)
  (shen/cond
   ((shen/and (shen/cons? V510)
              (shen/and (shen/= 'define (shen/hd V510))
                        (shen/cons? (nthcdr 1 V510))))
    (shen/shen.shendef->kldef (shen/hd (nthcdr 1 V510)) (nthcdr 2 V510)))
   ((shen/and (shen/cons? V510)
              (shen/and (shen/= 'defun (shen/hd V510))
                        (shen/and (shen/cons? (nthcdr 1 V510))
                                  (shen/and (shen/cons? (nthcdr 2 V510))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V510))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 4 V510))))))))
    V510)
   ((shen/and (shen/cons? V510)
              (shen/and (shen/= 'type (shen/hd V510))
                        (shen/and (shen/cons? (nthcdr 1 V510))
                                  (shen/and (shen/cons? (nthcdr 2 V510))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V510)))))))
    (list 'type (shen/hd (nthcdr 1 V510))
          (shen/shen.rcons_form (shen/hd (nthcdr 2 V510)))))
   ((shen/and (shen/cons? V510)
              (shen/and (shen/= 'input+ (shen/hd V510))
                        (shen/and (shen/cons? (nthcdr 1 V510))
                                  (shen/and (shen/cons? (nthcdr 2 V510))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V510)))))))
    (append (list 'input+ (shen/shen.rcons_form (shen/hd (nthcdr 1 V510))))
            (nthcdr 2 V510)))
   ((shen/cons? V510)
    (shen/map (shen/lambda Z511 (shen/shen.shen->kl-h Z511)) V510))
   (shen/true V510)))
(defun shen/shen.shendef->kldef (V512 V513)
  (shen/compile (shen/lambda Z514 (shen/shen.<define> Z514))
                (append (list V512) V513)))
(defun shen/shen.<define> (V515)
  (shen/let W516
            (shen/let W517 (shen/shen.<name> V515)
                      (shen/if (shen/shen.parse-failure? W517)
                               (shen/shen.parse-failure)
                               (shen/let W518 (shen/shen.<-out W517)
                                         (shen/let W519 (shen/shen.in-> W517)
                                                   (shen/if
                                                    (shen/shen.hds=? W519 '{)
                                                    (shen/let W520
                                                              (shen/tail W519)
                                                              (shen/let W521
                                                                        (shen/shen.<signature>
                                                                         W520)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W521)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W522
                                                                          (shen/shen.in->
                                                                           W521)
                                                                          (shen/if
                                                                           (shen/shen.hds=?
                                                                            W522
                                                                            '})
                                                                           (shen/let
                                                                            W523
                                                                            (shen/tail
                                                                             W522)
                                                                            (shen/let
                                                                             W524
                                                                             (shen/shen.<rules>
                                                                              W523)
                                                                             (shen/if
                                                                              (shen/shen.parse-failure?
                                                                               W524)
                                                                              (shen/shen.parse-failure)
                                                                              (shen/let
                                                                               W525
                                                                               (shen/shen.<-out
                                                                                W524)
                                                                               (shen/let
                                                                                W526
                                                                                (shen/shen.in->
                                                                                 W524)
                                                                                (shen/shen.comb
                                                                                 W526
                                                                                 (shen/shen.shendef->kldef-h
                                                                                  W518
                                                                                  W525)))))))
                                                                           (shen/shen.parse-failure))))))
                                                    (shen/shen.parse-failure))))))
            (shen/if (shen/shen.parse-failure? W516)
                     (shen/let W527
                               (shen/let W528 (shen/shen.<name> V515)
                                         (shen/if
                                          (shen/shen.parse-failure? W528)
                                          (shen/shen.parse-failure)
                                          (shen/let W529 (shen/shen.<-out W528)
                                                    (shen/let W530
                                                              (shen/shen.in->
                                                               W528)
                                                              (shen/let W531
                                                                        (shen/shen.<rules>
                                                                         W530)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W531)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W532
                                                                          (shen/shen.<-out
                                                                           W531)
                                                                          (shen/let
                                                                           W533
                                                                           (shen/shen.in->
                                                                            W531)
                                                                           (shen/shen.comb
                                                                            W533
                                                                            (shen/shen.shendef->kldef-h
                                                                             W529
                                                                             W532))))))))))
                               (shen/if (shen/shen.parse-failure? W527)
                                        (shen/shen.parse-failure) W527))
                     W516)))
(defun shen/shen.shendef->kldef-h (V534 V535)
  (shen/let W536 (shen/map (shen/lambda Z537 (shen/fst Z537)) V535)
            (shen/let W538 (shen/shen.arity-chk V534 W536)
                      (shen/let W539
                                (shen/map
                                 (shen/lambda Z540
                                              (shen/shen.free-var-chk V534 Z540))
                                 V535)
                                (shen/let W541 (shen/shen.unprotect V535)
                                          (shen/let W542
                                                    (shen/shen.factorise-code
                                                     (shen/shen.compile-to-kl
                                                      V534 W541 W538))
                                                    W542))))))
(defun shen/shen.unprotect (V543)
  (cl-flet
      ((tail-trampoline (V543)
         (shen/cond
          ((shen/tuple? V543)
           (shen/@p (shen/shen.unprotect (shen/fst V543))
                    (shen/shen.unprotect (shen/snd V543))))
          ((shen/and (shen/cons? V543)
                     (shen/and (shen/= 'protect (shen/hd V543))
                               (shen/and (shen/cons? (nthcdr 1 V543))
                                         (shen/internal/predicate->shen
                                          (null (nthcdr 2 V543))))))
           (vector (list (shen/hd (nthcdr 1 V543)))))
          ((shen/cons? V543)
           (shen/map (shen/lambda Z544 (shen/shen.unprotect Z544)) V543))
          (shen/true V543))))
    (let ((result (funcall #'tail-trampoline V543)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.<name> (V545)
  (shen/let W546
            (shen/if (shen/cons? V545)
                     (shen/let W547 (shen/head V545)
                               (shen/let W548 (shen/tail V545)
                                         (shen/shen.comb W548
                                                         (shen/if
                                                          (shen/and
                                                           (shen/symbol? W547)
                                                           (shen/not
                                                            (shen/variable? W547)))
                                                          W547
                                                          (shen/simple-error
                                                           (shen/shen.app W547
                                                                          " is not a legitimate function name.\n"
                                                                          'shen.a))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W546) (shen/shen.parse-failure)
                     W546)))
(defun shen/shen.<signature> (V549)
  (shen/let W550
            (shen/if (shen/cons? V549)
                     (shen/let W551 (shen/head V549)
                               (shen/let W552 (shen/tail V549)
                                         (shen/let W553
                                                   (shen/shen.<signature> W552)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W553)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W554
                                                              (shen/shen.<-out
                                                               W553)
                                                              (shen/let W555
                                                                        (shen/shen.in->
                                                                         W553)
                                                                        (shen/if
                                                                         (shen/not
                                                                          (shen/element?
                                                                           W551
                                                                           (list
                                                                            '{ '})))
                                                                         (shen/shen.comb
                                                                          W555
                                                                          (append
                                                                           (list
                                                                            W551)
                                                                           W554))
                                                                         (shen/shen.parse-failure))))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W550)
                     (shen/let W556
                               (shen/let W557 (shen/<e> V549)
                                         (shen/if
                                          (shen/shen.parse-failure? W557)
                                          (shen/shen.parse-failure)
                                          (shen/let W558 (shen/shen.in-> W557)
                                                    (shen/shen.comb W558 nil))))
                               (shen/if (shen/shen.parse-failure? W556)
                                        (shen/shen.parse-failure) W556))
                     W550)))
(defun shen/shen.<rules> (V559)
  (shen/let W560
            (shen/let W561 (shen/shen.<rule> V559)
                      (shen/if (shen/shen.parse-failure? W561)
                               (shen/shen.parse-failure)
                               (shen/let W562 (shen/shen.<-out W561)
                                         (shen/let W563 (shen/shen.in-> W561)
                                                   (shen/let W564
                                                             (shen/shen.<rules>
                                                              W563)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W564)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W565
                                                                        (shen/shen.<-out
                                                                         W564)
                                                                        (shen/let
                                                                         W566
                                                                         (shen/shen.in->
                                                                          W564)
                                                                         (shen/shen.comb
                                                                          W566
                                                                          (append
                                                                           (list
                                                                            (shen/shen.linearise
                                                                             W562))
                                                                           W565))))))))))
            (shen/if (shen/shen.parse-failure? W560)
                     (shen/let W567
                               (shen/let W568 (shen/<!> V559)
                                         (shen/if
                                          (shen/shen.parse-failure? W568)
                                          (shen/shen.parse-failure)
                                          (shen/let W569 (shen/shen.<-out W568)
                                                    (shen/let W570
                                                              (shen/shen.in->
                                                               W568)
                                                              (shen/shen.comb
                                                               W570
                                                               (shen/if
                                                                (shen/empty?
                                                                 W569)
                                                                nil
                                                                (shen/simple-error
                                                                 (shen/cn
                                                                  "Shen syntax error here:\n "
                                                                  (shen/shen.app
                                                                   W569 "\n ..."
                                                                   'shen.r)))))))))
                               (shen/if (shen/shen.parse-failure? W567)
                                        (shen/shen.parse-failure) W567))
                     W560)))
(defun shen/shen.linearise (V573)
  (shen/cond
   ((shen/tuple? V573)
    (shen/shen.linearise-h (shen/fst V573) (shen/fst V573) nil (shen/snd V573)))
   (shen/true (shen/simple-error "implementation error in shen.linearise"))))
(defun shen/shen.linearise-h (V586 V587 V588 V589)
  (cl-flet
      ((tail-trampoline (V586 V587 V588 V589)
         (shen/cond
          ((shen/internal/predicate->shen (null V586)) (shen/@p V587 V589))
          ((shen/and (shen/cons? V586) (shen/cons? (shen/hd V586)))
           (vector
            (list (shen/append (shen/hd V586) (nthcdr 1 V586)) V587 V588 V589)))
          ((shen/and (shen/cons? V586) (shen/variable? (shen/hd V586)))
           (shen/if (shen/element? (shen/hd V586) V588)
                    (shen/let W590 (shen/gensym 'V)
                              (vector
                               (list (nthcdr 1 V586)
                                     (shen/shen.rep-X (shen/hd V586) W590 V587)
                                     V588
                                     (list 'where (list '= W590 (shen/hd V586))
                                           V589))))
                    (vector
                     (list (nthcdr 1 V586) V587
                           (append (list (shen/hd V586)) V588) V589))))
          ((shen/cons? V586) (vector (list (nthcdr 1 V586) V587 V588 V589)))
          (shen/true
           (shen/simple-error "implementation error in shen.linearise-h")))))
    (let ((result (funcall #'tail-trampoline V586 V587 V588 V589)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.<rule> (V591)
  (shen/let W592
            (shen/let W593 (shen/shen.<patterns> V591)
                      (shen/if (shen/shen.parse-failure? W593)
                               (shen/shen.parse-failure)
                               (shen/let W594 (shen/shen.<-out W593)
                                         (shen/let W595 (shen/shen.in-> W593)
                                                   (shen/if
                                                    (shen/shen.hds=? W595 '->)
                                                    (shen/let W596
                                                              (shen/tail W595)
                                                              (shen/if
                                                               (shen/cons? W596)
                                                               (shen/let W597
                                                                         (shen/head
                                                                          W596)
                                                                         (shen/let
                                                                          W598
                                                                          (shen/tail
                                                                           W596)
                                                                          (shen/if
                                                                           (shen/shen.hds=?
                                                                            W598
                                                                            'where)
                                                                           (shen/let
                                                                            W599
                                                                            (shen/tail
                                                                             W598)
                                                                            (shen/if
                                                                             (shen/cons?
                                                                              W599)
                                                                             (shen/let
                                                                              W600
                                                                              (shen/head
                                                                               W599)
                                                                              (shen/let
                                                                               W601
                                                                               (shen/tail
                                                                                W599)
                                                                               (shen/shen.comb
                                                                                W601
                                                                                (shen/@p
                                                                                 W594
                                                                                 (list
                                                                                  'where
                                                                                  W600
                                                                                  W597)))))
                                                                             (shen/shen.parse-failure)))
                                                                           (shen/shen.parse-failure))))
                                                               (shen/shen.parse-failure)))
                                                    (shen/shen.parse-failure))))))
            (shen/if (shen/shen.parse-failure? W592)
                     (shen/let W602
                               (shen/let W603 (shen/shen.<patterns> V591)
                                         (shen/if
                                          (shen/shen.parse-failure? W603)
                                          (shen/shen.parse-failure)
                                          (shen/let W604 (shen/shen.<-out W603)
                                                    (shen/let W605
                                                              (shen/shen.in->
                                                               W603)
                                                              (shen/if
                                                               (shen/shen.hds=?
                                                                W605 '->)
                                                               (shen/let W606
                                                                         (shen/tail
                                                                          W605)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W606)
                                                                          (shen/let
                                                                           W607
                                                                           (shen/head
                                                                            W606)
                                                                           (shen/let
                                                                            W608
                                                                            (shen/tail
                                                                             W606)
                                                                            (shen/shen.comb
                                                                             W608
                                                                             (shen/@p
                                                                              W604
                                                                              W607))))
                                                                          (shen/shen.parse-failure)))
                                                               (shen/shen.parse-failure))))))
                               (shen/if (shen/shen.parse-failure? W602)
                                        (shen/let W609
                                                  (shen/let W610
                                                            (shen/shen.<patterns>
                                                             V591)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W610)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W611
                                                                       (shen/shen.<-out
                                                                        W610)
                                                                       (shen/let
                                                                        W612
                                                                        (shen/shen.in->
                                                                         W610)
                                                                        (shen/if
                                                                         (shen/shen.hds=?
                                                                          W612
                                                                          '<-)
                                                                         (shen/let
                                                                          W613
                                                                          (shen/tail
                                                                           W612)
                                                                          (shen/if
                                                                           (shen/cons?
                                                                            W613)
                                                                           (shen/let
                                                                            W614
                                                                            (shen/head
                                                                             W613)
                                                                            (shen/let
                                                                             W615
                                                                             (shen/tail
                                                                              W613)
                                                                             (shen/if
                                                                              (shen/shen.hds=?
                                                                               W615
                                                                               'where)
                                                                              (shen/let
                                                                               W616
                                                                               (shen/tail
                                                                                W615)
                                                                               (shen/if
                                                                                (shen/cons?
                                                                                 W616)
                                                                                (shen/let
                                                                                 W617
                                                                                 (shen/head
                                                                                  W616)
                                                                                 (shen/let
                                                                                  W618
                                                                                  (shen/tail
                                                                                   W616)
                                                                                  (shen/shen.comb
                                                                                   W618
                                                                                   (shen/@p
                                                                                    W611
                                                                                    (list
                                                                                     'where
                                                                                     W617
                                                                                     (list
                                                                                      'shen.choicepoint!
                                                                                      W614))))))
                                                                                (shen/shen.parse-failure)))
                                                                              (shen/shen.parse-failure))))
                                                                           (shen/shen.parse-failure)))
                                                                         (shen/shen.parse-failure))))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W609)
                                                   (shen/let W619
                                                             (shen/let W620
                                                                       (shen/shen.<patterns>
                                                                        V591)
                                                                       (shen/if
                                                                        (shen/shen.parse-failure?
                                                                         W620)
                                                                        (shen/shen.parse-failure)
                                                                        (shen/let
                                                                         W621
                                                                         (shen/shen.<-out
                                                                          W620)
                                                                         (shen/let
                                                                          W622
                                                                          (shen/shen.in->
                                                                           W620)
                                                                          (shen/if
                                                                           (shen/shen.hds=?
                                                                            W622
                                                                            '<-)
                                                                           (shen/let
                                                                            W623
                                                                            (shen/tail
                                                                             W622)
                                                                            (shen/if
                                                                             (shen/cons?
                                                                              W623)
                                                                             (shen/let
                                                                              W624
                                                                              (shen/head
                                                                               W623)
                                                                              (shen/let
                                                                               W625
                                                                               (shen/tail
                                                                                W623)
                                                                               (shen/shen.comb
                                                                                W625
                                                                                (shen/@p
                                                                                 W621
                                                                                 (list
                                                                                  'shen.choicepoint!
                                                                                  W624)))))
                                                                             (shen/shen.parse-failure)))
                                                                           (shen/shen.parse-failure))))))
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W619)
                                                              (shen/shen.parse-failure)
                                                              W619))
                                                   W609))
                                        W602))
                     W592)))
(defun shen/shen.<patterns> (V626)
  (shen/let W627
            (shen/let W628 (shen/shen.<pattern> V626)
                      (shen/if (shen/shen.parse-failure? W628)
                               (shen/shen.parse-failure)
                               (shen/let W629 (shen/shen.<-out W628)
                                         (shen/let W630 (shen/shen.in-> W628)
                                                   (shen/let W631
                                                             (shen/shen.<patterns>
                                                              W630)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W631)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W632
                                                                        (shen/shen.<-out
                                                                         W631)
                                                                        (shen/let
                                                                         W633
                                                                         (shen/shen.in->
                                                                          W631)
                                                                         (shen/shen.comb
                                                                          W633
                                                                          (append
                                                                           (list
                                                                            W629)
                                                                           W632))))))))))
            (shen/if (shen/shen.parse-failure? W627)
                     (shen/let W634
                               (shen/let W635 (shen/<e> V626)
                                         (shen/if
                                          (shen/shen.parse-failure? W635)
                                          (shen/shen.parse-failure)
                                          (shen/let W636 (shen/shen.in-> W635)
                                                    (shen/shen.comb W636 nil))))
                               (shen/if (shen/shen.parse-failure? W634)
                                        (shen/shen.parse-failure) W634))
                     W627)))
(defun shen/shen.<pattern> (V637)
  (shen/let W638
            (shen/if (shen/shen.ccons? V637)
                     (shen/let W639 (shen/head V637)
                               (shen/let W640 (shen/tail V637)
                                         (shen/let W641
                                                   (shen/shen.<constructor> W639)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W641)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W642
                                                              (shen/shen.<-out
                                                               W641)
                                                              (shen/let W643
                                                                        (shen/shen.in->
                                                                         W641)
                                                                        (shen/let
                                                                         W644
                                                                         (shen/shen.<pattern1>
                                                                          W643)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W644)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W645
                                                                           (shen/shen.<-out
                                                                            W644)
                                                                           (shen/let
                                                                            W646
                                                                            (shen/shen.in->
                                                                             W644)
                                                                            (shen/let
                                                                             W647
                                                                             (shen/shen.<pattern2>
                                                                              W646)
                                                                             (shen/if
                                                                              (shen/shen.parse-failure?
                                                                               W647)
                                                                              (shen/shen.parse-failure)
                                                                              (shen/let
                                                                               W648
                                                                               (shen/shen.<-out
                                                                                W647)
                                                                               (shen/let
                                                                                W649
                                                                                (shen/shen.in->
                                                                                 W647)
                                                                                (shen/let
                                                                                 W650
                                                                                 (shen/<end>
                                                                                  W649)
                                                                                 (shen/if
                                                                                  (shen/shen.parse-failure?
                                                                                   W650)
                                                                                  (shen/shen.parse-failure)
                                                                                  (shen/let
                                                                                   W651
                                                                                   (shen/shen.in->
                                                                                    W650)
                                                                                   (shen/shen.comb
                                                                                    W640
                                                                                    (list
                                                                                     W642
                                                                                     W645
                                                                                     W648)))))))))))))))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W638)
                     (shen/let W652
                               (shen/if (shen/shen.ccons? V637)
                                        (shen/let W653 (shen/head V637)
                                                  (shen/let W654
                                                            (shen/tail V637)
                                                            (shen/if
                                                             (shen/shen.hds=?
                                                              W653 'vector)
                                                             (shen/let W655
                                                                       (shen/tail
                                                                        W653)
                                                                       (shen/if
                                                                        (shen/shen.hds=?
                                                                         W655 0)
                                                                        (shen/let
                                                                         W656
                                                                         (shen/tail
                                                                          W655)
                                                                         (shen/let
                                                                          W657
                                                                          (shen/<end>
                                                                           W656)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W657)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W658
                                                                            (shen/shen.in->
                                                                             W657)
                                                                            (shen/shen.comb
                                                                             W654
                                                                             (list
                                                                              'vector
                                                                              0))))))
                                                                        (shen/shen.parse-failure)))
                                                             (shen/shen.parse-failure))))
                                        (shen/shen.parse-failure))
                               (shen/if (shen/shen.parse-failure? W652)
                                        (shen/let W659
                                                  (shen/if (shen/cons? V637)
                                                           (shen/let W660
                                                                     (shen/head
                                                                      V637)
                                                                     (shen/let
                                                                      W661
                                                                      (shen/tail
                                                                       V637)
                                                                      (shen/if
                                                                       (shen/cons?
                                                                        W660)
                                                                       (shen/shen.comb
                                                                        W661
                                                                        (shen/shen.constructor-error
                                                                         W660))
                                                                       (shen/shen.parse-failure))))
                                                           (shen/shen.parse-failure))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W659)
                                                   (shen/let W662
                                                             (shen/let W663
                                                                       (shen/shen.<simple-pattern>
                                                                        V637)
                                                                       (shen/if
                                                                        (shen/shen.parse-failure?
                                                                         W663)
                                                                        (shen/shen.parse-failure)
                                                                        (shen/let
                                                                         W664
                                                                         (shen/shen.<-out
                                                                          W663)
                                                                         (shen/let
                                                                          W665
                                                                          (shen/shen.in->
                                                                           W663)
                                                                          (shen/shen.comb
                                                                           W665
                                                                           W664)))))
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W662)
                                                              (shen/shen.parse-failure)
                                                              W662))
                                                   W659))
                                        W652))
                     W638)))
(defun shen/shen.<constructor> (V666)
  (shen/let W667
            (shen/if (shen/cons? V666)
                     (shen/let W668 (shen/head V666)
                               (shen/let W669 (shen/tail V666)
                                         (shen/if (shen/shen.constructor? W668)
                                                  (shen/shen.comb W669 W668)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W667) (shen/shen.parse-failure)
                     W667)))
(defun shen/shen.constructor? (V670)
  (shen/element? V670 (list 'cons '@p '@s '@v)))
(defun shen/shen.constructor-error (V671)
  (shen/simple-error
   (shen/shen.app V671 " is not a legitimate constructor\n" 'shen.r)))
(defun shen/shen.<simple-pattern> (V672)
  (shen/let W673
            (shen/if (shen/cons? V672)
                     (shen/let W674 (shen/head V672)
                               (shen/let W675 (shen/tail V672)
                                         (shen/if (shen/= W674 '_)
                                                  (shen/shen.comb W675
                                                                  (shen/gensym
                                                                   'Y))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W673)
                     (shen/let W676
                               (shen/if (shen/cons? V672)
                                        (shen/let W677 (shen/head V672)
                                                  (shen/let W678
                                                            (shen/tail V672)
                                                            (shen/if
                                                             (shen/not
                                                              (shen/element?
                                                               W677
                                                               (list '-> '<-)))
                                                             (shen/shen.comb
                                                              W678 W677)
                                                             (shen/shen.parse-failure))))
                                        (shen/shen.parse-failure))
                               (shen/if (shen/shen.parse-failure? W676)
                                        (shen/shen.parse-failure) W676))
                     W673)))
(defun shen/shen.<pattern1> (V679)
  (shen/let W680
            (shen/let W681 (shen/shen.<pattern> V679)
                      (shen/if (shen/shen.parse-failure? W681)
                               (shen/shen.parse-failure)
                               (shen/let W682 (shen/shen.<-out W681)
                                         (shen/let W683 (shen/shen.in-> W681)
                                                   (shen/shen.comb W683 W682)))))
            (shen/if (shen/shen.parse-failure? W680) (shen/shen.parse-failure)
                     W680)))
(defun shen/shen.<pattern2> (V684)
  (shen/let W685
            (shen/let W686 (shen/shen.<pattern> V684)
                      (shen/if (shen/shen.parse-failure? W686)
                               (shen/shen.parse-failure)
                               (shen/let W687 (shen/shen.<-out W686)
                                         (shen/let W688 (shen/shen.in-> W686)
                                                   (shen/shen.comb W688 W687)))))
            (shen/if (shen/shen.parse-failure? W685) (shen/shen.parse-failure)
                     W685)))
(defun shen/shen.fn-print (V689)
  (shen/let W690 (shen/absvector 2)
            (shen/let W691 (shen/address-> W690 0 'shen.printF)
                      (shen/let W692
                                (shen/address-> W691 1
                                                (concat
                                                 (concat "(" "f" "n" " "
                                                         (shen/str V689))
                                                 ")"))
                                W692))))
(defun shen/shen.printF (V693) (shen/<-address V693 1))
(defun shen/shen.arity-chk (V698 V699)
  (cl-flet
      ((tail-trampoline (V698 V699)
         (shen/cond
          ((shen/and (shen/cons? V699)
                     (shen/internal/predicate->shen (null (nthcdr 1 V699))))
           (shen/length (shen/hd V699)))
          ((shen/and (shen/cons? V699)
                     (shen/and (shen/cons? (nthcdr 1 V699))
                               (shen/= (shen/length (shen/hd V699))
                                       (shen/length (shen/hd (nthcdr 1 V699))))))
           (vector (list V698 (nthcdr 1 V699))))
          (shen/true
           (shen/simple-error
            (shen/cn "arity error in " (shen/shen.app V698 "\n" 'shen.a)))))))
    (let ((result (funcall #'tail-trampoline V698 V699)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.free-var-chk (V700 V701)
  (shen/cond
   ((shen/tuple? V701)
    (shen/shen.free-variable-error-message V700
                                           (shen/shen.find-free-vars
                                            (shen/shen.extract-vars
                                             (shen/fst V701))
                                            (shen/snd V701))))
   (shen/true (shen/shen.f-error 'shen.free-var-chk))))
(defun shen/shen.free-variable-error-message (V702 V703)
  (shen/if (shen/empty? V703) 'shen.skip
           (shen/do
            (shen/pr
             (shen/cn "free variables in " (shen/shen.app V702 ":" 'shen.a))
             (shen/stoutput))
            (shen/do
             (shen/shen.for-each
              (shen/lambda Z704
                           (shen/pr
                            (shen/cn " " (shen/shen.app Z704 "" 'shen.a))
                            (shen/stoutput)))
              V703)
             (shen/do (shen/nl 1) (shen/abort))))))
(defun shen/shen.extract-vars (V707)
  (shen/cond ((shen/variable? V707) (list V707))
             ((shen/cons? V707)
              (shen/union (shen/shen.extract-vars (shen/hd V707))
                          (shen/shen.extract-vars (nthcdr 1 V707))))
             (shen/true nil)))
(defun shen/shen.find-free-vars (V712 V713)
  (cl-flet
      ((tail-trampoline (V712 V713)
         (shen/cond
          ((shen/and (shen/cons? V713)
                     (shen/and (shen/= 'protect (shen/hd V713))
                               (shen/and (shen/cons? (nthcdr 1 V713))
                                         (shen/internal/predicate->shen
                                          (null (nthcdr 2 V713))))))
           nil)
          ((shen/and (shen/cons? V713)
                     (shen/and (shen/= 'let (shen/hd V713))
                               (shen/and (shen/cons? (nthcdr 1 V713))
                                         (shen/and (shen/cons? (nthcdr 2 V713))
                                                   (shen/and
                                                    (shen/cons? (nthcdr 3 V713))
                                                    (shen/internal/predicate->shen
                                                     (null (nthcdr 4 V713))))))))
           (shen/union (shen/shen.find-free-vars V712 (shen/hd (nthcdr 2 V713)))
                       (shen/shen.find-free-vars
                        (append (list (shen/hd (nthcdr 1 V713))) V712)
                        (shen/hd (nthcdr 3 V713)))))
          ((shen/and (shen/cons? V713)
                     (shen/and (shen/= 'lambda (shen/hd V713))
                               (shen/and (shen/cons? (nthcdr 1 V713))
                                         (shen/and (shen/cons? (nthcdr 2 V713))
                                                   (shen/internal/predicate->shen
                                                    (null (nthcdr 3 V713)))))))
           (vector
            (list (append (list (shen/hd (nthcdr 1 V713))) V712)
                  (shen/hd (nthcdr 2 V713)))))
          ((shen/cons? V713)
           (shen/union (shen/shen.find-free-vars V712 (shen/hd V713))
                       (shen/shen.find-free-vars V712 (nthcdr 1 V713))))
          ((shen/shen.free-variable? V713 V712) (list V713)) (shen/true nil))))
    (let ((result (funcall #'tail-trampoline V712 V713)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.free-variable? (V714 V715)
  (shen/and (shen/variable? V714) (shen/not (shen/element? V714 V715))))
(defun shen/shen.record-kl (V716 V717)
  (shen/put V716 'shen.source V717 (shen/value '*property-vector*)))
(defun shen/shen.compile-to-kl (V718 V719 V720)
  (shen/let W721 (shen/shen.parameters V720)
            (shen/let W722
                      (shen/shen.scan-body V718 (shen/shen.kl-body V719 W721))
                      (shen/let W723
                                (list 'defun V718 W721
                                      (shen/shen.cond-form W722))
                                W723))))
(defun shen/shen.parameters (V724)
  (shen/cond ((shen/= 0 V724) nil)
             (shen/true
              (append (list (shen/gensym 'V))
                      (shen/shen.parameters (shen/- V724 1))))))
(defun shen/shen.cond-form (V727)
  (shen/cond
   ((shen/and (shen/cons? V727)
              (shen/and (shen/cons? (shen/hd V727))
                        (shen/and (shen/= 'true (shen/hd (shen/hd V727)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V727)))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V727))))))))
    (shen/hd (nthcdr 1 (shen/hd V727))))
   (shen/true (append (list 'cond) V727))))
(defun shen/shen.scan-body (V736 V737)
  (shen/cond
   ((shen/internal/predicate->shen (null V737))
    (list (list 'true (list 'shen.f-error V736))))
   ((shen/and (shen/cons? V737) (shen/shen.choicepoint? (shen/hd V737)))
    (shen/shen.choicepoint V736 (shen/gensym 'Freeze) (shen/gensym 'Result)
                           (shen/hd V737) (nthcdr 1 V737)))
   ((shen/and (shen/cons? V737)
              (shen/and (shen/cons? (shen/hd V737))
                        (shen/and (shen/= 'true (shen/hd (shen/hd V737)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V737)))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V737))))))))
    (list (shen/hd V737)))
   ((shen/cons? V737)
    (append (list (shen/hd V737)) (shen/shen.scan-body V736 (nthcdr 1 V737))))
   (shen/true (shen/simple-error "implementation error in shen.scan-body"))))
(defun shen/shen.choicepoint? (V744)
  (shen/cond
   ((shen/and (shen/cons? V744)
              (shen/and (shen/cons? (nthcdr 1 V744))
                        (shen/and (shen/cons? (shen/hd (nthcdr 1 V744)))
                                  (shen/and
                                   (shen/= 'shen.choicepoint!
                                           (shen/hd (shen/hd (nthcdr 1 V744))))
                                   (shen/and
                                    (shen/cons?
                                     (nthcdr 1 (shen/hd (nthcdr 1 V744))))
                                    (shen/and
                                     (shen/internal/predicate->shen
                                      (null (nthcdr 2 (shen/hd (nthcdr 1 V744)))))
                                     (shen/internal/predicate->shen
                                      (null (nthcdr 2 V744)))))))))
    'true)
   (shen/true 'false)))
(defun shen/shen.choicepoint (V760 V761 V762 V763 V764)
  (shen/cond
   ((shen/and (shen/cons? V763)
              (shen/and (shen/cons? (nthcdr 1 V763))
                        (shen/and (shen/cons? (shen/hd (nthcdr 1 V763)))
                                  (shen/and
                                   (shen/cons?
                                    (nthcdr 1 (shen/hd (nthcdr 1 V763))))
                                   (shen/and
                                    (shen/cons?
                                     (shen/hd
                                      (nthcdr 1 (shen/hd (nthcdr 1 V763)))))
                                    (shen/and
                                     (shen/= 'fail-if
                                             (shen/hd
                                              (shen/hd
                                               (nthcdr 1
                                                       (shen/hd (nthcdr 1 V763))))))
                                     (shen/and
                                      (shen/cons?
                                       (nthcdr 1
                                               (shen/hd
                                                (nthcdr 1
                                                        (shen/hd (nthcdr 1 V763))))))
                                      (shen/and
                                       (shen/cons?
                                        (nthcdr 2
                                                (shen/hd
                                                 (nthcdr 1
                                                         (shen/hd
                                                          (nthcdr 1 V763))))))
                                       (shen/and
                                        (shen/internal/predicate->shen
                                         (null
                                          (nthcdr 3
                                                  (shen/hd
                                                   (nthcdr 1
                                                           (shen/hd
                                                            (nthcdr 1 V763)))))))
                                        (shen/and
                                         (shen/internal/predicate->shen
                                          (null
                                           (nthcdr 2 (shen/hd (nthcdr 1 V763)))))
                                         (shen/and
                                          (shen/internal/predicate->shen
                                           (null (nthcdr 2 V763)))
                                          (shen/= V760
                                                  (shen/hd
                                                   (nthcdr 1
                                                           (shen/hd
                                                            (nthcdr 1
                                                                    (shen/hd
                                                                     (nthcdr 1
                                                                             V763))))))))))))))))))
    (list
     (list 'true
           (list 'let V761
                 (list 'freeze
                       (append (list 'cond)
                               (shen/shen.scan-body
                                (shen/hd
                                 (nthcdr 1
                                         (shen/hd
                                          (nthcdr 1 (shen/hd (nthcdr 1 V763))))))
                                V764)))
                 (list 'if (shen/hd V763)
                       (list 'let V762
                             (shen/hd
                              (nthcdr 2
                                      (shen/hd
                                       (nthcdr 1 (shen/hd (nthcdr 1 V763))))))
                             (list 'if
                                   (list
                                    (shen/hd
                                     (nthcdr 1
                                             (shen/hd
                                              (nthcdr 1
                                                      (shen/hd (nthcdr 1 V763))))))
                                    V762)
                                   (list 'thaw V761) V762))
                       (list 'thaw V761))))))
   ((shen/and (shen/cons? V763)
              (shen/and (shen/cons? (nthcdr 1 V763))
                        (shen/and (shen/cons? (shen/hd (nthcdr 1 V763)))
                                  (shen/and
                                   (shen/cons?
                                    (nthcdr 1 (shen/hd (nthcdr 1 V763))))
                                   (shen/and
                                    (shen/internal/predicate->shen
                                     (null (nthcdr 2 (shen/hd (nthcdr 1 V763)))))
                                    (shen/internal/predicate->shen
                                     (null (nthcdr 2 V763))))))))
    (list
     (list 'true
           (list 'let V761
                 (list 'freeze
                       (append (list 'cond) (shen/shen.scan-body V760 V764)))
                 (list 'if (shen/hd V763)
                       (list 'let V762
                             (shen/hd (nthcdr 1 (shen/hd (nthcdr 1 V763))))
                             (list 'if (list '= V762 (list 'fail))
                                   (list 'thaw V761) V762))
                       (list 'thaw V761))))))
   (shen/true (shen/simple-error "implementation error in shen.choicepoint"))))
(defun shen/shen.rep-X (V766 V767 V768)
  (shen/cond ((shen/= V766 V768) V767)
             ((shen/cons? V768)
              (shen/let W769 (shen/shen.rep-X V766 V767 (shen/hd V768))
                        (shen/if (shen/= W769 (shen/hd V768))
                                 (append (list (shen/hd V768))
                                         (shen/shen.rep-X V766 V767
                                                          (nthcdr 1 V768)))
                                 (append (list W769) (nthcdr 1 V768)))))
             (shen/true V768)))
(defun shen/shen.alpha-convert (V770)
  (shen/cond
   ((shen/and (shen/cons? V770)
              (shen/and (shen/= 'lambda (shen/hd V770))
                        (shen/and (shen/cons? (nthcdr 1 V770))
                                  (shen/and (shen/cons? (nthcdr 2 V770))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V770)))))))
    (shen/let W771 (shen/gensym 'Z)
              (shen/let W772
                        (list 'lambda W771
                              (shen/shen.beta (shen/hd (nthcdr 1 V770)) W771
                                              (shen/hd (nthcdr 2 V770))))
                        (shen/map
                         (shen/lambda Z773 (shen/shen.alpha-convert Z773)) W772))))
   ((shen/and (shen/cons? V770)
              (shen/and (shen/= 'let (shen/hd V770))
                        (shen/and (shen/cons? (nthcdr 1 V770))
                                  (shen/and (shen/cons? (nthcdr 2 V770))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V770))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 4 V770))))))))
    (shen/let W774 (shen/gensym 'W)
              (shen/let W775
                        (list 'let W774 (shen/hd (nthcdr 2 V770))
                              (shen/shen.beta (shen/hd (nthcdr 1 V770)) W774
                                              (shen/hd (nthcdr 3 V770))))
                        (shen/map
                         (shen/lambda Z776 (shen/shen.alpha-convert Z776)) W775))))
   ((shen/cons? V770)
    (shen/map (shen/lambda Z777 (shen/shen.alpha-convert Z777)) V770))
   (shen/true V770)))
(defun shen/shen.kl-body (V778 V779)
  (shen/map
   (shen/lambda Z780
                (shen/shen.triple-stack nil (shen/fst Z780) V779
                                        (shen/shen.alpha-convert (shen/snd Z780))))
   V778))
(defun shen/shen.triple-stack (V789 V790 V791 V792)
  (cl-flet
      ((tail-trampoline (V789 V790 V791 V792)
         (shen/cond
          ((shen/and (shen/internal/predicate->shen (null V790))
                     (shen/and (shen/internal/predicate->shen (null V791))
                               (shen/and (shen/cons? V792)
                                         (shen/and
                                          (shen/= 'where (shen/hd V792))
                                          (shen/and (shen/cons? (nthcdr 1 V792))
                                                    (shen/and
                                                     (shen/cons? (nthcdr 2 V792))
                                                     (shen/internal/predicate->shen
                                                      (null (nthcdr 3 V792)))))))))
           (vector
            (list (append (list (shen/hd (nthcdr 1 V792))) V789) nil nil
                  (shen/hd (nthcdr 2 V792)))))
          ((shen/and (shen/internal/predicate->shen (null V790))
                     (shen/internal/predicate->shen (null V791)))
           (list (shen/shen.rectify-test (shen/reverse V789)) V792))
          ((shen/and (shen/cons? V790)
                     (shen/and (shen/cons? V791) (shen/variable? (shen/hd V790))))
           (vector
            (list V789 (nthcdr 1 V790) (nthcdr 1 V791)
                  (shen/shen.beta (shen/hd V790) (shen/hd V791) V792))))
          ((shen/and (shen/cons? V790)
                     (shen/and (shen/cons? (shen/hd V790))
                               (shen/and (shen/cons? (nthcdr 1 (shen/hd V790)))
                                         (shen/and
                                          (shen/cons? (nthcdr 2 (shen/hd V790)))
                                          (shen/and
                                           (shen/internal/predicate->shen
                                            (null (nthcdr 3 (shen/hd V790))))
                                           (shen/cons? V791))))))
           (vector
            (list
             (append
              (list
               (list (shen/shen.op-test (shen/hd (shen/hd V790))) (shen/hd V791)))
              V789)
             (append
              (list (shen/hd (nthcdr 1 (shen/hd V790)))
                    (shen/hd (nthcdr 2 (shen/hd V790))))
              (nthcdr 1 V790))
             (append
              (list
               (list (shen/shen.op1 (shen/hd (shen/hd V790))) (shen/hd V791))
               (list (shen/shen.op2 (shen/hd (shen/hd V790))) (shen/hd V791)))
              (nthcdr 1 V791))
             (shen/shen.beta (shen/hd V790) (shen/hd V791) V792))))
          ((shen/and (shen/cons? V790) (shen/cons? V791))
           (vector
            (list (append (list (list '= (shen/hd V790) (shen/hd V791))) V789)
                  (nthcdr 1 V790) (nthcdr 1 V791) V792)))
          (shen/true
           (shen/simple-error "implementation error in shen.triple-stack")))))
    (let ((result (funcall #'tail-trampoline V789 V790 V791 V792)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.rectify-test (V795)
  (shen/cond ((shen/internal/predicate->shen (null V795)) 'true)
             ((shen/and (shen/cons? V795)
                        (shen/internal/predicate->shen (null (nthcdr 1 V795))))
              (shen/hd V795))
             ((shen/and (shen/cons? V795) (shen/cons? (nthcdr 1 V795)))
              (list 'and (shen/hd V795) (shen/shen.rectify-test (nthcdr 1 V795))))
             (shen/true
              (shen/simple-error "implementation error in shen.rectify-test"))))
(defun shen/shen.beta (V805 V806 V807)
  (shen/cond ((shen/= V805 V807) V806)
             ((shen/and (shen/cons? V807)
                        (shen/and (shen/= 'lambda (shen/hd V807))
                                  (shen/and (shen/cons? (nthcdr 1 V807))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V807))
                                             (shen/and
                                              (shen/internal/predicate->shen
                                               (null (nthcdr 3 V807)))
                                              (shen/= V805
                                                      (shen/hd (nthcdr 1 V807))))))))
              V807)
             ((shen/and (shen/cons? V807)
                        (shen/and (shen/= 'let (shen/hd V807))
                                  (shen/and (shen/cons? (nthcdr 1 V807))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V807))
                                             (shen/and
                                              (shen/cons? (nthcdr 3 V807))
                                              (shen/and
                                               (shen/internal/predicate->shen
                                                (null (nthcdr 4 V807)))
                                               (shen/= V805
                                                       (shen/hd (nthcdr 1 V807)))))))))
              (append
               (list 'let (shen/hd (nthcdr 1 V807))
                     (shen/shen.beta (shen/hd (nthcdr 1 V807)) V806
                                     (shen/hd (nthcdr 2 V807))))
               (nthcdr 3 V807)))
             ((shen/cons? V807)
              (shen/map (shen/lambda Z808 (shen/shen.beta V805 V806 Z808)) V807))
             (shen/true V807)))
(defun shen/shen.op1 (V811)
  (shen/cond ((shen/= 'cons V811) 'hd) ((shen/= '@s V811) 'hdstr)
             ((shen/= '@p V811) 'fst) ((shen/= '@v V811) 'hdv)
             (shen/true (shen/simple-error "implementation error in shen.op1"))))
(defun shen/shen.op2 (V814)
  (shen/cond ((shen/= 'cons V814) 'tl) ((shen/= '@s V814) 'tlstr)
             ((shen/= '@p V814) 'snd) ((shen/= '@v V814) 'tlv)
             (shen/true (shen/simple-error "implementation error in shen.op2"))))
(defun shen/shen.op-test (V817)
  (shen/cond ((shen/= 'cons V817) 'cons?) ((shen/= '@s V817) 'shen.+string?)
             ((shen/= '@p V817) 'tuple?) ((shen/= '@v V817) 'shen.+vector?)
             (shen/true
              (shen/simple-error "implementation error in shen.op-test"))))
(defun shen/shen.+string? (V818)
  (shen/cond ((shen/= "" V818) 'false) (shen/true (shen/string? V818))))
(defun shen/shen.+vector? (V819)
  (shen/cond ((shen/= V819 (shen/vector 0)) 'false)
             (shen/true (shen/vector? V819))))
(defun shen/factorise (V822)
  (shen/cond ((shen/= '+ V822) (shen/set 'shen.*factorise?* 'true))
             ((shen/= '- V822) (shen/set 'shen.*factorise?* 'false))
             (shen/true (shen/simple-error "factorise expects a + or a -\n"))))
(defun shen/shen.factorise-code (V823)
  (shen/cond ((shen/value 'shen.*factorise?*) (shen/shen.factor V823))
             (shen/true V823)))
(defun shen/shen.factor (V824)
  (shen/cond
   ((shen/and (shen/cons? V824)
              (shen/and (shen/= 'defun (shen/hd V824))
                        (shen/and (shen/cons? (nthcdr 1 V824))
                                  (shen/and (shen/cons? (nthcdr 2 V824))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V824))
                                             (shen/and
                                              (shen/cons?
                                               (shen/hd (nthcdr 3 V824)))
                                              (shen/and
                                               (shen/= 'cond
                                                       (shen/hd
                                                        (shen/hd (nthcdr 3 V824))))
                                               (shen/internal/predicate->shen
                                                (null (nthcdr 4 V824))))))))))
    (list 'defun (shen/hd (nthcdr 1 V824)) (shen/hd (nthcdr 2 V824))
          (shen/shen.factor-recognisors (nthcdr 1 (shen/hd (nthcdr 3 V824))))))
   (shen/true V824)))
(defun shen/shen.factor-recognisors (V827)
  (shen/cond
   ((shen/and (shen/cons? V827)
              (shen/and (shen/cons? (shen/hd V827))
                        (shen/and (shen/= 'true (shen/hd (shen/hd V827)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V827)))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V827))))))))
    (shen/hd (nthcdr 1 (shen/hd V827))))
   ((shen/and (shen/cons? V827)
              (shen/and (shen/cons? (shen/hd V827))
                        (shen/and (shen/cons? (shen/hd (shen/hd V827)))
                                  (shen/and
                                   (shen/= 'and
                                           (shen/hd (shen/hd (shen/hd V827))))
                                   (shen/and
                                    (shen/cons?
                                     (nthcdr 1 (shen/hd (shen/hd V827))))
                                    (shen/and
                                     (shen/cons?
                                      (nthcdr 2 (shen/hd (shen/hd V827))))
                                     (shen/and
                                      (shen/internal/predicate->shen
                                       (null (nthcdr 3 (shen/hd (shen/hd V827)))))
                                      (shen/and
                                       (shen/cons? (nthcdr 1 (shen/hd V827)))
                                       (shen/internal/predicate->shen
                                        (null (nthcdr 2 (shen/hd V827))))))))))))
    (shen/let W828
              (shen/shen.pivot-on (shen/hd (nthcdr 1 (shen/hd (shen/hd V827))))
                                  V827 nil)
              (shen/let W829 (shen/fst W828)
                        (shen/if (shen/shen.bad-pivot? W829)
                                 (list 'if (shen/hd (shen/hd V827))
                                       (shen/hd (nthcdr 1 (shen/hd V827)))
                                       (shen/shen.factor-recognisors
                                        (nthcdr 1 V827)))
                                 (shen/let W830 (shen/snd W828)
                                           (shen/let W831
                                                     (shen/shen.factor-recognisors
                                                      W830)
                                                     (shen/let W832
                                                               (shen/gensym
                                                                'GoTo)
                                                               (shen/let W833
                                                                         (shen/reverse
                                                                          (append
                                                                           (list
                                                                            (list
                                                                             'true
                                                                             (list
                                                                              'thaw
                                                                              W832)))
                                                                           W829))
                                                                         (shen/let
                                                                          W834
                                                                          (list
                                                                           'let
                                                                           W832
                                                                           (list
                                                                            'freeze
                                                                            W831)
                                                                           (list
                                                                            'if
                                                                            (shen/hd
                                                                             (nthcdr
                                                                              1
                                                                              (shen/hd
                                                                               (shen/hd
                                                                                V827))))
                                                                            (shen/shen.factor-selectors
                                                                             (shen/hd
                                                                              (nthcdr
                                                                               1
                                                                               (shen/hd
                                                                                (shen/hd
                                                                                 V827))))
                                                                             (shen/shen.factor-recognisors
                                                                              W833))
                                                                            (list
                                                                             'thaw
                                                                             W832)))
                                                                          (shen/shen.remove-indirection
                                                                           W834))))))))))
   ((shen/and (shen/cons? V827)
              (shen/and (shen/cons? (shen/hd V827))
                        (shen/and (shen/cons? (nthcdr 1 (shen/hd V827)))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 (shen/hd V827)))))))
    (list 'if (shen/hd (shen/hd V827)) (shen/hd (nthcdr 1 (shen/hd V827)))
          (shen/shen.factor-recognisors (nthcdr 1 V827))))
   (shen/true (shen/shen.f-error 'shen.factor-recognisors))))
(defun shen/shen.bad-pivot? (V839)
  (shen/cond
   ((shen/and (shen/cons? V839)
              (shen/internal/predicate->shen (null (nthcdr 1 V839))))
    'true)
   (shen/true 'false)))
(defun shen/shen.remove-indirection (V840)
  (shen/cond
   ((shen/and (shen/cons? V840)
              (shen/and (shen/= 'let (shen/hd V840))
                        (shen/and (shen/cons? (nthcdr 1 V840))
                                  (shen/and (shen/cons? (nthcdr 2 V840))
                                            (shen/and
                                             (shen/cons?
                                              (shen/hd (nthcdr 2 V840)))
                                             (shen/and
                                              (shen/= 'freeze
                                                      (shen/hd
                                                       (shen/hd (nthcdr 2 V840))))
                                              (shen/and
                                               (shen/cons?
                                                (nthcdr 1
                                                        (shen/hd (nthcdr 2 V840))))
                                               (shen/and
                                                (shen/cons?
                                                 (shen/hd
                                                  (nthcdr 1
                                                          (shen/hd
                                                           (nthcdr 2 V840)))))
                                                (shen/and
                                                 (shen/= 'thaw
                                                         (shen/hd
                                                          (shen/hd
                                                           (nthcdr 1
                                                                   (shen/hd
                                                                    (nthcdr 2
                                                                            V840))))))
                                                 (shen/and
                                                  (shen/cons?
                                                   (nthcdr 1
                                                           (shen/hd
                                                            (nthcdr 1
                                                                    (shen/hd
                                                                     (nthcdr 2
                                                                             V840))))))
                                                  (shen/and
                                                   (shen/internal/predicate->shen
                                                    (null
                                                     (nthcdr 2
                                                             (shen/hd
                                                              (nthcdr 1
                                                                      (shen/hd
                                                                       (nthcdr 2
                                                                               V840)))))))
                                                   (shen/and
                                                    (shen/internal/predicate->shen
                                                     (null
                                                      (nthcdr 2
                                                              (shen/hd
                                                               (nthcdr 2 V840)))))
                                                    (shen/and
                                                     (shen/cons? (nthcdr 3 V840))
                                                     (shen/and
                                                      (shen/internal/predicate->shen
                                                       (null (nthcdr 4 V840)))
                                                      (shen/symbol?
                                                       (shen/hd
                                                        (nthcdr 1
                                                                (shen/hd
                                                                 (nthcdr 1
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           2
                                                                           V840)))))))))))))))))))))
    (shen/subst
     (shen/hd (nthcdr 1 (shen/hd (nthcdr 1 (shen/hd (nthcdr 2 V840))))))
     (shen/hd (nthcdr 1 V840)) (shen/hd (nthcdr 3 V840))))
   (shen/true V840)))
(defun shen/shen.pivot-on (V843 V844 V845)
  (cl-flet
      ((tail-trampoline (V843 V844 V845)
         (shen/cond
          ((shen/and (shen/cons? V844)
                     (shen/and (shen/cons? (shen/hd V844))
                               (shen/and (shen/cons? (shen/hd (shen/hd V844)))
                                         (shen/and
                                          (shen/= 'and
                                                  (shen/hd
                                                   (shen/hd (shen/hd V844))))
                                          (shen/and
                                           (shen/cons?
                                            (nthcdr 1 (shen/hd (shen/hd V844))))
                                           (shen/and
                                            (shen/cons?
                                             (nthcdr 2 (shen/hd (shen/hd V844))))
                                            (shen/and
                                             (shen/internal/predicate->shen
                                              (null
                                               (nthcdr 3
                                                       (shen/hd (shen/hd V844)))))
                                             (shen/and
                                              (shen/cons?
                                               (nthcdr 1 (shen/hd V844)))
                                              (shen/and
                                               (shen/internal/predicate->shen
                                                (null (nthcdr 2 (shen/hd V844))))
                                               (shen/= V843
                                                       (shen/hd
                                                        (nthcdr 1
                                                                (shen/hd
                                                                 (shen/hd V844))))))))))))))
           (vector
            (list (shen/hd (nthcdr 1 (shen/hd (shen/hd V844)))) (nthcdr 1 V844)
                  (append
                   (list
                    (append (list (shen/hd (nthcdr 2 (shen/hd (shen/hd V844)))))
                            (nthcdr 1 (shen/hd V844))))
                   V845))))
          ((shen/and (shen/cons? V844)
                     (shen/and (shen/cons? (shen/hd V844))
                               (shen/and (shen/cons? (nthcdr 1 (shen/hd V844)))
                                         (shen/and
                                          (shen/internal/predicate->shen
                                           (null (nthcdr 2 (shen/hd V844))))
                                          (shen/= V843 (shen/hd (shen/hd V844)))))))
           (vector
            (list (shen/hd (shen/hd V844)) (nthcdr 1 V844)
                  (append (list (append (list 'true) (nthcdr 1 (shen/hd V844))))
                          V845))))
          (shen/true (shen/@p V845 V844)))))
    (let ((result (funcall #'tail-trampoline V843 V844 V845)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.factor-selectors (V848 V849)
  (shen/cond
   ((shen/and (shen/cons? V848)
              (shen/and (shen/cons? (nthcdr 1 V848))
                        (shen/internal/predicate->shen (null (nthcdr 2 V848)))))
    (shen/let W850 (shen/shen.op (shen/hd V848))
              (shen/if (shen/= 'shen.skip W850) V849
                       (shen/shen.factor-selectors-h
                        (list
                         (append (list (shen/shen.op1 W850)) (nthcdr 1 V848))
                         (append (list (shen/shen.op2 W850)) (nthcdr 1 V848)))
                        V849))))
   (shen/true V849)))
(defun shen/shen.op (V853)
  (shen/cond ((shen/= 'cons? V853) 'cons) ((shen/= 'shen.+string? V853) '@s)
             ((shen/= 'shen.+vector? V853) '@v) ((shen/= 'tuple? V853) '@p)
             (shen/true 'shen.skip)))
(defun shen/shen.factor-selectors-h (V854 V855)
  (cl-flet
      ((tail-trampoline (V854 V855)
         (shen/cond ((shen/internal/predicate->shen (null V854)) V855)
                    ((shen/cons? V854)
                     (shen/if (shen/> (shen/occurrences (shen/hd V854) V855) 1)
                              (shen/let W856 (shen/gensym 'Select)
                                        (list 'let W856 (shen/hd V854)
                                              (shen/shen.factor-selectors-h
                                               (nthcdr 1 V854)
                                               (shen/subst W856 (shen/hd V854)
                                                           V855))))
                              (vector (list (nthcdr 1 V854) V855))))
                    (shen/true (shen/shen.f-error 'shen.factor-selectors-h)))))
    (let ((result (funcall #'tail-trampoline V854 V855)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.native-hash (V4199 V4200)
  (shen/shen.mod (shen/shen.hashkey V4199) V4200))
(defun shen/shen.dict (Size)
  (let ((Dict (shen/absvector 4)) (Contents (shen/absvector Size)))
    (progn
      (shen/address-> Dict 0 'dictionary) (shen/address-> Dict 1 Size)
      (shen/address-> Dict 2 0) (shen/address-> Dict 3 Contents) Dict)))
(defun shen/shen.dict? (V4207)
  (shen/and (shen/absvector? V4207)
            (shen/=
             (shen/trap-error (shen/<-address V4207 0)
                              (shen/lambda Z4208 'shen.not-dictionary))
             'shen.dictionary)))
(defun shen/shen.dict-capacity (V4209) (shen/<-address V4209 1))
(defun shen/shen.dict-count (V4210) (shen/<-address V4210 2))
(defun shen/shen.dict-count-> (V4211 V4212) (shen/address-> V4211 2 V4212))
(defun shen/shen.<-dict-bucket (V4213 V4214)
  (shen/<-address V4213 (shen/+ 3 V4214)))
(defun shen/shen.dict-bucket-> (V4215 V4216 V4217)
  (shen/address-> V4215 (shen/+ 3 V4216) V4217))
(defun shen/shen.dict-update-count (V4218 V4219 V4220)
  (shen/let W4221 (shen/- (shen/length V4220) (shen/length V4219))
            (shen/shen.dict-count-> V4218
                                    (shen/+ W4221 (shen/shen.dict-count V4218)))))
(defun shen/shen.dict-> (Dict Key Value)
  (let*
      ((Count (shen/shen.dict-count Dict)) (Contents (shen/<-address Dict 3))
       (Exists (shen/<-address Contents Key)))
    (progn
      (if (not Exists) (shen/address-> Dict 2 (1+ Count)))
      (shen/address-> Contents Key Value))))
(defun shen/shen.<-dict (Dict Key)
  (let*
      ((Contents (shen/<-address Dict 3))
       (Existing (shen/<-address Contents Key)))
    (if (not Existing) (shen/freeze (shen/simple-error "value not found"))
      Existing)))
(defun shen/shen.dict-rm (Dict Key)
  (let*
      ((Count (shen/shen.dict-count Dict)) (Contents (shen/<-address Dict 3))
       (Exists (shen/<-address Contents Key)))
    (if (not Exists) Key
      (progn (remhash Key Contents) (shen/address-> Dict 2 (1- Count)) Key))))
(defun shen/shen.dict-fold (F Dict Acc)
  (let ((Contents (shen/<-address Dict 3)))
    (progn
      (setq NewAcc Acc)
      (maphash
       (lambda (Key Value)
         (setq NewAcc
               (shen/internal/apply-higher-order-function F
                                                          (list Key Value NewAcc))))
       Contents)
      NewAcc)))
(defun shen/shen.dict-fold-h (V4247 V4248 V4249 V4250 V4251)
  (cl-flet
      ((tail-trampoline (V4247 V4248 V4249 V4250 V4251)
         (shen/cond ((shen/= V4250 V4251) V4249)
                    (shen/true
                     (shen/let W4252 (shen/shen.<-dict-bucket V4248 V4250)
                               (shen/let W4253
                                         (shen/shen.bucket-fold V4247 W4252
                                                                V4249)
                                         (vector
                                          (list V4247 V4248 W4253 (1+ V4250)
                                                V4251))))))))
    (let ((result (funcall #'tail-trampoline V4247 V4248 V4249 V4250 V4251)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.bucket-fold (V4254 V4255 V4256)
  (cl-flet
      ((tail-trampoline (V4254 V4255 V4256)
         (shen/cond ((shen/internal/predicate->shen (null V4255)) V4256)
                    ((shen/and (shen/cons? V4255) (shen/cons? (shen/hd V4255)))
                     (shen/internal/apply-function-expression
                      (shen/internal/apply-function-expression
                       (shen/internal/apply-higher-order-function V4254
                                                                  (list
                                                                   (shen/hd
                                                                    (shen/hd
                                                                     V4255))))
                       (list (nthcdr 1 (shen/hd V4255))))
                      (list (vector (list V4254 (nthcdr 1 V4255) V4256)))))
                    (shen/true (shen/shen.f-error 'shen.bucket-fold)))))
    (let ((result (funcall #'tail-trampoline V4254 V4255 V4256)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.dict-keys (Dict)
  (let* ((Contents (shen/<-address Dict 3))) (hash-table-keys Contents)))
(defun shen/shen.dict-values (Dict)
  (let* ((Contents (shen/<-address Dict 3))) (hash-table-values Contents)))
(defun shen/read-file (V2481)
  (shen/let W2482 (shen/read-file-as-bytelist V2481)
            (shen/let W2483
                      (shen/trap-error
                       (shen/compile
                        (shen/lambda Z2484 (shen/shen.<s-exprs> Z2484)) W2482)
                       (shen/lambda Z2485
                                    (shen/shen.print-residue
                                     (shen/value 'shen.*residue*))))
                      (shen/let W2486 (shen/shen.process-sexprs W2483) W2486))))
(defun shen/shen.print-residue (V2487)
  (shen/let W2488 (shen/pr "syntax error here:\n" (shen/stoutput))
            (shen/shen.nchars 50 V2487)))
(defun shen/shen.nchars (V2493 V2494)
  (cl-flet
      ((tail-trampoline (V2493 V2494)
         (shen/cond
          ((shen/= 0 V2493)
           (shen/do (shen/pr " ..." (shen/stoutput)) (shen/abort)))
          ((shen/internal/predicate->shen (null V2494))
           (shen/do (shen/pr " ..." (shen/stoutput)) (shen/abort)))
          ((shen/cons? V2494)
           (shen/do (shen/pr (shen/n->string (shen/hd V2494)) (shen/stoutput))
                    (vector (list (shen/- V2493 1) (nthcdr 1 V2494)))))
          (shen/true (shen/shen.f-error 'shen.nchars)))))
    (let ((result (funcall #'tail-trampoline V2493 V2494)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/it nil (shen/value 'shen.*it*))
(defun shen/read-file-as-bytelist (V2495)
  (shen/let W2496 (shen/open V2495 'in)
            (shen/let W2497 (shen/read-byte W2496)
                      (shen/let W2498
                                (shen/shen.read-file-as-bytelist-help W2496
                                                                      W2497 nil)
                                (shen/let W2499 (shen/close W2496)
                                          (shen/reverse W2498))))))
(defun shen/shen.read-file-as-bytelist-help (V2500 V2501 V2502)
  (cl-flet
      ((tail-trampoline (V2500 V2501 V2502)
         (shen/cond ((shen/= -1 V2501) V2502)
                    (shen/true
                     (vector
                      (list V2500 (shen/read-byte V2500)
                            (append (list V2501) V2502)))))))
    (let ((result (funcall #'tail-trampoline V2500 V2501 V2502)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/read-file-as-string (V2503)
  (shen/let W2504 (shen/open V2503 'in)
            (shen/shen.rfas-h W2504 (shen/read-byte W2504) "")))
(defun shen/shen.rfas-h (V2505 V2506 V2507)
  (cl-flet
      ((tail-trampoline (V2505 V2506 V2507)
         (shen/cond ((shen/= -1 V2506) (shen/do (shen/close V2505) V2507))
                    (shen/true
                     (vector
                      (list V2505 (shen/read-byte V2505)
                            (shen/cn V2507 (shen/n->string V2506))))))))
    (let ((result (funcall #'tail-trampoline V2505 V2506 V2507)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/input (V2508) (shen/eval-kl (shen/read V2508)))
(defun shen/input+ (V2509 V2510)
  (shen/let W2511 (shen/shen.monotype V2509)
            (shen/let W2512 (shen/read V2510)
                      (shen/if
                       (shen/= 'false
                               (shen/shen.typecheck W2512
                                                    (shen/shen.rectify-type
                                                     V2509)))
                       (shen/simple-error
                        (shen/cn "type error: "
                                 (shen/shen.app W2512
                                                (shen/cn " is not of type "
                                                         (shen/shen.app V2509
                                                                        "\n"
                                                                        'shen.r))
                                                'shen.r)))
                       (shen/eval-kl W2512)))))
(defun shen/shen.monotype (V2513)
  (shen/cond
   ((shen/cons? V2513)
    (shen/map (shen/lambda Z2514 (shen/shen.monotype Z2514)) V2513))
   (shen/true
    (shen/if (shen/variable? V2513)
             (shen/simple-error
              (shen/cn "input+ expects a monotype: not "
                       (shen/shen.app V2513 "\n" 'shen.a)))
             V2513))))
(defun shen/lineread (V2515)
  (shen/shen.read-loop V2515 (shen/shen.my-read-byte V2515) nil
                       (shen/lambda Z2516 (shen/shen.return? Z2516))))
(defun shen/read-from-string (V2517)
  (shen/let W2518 (shen/shen.str->bytes V2517)
            (shen/let W2519
                      (shen/compile
                       (shen/lambda Z2520 (shen/shen.<s-exprs> Z2520)) W2518)
                      (shen/let W2521 (shen/shen.process-sexprs W2519) W2521))))
(defun shen/read-from-string-unprocessed (V2522)
  (shen/let W2523 (shen/shen.str->bytes V2522)
            (shen/let W2524
                      (shen/compile
                       (shen/lambda Z2525 (shen/shen.<s-exprs> Z2525)) W2523)
                      W2524)))
(defun shen/shen.str->bytes (V2526)
  (shen/cond ((shen/= "" V2526) nil)
             ((shen/shen.+string? V2526)
              (append (list (shen/string->n (shen/hdstr V2526)))
                      (shen/shen.str->bytes (shen/tlstr V2526))))
             (shen/true (shen/shen.f-error 'shen.str->bytes))))
(defun shen/read (V2527)
  (shen/hd
   (shen/shen.read-loop V2527 (shen/shen.my-read-byte V2527) nil
                        (shen/lambda Z2528 (shen/shen.whitespace? Z2528)))))
(defun shen/shen.my-read-byte (V2529)
  (shen/if (shen/shen.char-stinput? V2529)
           (shen/string->n (shen/shen.read-unit-string V2529))
           (shen/read-byte V2529)))
(defun shen/shen.read-loop (V2534 V2535 V2536 V2537)
  (cl-flet
      ((tail-trampoline (V2534 V2535 V2536 V2537)
         (shen/cond ((shen/= 94 V2535) (shen/simple-error "read aborted"))
                    ((shen/= -1 V2535)
                     (shen/if (shen/empty? V2536)
                              (shen/simple-error "error: empty stream")
                              (shen/compile
                               (shen/lambda Z2538 (shen/shen.<s-exprs> Z2538))
                               V2536)))
                    ((shen/= 0 V2535)
                     (vector
                      (list V2534 (shen/shen.my-read-byte V2534) V2536 V2537)))
                    (shen/true
                     (shen/if
                      (shen/internal/apply-higher-order-function V2537
                                                                 (list V2535))
                      (shen/let W2539 (shen/shen.try-parse V2536)
                                (shen/if (shen/shen.nothing-doing? W2539)
                                         (vector
                                          (list V2534
                                                (shen/shen.my-read-byte V2534)
                                                (shen/append V2536 (list V2535))
                                                V2537))
                                         (shen/do (shen/shen.record-it V2536)
                                                  W2539)))
                      (vector
                       (list V2534 (shen/shen.my-read-byte V2534)
                             (shen/append V2536 (list V2535)) V2537)))))))
    (let ((result (funcall #'tail-trampoline V2534 V2535 V2536 V2537)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.try-parse (V2540)
  (shen/let W2541
            (shen/trap-error
             (shen/compile (shen/lambda Z2542 (shen/shen.<s-exprs> Z2542)) V2540)
             (shen/lambda Z2543 'shen.i-failed!))
            (shen/if (shen/shen.nothing-doing? W2541) 'shen.i-failed!
                     (shen/shen.process-sexprs W2541))))
(defun shen/shen.nothing-doing? (V2546)
  (shen/cond ((shen/= 'shen.i-failed! V2546) 'true)
             ((shen/internal/predicate->shen (null V2546)) 'true)
             (shen/true 'false)))
(defun shen/shen.record-it (V2547)
  (shen/set 'shen.*it* (shen/shen.bytes->string V2547)))
(defun shen/shen.bytes->string (V2548)
  (shen/cond ((shen/internal/predicate->shen (null V2548)) "")
             ((shen/cons? V2548)
              (shen/cn (shen/n->string (shen/hd V2548))
                       (shen/shen.bytes->string (nthcdr 1 V2548))))
             (shen/true (shen/shen.f-error 'shen.bytes->string))))
(defun shen/shen.process-sexprs (V2549)
  (shen/let W2550 (shen/shen.unpackage&macroexpand V2549)
            (shen/let W2551 (shen/shen.find-arities W2550)
                      (shen/let W2552 (shen/shen.find-types W2550)
                                (shen/map
                                 (shen/lambda Z2553
                                              (shen/shen.process-applications
                                               Z2553 W2552))
                                 W2550)))))
(defun shen/shen.find-types (V2554)
  (shen/cond
   ((shen/and (shen/cons? V2554)
              (shen/and (shen/cons? (nthcdr 1 V2554))
                        (shen/= (shen/hd V2554) (shen/intern ":"))))
    (append (list (shen/hd (nthcdr 1 V2554)))
            (shen/shen.find-types (nthcdr 2 V2554))))
   ((shen/cons? V2554)
    (shen/append (shen/shen.find-types (shen/hd V2554))
                 (shen/shen.find-types (nthcdr 1 V2554))))
   (shen/true nil)))
(defun shen/shen.find-arities (V2557)
  (shen/cond
   ((shen/and (shen/cons? V2557)
              (shen/and (shen/= 'define (shen/hd V2557))
                        (shen/and (shen/cons? (nthcdr 1 V2557))
                                  (shen/and (shen/cons? (nthcdr 2 V2557))
                                            (shen/= '{
                                                    (shen/hd (nthcdr 2 V2557)))))))
    (shen/shen.store-arity (shen/hd (nthcdr 1 V2557))
                           (shen/shen.find-arity (shen/hd (nthcdr 1 V2557)) 1
                                                 (nthcdr 3 V2557))))
   ((shen/and (shen/cons? V2557)
              (shen/and (shen/= 'define (shen/hd V2557))
                        (shen/cons? (nthcdr 1 V2557))))
    (shen/shen.store-arity (shen/hd (nthcdr 1 V2557))
                           (shen/shen.find-arity (shen/hd (nthcdr 1 V2557)) 0
                                                 (nthcdr 2 V2557))))
   ((shen/cons? V2557)
    (shen/map (shen/lambda Z2558 (shen/shen.find-arities Z2558)) V2557))
   (shen/true 'shen.skip)))
(defun shen/shen.store-arity (V2559 V2560)
  (shen/let W2561 (shen/arity V2559)
            (shen/if (shen/= W2561 -1)
                     (shen/shen.execute-store-arity V2559 V2560)
                     (shen/if (shen/= W2561 V2560) 'shen.skip
                              (shen/if (shen/shen.sysfunc? V2559)
                                       (shen/simple-error
                                        (shen/shen.app V2559
                                                       " is a system function\n"
                                                       'shen.a))
                                       (shen/do
                                        (shen/pr
                                         (shen/cn "changing the arity of "
                                                  (shen/shen.app V2559
                                                                 " may cause errors\n"
                                                                 'shen.a))
                                         (shen/stoutput))
                                        (shen/shen.execute-store-arity V2559
                                                                       V2560)))))))
(defun shen/shen.execute-store-arity (V2562 V2563)
  (shen/cond
   ((shen/= 0 V2563) (shen/put V2562 'arity 0 (shen/value '*property-vector*)))
   (shen/true
    (shen/do (shen/put V2562 'arity V2563 (shen/value '*property-vector*))
             (shen/shen.update-lambdatable V2562 V2563)))))
(defun shen/shen.update-lambdatable (V2564 V2565)
  (shen/let W2566 (shen/eval-kl (shen/shen.lambda-function (list V2564) V2565))
            (shen/let W2567
                      (shen/shen.set-lambda-form-entry
                       (append (list V2564) W2566))
                      V2565)))
(defun shen/shen.lambda-function (V2570 V2571)
  (shen/cond ((shen/= 0 V2571) 'shen.skip)
             ((shen/= 1 V2571)
              (shen/let W2572 (shen/gensym 'Y)
                        (list 'lambda W2572 (shen/append V2570 (list W2572)))))
             (shen/true
              (shen/let W2573 (shen/gensym 'Y)
                        (list 'lambda W2573
                              (shen/shen.lambda-function
                               (shen/append V2570 (list W2573)) (shen/- V2571 1)))))))
(defun shen/shen.assoc-> (V2583 V2584 V2585)
  (shen/cond
   ((shen/internal/predicate->shen (null V2585))
    (list (append (list V2583) V2584)))
   ((shen/and (shen/cons? V2585)
              (shen/and (shen/cons? (shen/hd V2585))
                        (shen/= V2583 (shen/hd (shen/hd V2585)))))
    (append (list (append (list (shen/hd (shen/hd V2585))) V2584))
            (nthcdr 1 V2585)))
   ((shen/cons? V2585)
    (append (list (shen/hd V2585))
            (shen/shen.assoc-> V2583 V2584 (nthcdr 1 V2585))))
   (shen/true (shen/simple-error "implementation error in shen.assoc->"))))
(defun shen/shen.find-arity (V2600 V2601 V2602)
  (cl-flet
      ((tail-trampoline (V2600 V2601 V2602)
         (shen/cond
          ((shen/and (shen/= 0 V2601)
                     (shen/and (shen/cons? V2602) (shen/= (shen/hd V2602) '->)))
           0)
          ((shen/and (shen/= 0 V2601)
                     (shen/and (shen/cons? V2602) (shen/= (shen/hd V2602) '<-)))
           0)
          ((shen/and (shen/= 0 V2601) (shen/cons? V2602))
           (1+ (shen/shen.find-arity V2600 0 (nthcdr 1 V2602))))
          ((shen/and (shen/= 1 V2601)
                     (shen/and (shen/cons? V2602) (shen/= '} (shen/hd V2602))))
           (vector (list V2600 0 (nthcdr 1 V2602))))
          ((shen/and (shen/= 1 V2601) (shen/cons? V2602))
           (vector (list V2600 1 (nthcdr 1 V2602))))
          ((shen/= 1 V2601)
           (shen/simple-error
            (shen/cn "syntax error in "
                     (shen/shen.app V2600 " definition: missing }\n" 'shen.a))))
          (shen/true
           (shen/simple-error
            (shen/cn "syntax error in "
                     (shen/shen.app V2600 " definition: missing -> or <-\n"
                                    'shen.a)))))))
    (let ((result (funcall #'tail-trampoline V2600 V2601 V2602)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.<s-exprs> (V2603)
  (shen/let W2604
            (shen/let W2605 (shen/shen.<lsb> V2603)
                      (shen/if (shen/shen.parse-failure? W2605)
                               (shen/shen.parse-failure)
                               (shen/let W2606 (shen/shen.in-> W2605)
                                         (shen/let W2607
                                                   (shen/shen.<s-exprs1> W2606)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2607)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2608
                                                              (shen/shen.<-out
                                                               W2607)
                                                              (shen/let W2609
                                                                        (shen/shen.in->
                                                                         W2607)
                                                                        (shen/let
                                                                         W2610
                                                                         (shen/shen.<rsb>
                                                                          W2609)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W2610)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W2611
                                                                           (shen/shen.in->
                                                                            W2610)
                                                                           (shen/let
                                                                            W2612
                                                                            (shen/shen.<s-exprs2>
                                                                             W2611)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W2612)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W2613
                                                                              (shen/shen.<-out
                                                                               W2612)
                                                                              (shen/let
                                                                               W2614
                                                                               (shen/shen.in->
                                                                                W2612)
                                                                               (shen/shen.comb
                                                                                W2614
                                                                                (append
                                                                                 (list
                                                                                  (shen/shen.cons-form
                                                                                   W2608))
                                                                                 W2613))))))))))))))))
            (shen/if (shen/shen.parse-failure? W2604)
                     (shen/let W2615
                               (shen/let W2616 (shen/shen.<lrb> V2603)
                                         (shen/if
                                          (shen/shen.parse-failure? W2616)
                                          (shen/shen.parse-failure)
                                          (shen/let W2617 (shen/shen.in-> W2616)
                                                    (shen/let W2618
                                                              (shen/shen.<s-exprs1>
                                                               W2617)
                                                              (shen/if
                                                               (shen/shen.parse-failure?
                                                                W2618)
                                                               (shen/shen.parse-failure)
                                                               (shen/let W2619
                                                                         (shen/shen.<-out
                                                                          W2618)
                                                                         (shen/let
                                                                          W2620
                                                                          (shen/shen.in->
                                                                           W2618)
                                                                          (shen/let
                                                                           W2621
                                                                           (shen/shen.<rrb>
                                                                            W2620)
                                                                           (shen/if
                                                                            (shen/shen.parse-failure?
                                                                             W2621)
                                                                            (shen/shen.parse-failure)
                                                                            (shen/let
                                                                             W2622
                                                                             (shen/shen.in->
                                                                              W2621)
                                                                             (shen/let
                                                                              W2623
                                                                              (shen/shen.<s-exprs2>
                                                                               W2622)
                                                                              (shen/if
                                                                               (shen/shen.parse-failure?
                                                                                W2623)
                                                                               (shen/shen.parse-failure)
                                                                               (shen/let
                                                                                W2624
                                                                                (shen/shen.<-out
                                                                                 W2623)
                                                                                (shen/let
                                                                                 W2625
                                                                                 (shen/shen.in->
                                                                                  W2623)
                                                                                 (shen/shen.comb
                                                                                  W2625
                                                                                  (shen/shen.add-sexpr
                                                                                   W2619
                                                                                   W2624))))))))))))))))
                               (shen/if (shen/shen.parse-failure? W2615)
                                        (shen/let W2626
                                                  (shen/let W2627
                                                            (shen/shen.<lcurly>
                                                             V2603)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W2627)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W2628
                                                                       (shen/shen.in->
                                                                        W2627)
                                                                       (shen/let
                                                                        W2629
                                                                        (shen/shen.<s-exprs>
                                                                         W2628)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W2629)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W2630
                                                                          (shen/shen.<-out
                                                                           W2629)
                                                                          (shen/let
                                                                           W2631
                                                                           (shen/shen.in->
                                                                            W2629)
                                                                           (shen/shen.comb
                                                                            W2631
                                                                            (append
                                                                             (list
                                                                              '{)
                                                                             W2630)))))))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W2626)
                                                   (shen/let W2632
                                                             (shen/let W2633
                                                                       (shen/shen.<rcurly>
                                                                        V2603)
                                                                       (shen/if
                                                                        (shen/shen.parse-failure?
                                                                         W2633)
                                                                        (shen/shen.parse-failure)
                                                                        (shen/let
                                                                         W2634
                                                                         (shen/shen.in->
                                                                          W2633)
                                                                         (shen/let
                                                                          W2635
                                                                          (shen/shen.<s-exprs>
                                                                           W2634)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W2635)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W2636
                                                                            (shen/shen.<-out
                                                                             W2635)
                                                                            (shen/let
                                                                             W2637
                                                                             (shen/shen.in->
                                                                              W2635)
                                                                             (shen/shen.comb
                                                                              W2637
                                                                              (append
                                                                               (list
                                                                                '})
                                                                               W2636)))))))))
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2632)
                                                              (shen/let W2638
                                                                        (shen/let
                                                                         W2639
                                                                         (shen/shen.<bar>
                                                                          V2603)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W2639)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W2640
                                                                           (shen/shen.in->
                                                                            W2639)
                                                                           (shen/let
                                                                            W2641
                                                                            (shen/shen.<s-exprs>
                                                                             W2640)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W2641)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W2642
                                                                              (shen/shen.<-out
                                                                               W2641)
                                                                              (shen/let
                                                                               W2643
                                                                               (shen/shen.in->
                                                                                W2641)
                                                                               (shen/shen.comb
                                                                                W2643
                                                                                (append
                                                                                 (list
                                                                                  'bar!)
                                                                                 W2642)))))))))
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W2638)
                                                                         (shen/let
                                                                          W2644
                                                                          (shen/let
                                                                           W2645
                                                                           (shen/shen.<semicolon>
                                                                            V2603)
                                                                           (shen/if
                                                                            (shen/shen.parse-failure?
                                                                             W2645)
                                                                            (shen/shen.parse-failure)
                                                                            (shen/let
                                                                             W2646
                                                                             (shen/shen.in->
                                                                              W2645)
                                                                             (shen/let
                                                                              W2647
                                                                              (shen/shen.<s-exprs>
                                                                               W2646)
                                                                              (shen/if
                                                                               (shen/shen.parse-failure?
                                                                                W2647)
                                                                               (shen/shen.parse-failure)
                                                                               (shen/let
                                                                                W2648
                                                                                (shen/shen.<-out
                                                                                 W2647)
                                                                                (shen/let
                                                                                 W2649
                                                                                 (shen/shen.in->
                                                                                  W2647)
                                                                                 (shen/shen.comb
                                                                                  W2649
                                                                                  (append
                                                                                   (list
                                                                                    (shen/intern
                                                                                     ";"))
                                                                                   W2648)))))))))
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W2644)
                                                                           (shen/let
                                                                            W2650
                                                                            (shen/let
                                                                             W2651
                                                                             (shen/shen.<colon>
                                                                              V2603)
                                                                             (shen/if
                                                                              (shen/shen.parse-failure?
                                                                               W2651)
                                                                              (shen/shen.parse-failure)
                                                                              (shen/let
                                                                               W2652
                                                                               (shen/shen.in->
                                                                                W2651)
                                                                               (shen/let
                                                                                W2653
                                                                                (shen/shen.<equal>
                                                                                 W2652)
                                                                                (shen/if
                                                                                 (shen/shen.parse-failure?
                                                                                  W2653)
                                                                                 (shen/shen.parse-failure)
                                                                                 (shen/let
                                                                                  W2654
                                                                                  (shen/shen.in->
                                                                                   W2653)
                                                                                  (shen/let
                                                                                   W2655
                                                                                   (shen/shen.<s-exprs>
                                                                                    W2654)
                                                                                   (shen/if
                                                                                    (shen/shen.parse-failure?
                                                                                     W2655)
                                                                                    (shen/shen.parse-failure)
                                                                                    (shen/let
                                                                                     W2656
                                                                                     (shen/shen.<-out
                                                                                      W2655)
                                                                                     (shen/let
                                                                                      W2657
                                                                                      (shen/shen.in->
                                                                                       W2655)
                                                                                      (shen/shen.comb
                                                                                       W2657
                                                                                       (append
                                                                                        (list
                                                                                         (shen/intern
                                                                                          ":="))
                                                                                        W2656))))))))))))
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W2650)
                                                                             (shen/let
                                                                              W2658
                                                                              (shen/let
                                                                               W2659
                                                                               (shen/shen.<colon>
                                                                                V2603)
                                                                               (shen/if
                                                                                (shen/shen.parse-failure?
                                                                                 W2659)
                                                                                (shen/shen.parse-failure)
                                                                                (shen/let
                                                                                 W2660
                                                                                 (shen/shen.in->
                                                                                  W2659)
                                                                                 (shen/let
                                                                                  W2661
                                                                                  (shen/shen.<s-exprs>
                                                                                   W2660)
                                                                                  (shen/if
                                                                                   (shen/shen.parse-failure?
                                                                                    W2661)
                                                                                   (shen/shen.parse-failure)
                                                                                   (shen/let
                                                                                    W2662
                                                                                    (shen/shen.<-out
                                                                                     W2661)
                                                                                    (shen/let
                                                                                     W2663
                                                                                     (shen/shen.in->
                                                                                      W2661)
                                                                                     (shen/shen.comb
                                                                                      W2663
                                                                                      (append
                                                                                       (list
                                                                                        (shen/intern
                                                                                         ":"))
                                                                                       W2662)))))))))
                                                                              (shen/if
                                                                               (shen/shen.parse-failure?
                                                                                W2658)
                                                                               (shen/let
                                                                                W2664
                                                                                (shen/let
                                                                                 W2665
                                                                                 (shen/shen.<comma>
                                                                                  V2603)
                                                                                 (shen/if
                                                                                  (shen/shen.parse-failure?
                                                                                   W2665)
                                                                                  (shen/shen.parse-failure)
                                                                                  (shen/let
                                                                                   W2666
                                                                                   (shen/shen.in->
                                                                                    W2665)
                                                                                   (shen/let
                                                                                    W2667
                                                                                    (shen/shen.<s-exprs>
                                                                                     W2666)
                                                                                    (shen/if
                                                                                     (shen/shen.parse-failure?
                                                                                      W2667)
                                                                                     (shen/shen.parse-failure)
                                                                                     (shen/let
                                                                                      W2668
                                                                                      (shen/shen.<-out
                                                                                       W2667)
                                                                                      (shen/let
                                                                                       W2669
                                                                                       (shen/shen.in->
                                                                                        W2667)
                                                                                       (shen/shen.comb
                                                                                        W2669
                                                                                        (append
                                                                                         (list
                                                                                          (shen/intern
                                                                                           ","))
                                                                                         W2668)))))))))
                                                                                (shen/if
                                                                                 (shen/shen.parse-failure?
                                                                                  W2664)
                                                                                 (shen/let
                                                                                  W2670
                                                                                  (shen/let
                                                                                   W2671
                                                                                   (shen/shen.<comment>
                                                                                    V2603)
                                                                                   (shen/if
                                                                                    (shen/shen.parse-failure?
                                                                                     W2671)
                                                                                    (shen/shen.parse-failure)
                                                                                    (shen/let
                                                                                     W2672
                                                                                     (shen/shen.in->
                                                                                      W2671)
                                                                                     (shen/let
                                                                                      W2673
                                                                                      (shen/shen.<s-exprs>
                                                                                       W2672)
                                                                                      (shen/if
                                                                                       (shen/shen.parse-failure?
                                                                                        W2673)
                                                                                       (shen/shen.parse-failure)
                                                                                       (shen/let
                                                                                        W2674
                                                                                        (shen/shen.<-out
                                                                                         W2673)
                                                                                        (shen/let
                                                                                         W2675
                                                                                         (shen/shen.in->
                                                                                          W2673)
                                                                                         (shen/shen.comb
                                                                                          W2675
                                                                                          W2674))))))))
                                                                                  (shen/if
                                                                                   (shen/shen.parse-failure?
                                                                                    W2670)
                                                                                   (shen/let
                                                                                    W2676
                                                                                    (shen/let
                                                                                     W2677
                                                                                     (shen/shen.<atom>
                                                                                      V2603)
                                                                                     (shen/if
                                                                                      (shen/shen.parse-failure?
                                                                                       W2677)
                                                                                      (shen/shen.parse-failure)
                                                                                      (shen/let
                                                                                       W2678
                                                                                       (shen/shen.<-out
                                                                                        W2677)
                                                                                       (shen/let
                                                                                        W2679
                                                                                        (shen/shen.in->
                                                                                         W2677)
                                                                                        (shen/let
                                                                                         W2680
                                                                                         (shen/shen.<s-exprs>
                                                                                          W2679)
                                                                                         (shen/if
                                                                                          (shen/shen.parse-failure?
                                                                                           W2680)
                                                                                          (shen/shen.parse-failure)
                                                                                          (shen/let
                                                                                           W2681
                                                                                           (shen/shen.<-out
                                                                                            W2680)
                                                                                           (shen/let
                                                                                            W2682
                                                                                            (shen/shen.in->
                                                                                             W2680)
                                                                                            (shen/shen.comb
                                                                                             W2682
                                                                                             (append
                                                                                              (list
                                                                                               W2678)
                                                                                              W2681))))))))))
                                                                                    (shen/if
                                                                                     (shen/shen.parse-failure?
                                                                                      W2676)
                                                                                     (shen/let
                                                                                      W2683
                                                                                      (shen/let
                                                                                       W2684
                                                                                       (shen/shen.<whitespaces>
                                                                                        V2603)
                                                                                       (shen/if
                                                                                        (shen/shen.parse-failure?
                                                                                         W2684)
                                                                                        (shen/shen.parse-failure)
                                                                                        (shen/let
                                                                                         W2685
                                                                                         (shen/shen.in->
                                                                                          W2684)
                                                                                         (shen/let
                                                                                          W2686
                                                                                          (shen/shen.<s-exprs>
                                                                                           W2685)
                                                                                          (shen/if
                                                                                           (shen/shen.parse-failure?
                                                                                            W2686)
                                                                                           (shen/shen.parse-failure)
                                                                                           (shen/let
                                                                                            W2687
                                                                                            (shen/shen.<-out
                                                                                             W2686)
                                                                                            (shen/let
                                                                                             W2688
                                                                                             (shen/shen.in->
                                                                                              W2686)
                                                                                             (shen/shen.comb
                                                                                              W2688
                                                                                              W2687))))))))
                                                                                      (shen/if
                                                                                       (shen/shen.parse-failure?
                                                                                        W2683)
                                                                                       (shen/let
                                                                                        W2689
                                                                                        (shen/let
                                                                                         W2690
                                                                                         (shen/<e>
                                                                                          V2603)
                                                                                         (shen/if
                                                                                          (shen/shen.parse-failure?
                                                                                           W2690)
                                                                                          (shen/shen.parse-failure)
                                                                                          (shen/let
                                                                                           W2691
                                                                                           (shen/shen.in->
                                                                                            W2690)
                                                                                           (shen/shen.comb
                                                                                            W2691
                                                                                            nil))))
                                                                                        (shen/if
                                                                                         (shen/shen.parse-failure?
                                                                                          W2689)
                                                                                         (shen/shen.parse-failure)
                                                                                         W2689))
                                                                                       W2683))
                                                                                     W2676))
                                                                                   W2670))
                                                                                 W2664))
                                                                               W2658))
                                                                             W2650))
                                                                           W2644))
                                                                         W2638))
                                                              W2632))
                                                   W2626))
                                        W2615))
                     W2604)))
(defun shen/shen.add-sexpr (V2692 V2693)
  (shen/cond
   ((shen/and (shen/cons? V2692)
              (shen/and (shen/= '$ (shen/hd V2692))
                        (shen/and (shen/cons? (nthcdr 1 V2692))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V2692))))))
    (shen/append (shen/explode (shen/hd (nthcdr 1 V2692))) V2693))
   (shen/true (append (list V2692) V2693))))
(defun shen/shen.<lsb> (V2694)
  (shen/let W2695
            (shen/if (shen/shen.hds=? V2694 91)
                     (shen/let W2696 (shen/tail V2694)
                               (shen/shen.comb W2696 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2695) (shen/shen.parse-failure)
                     W2695)))
(defun shen/shen.<rsb> (V2697)
  (shen/let W2698
            (shen/if (shen/shen.hds=? V2697 93)
                     (shen/let W2699 (shen/tail V2697)
                               (shen/shen.comb W2699 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2698) (shen/shen.parse-failure)
                     W2698)))
(defun shen/shen.<s-exprs1> (V2700)
  (shen/let W2701
            (shen/let W2702 (shen/shen.<s-exprs> V2700)
                      (shen/if (shen/shen.parse-failure? W2702)
                               (shen/shen.parse-failure)
                               (shen/let W2703 (shen/shen.<-out W2702)
                                         (shen/let W2704 (shen/shen.in-> W2702)
                                                   (shen/shen.comb W2704 W2703)))))
            (shen/if (shen/shen.parse-failure? W2701) (shen/shen.parse-failure)
                     W2701)))
(defun shen/shen.<s-exprs2> (V2705)
  (shen/let W2706
            (shen/let W2707 (shen/shen.<s-exprs> V2705)
                      (shen/if (shen/shen.parse-failure? W2707)
                               (shen/shen.parse-failure)
                               (shen/let W2708 (shen/shen.<-out W2707)
                                         (shen/let W2709 (shen/shen.in-> W2707)
                                                   (shen/shen.comb W2709 W2708)))))
            (shen/if (shen/shen.parse-failure? W2706) (shen/shen.parse-failure)
                     W2706)))
(defun shen/shen.cons-form (V2711)
  (shen/cond ((shen/internal/predicate->shen (null V2711)) nil)
             ((shen/and (shen/cons? V2711)
                        (shen/and (shen/cons? (nthcdr 1 V2711))
                                  (shen/and (shen/cons? (nthcdr 2 V2711))
                                            (shen/and
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V2711)))
                                             (shen/= (shen/hd (nthcdr 1 V2711))
                                                     'bar!)))))
              (append (list 'cons (shen/hd V2711)) (nthcdr 2 V2711)))
             ((shen/and (shen/cons? V2711)
                        (shen/and (shen/cons? (nthcdr 1 V2711))
                                  (shen/and (shen/cons? (nthcdr 2 V2711))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V2711))
                                             (shen/= (shen/hd (nthcdr 1 V2711))
                                                     'bar!)))))
              (shen/simple-error "misapplication of |\n"))
             ((shen/cons? V2711)
              (list 'cons (shen/hd V2711) (shen/shen.cons-form (nthcdr 1 V2711))))
             (shen/true (shen/shen.f-error 'shen.cons-form))))
(defun shen/shen.<lrb> (V2712)
  (shen/let W2713
            (shen/if (shen/shen.hds=? V2712 40)
                     (shen/let W2714 (shen/tail V2712)
                               (shen/shen.comb W2714 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2713) (shen/shen.parse-failure)
                     W2713)))
(defun shen/shen.<rrb> (V2715)
  (shen/let W2716
            (shen/if (shen/shen.hds=? V2715 41)
                     (shen/let W2717 (shen/tail V2715)
                               (shen/shen.comb W2717 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2716) (shen/shen.parse-failure)
                     W2716)))
(defun shen/shen.<lcurly> (V2718)
  (shen/let W2719
            (shen/if (shen/shen.hds=? V2718 123)
                     (shen/let W2720 (shen/tail V2718)
                               (shen/shen.comb W2720 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2719) (shen/shen.parse-failure)
                     W2719)))
(defun shen/shen.<rcurly> (V2721)
  (shen/let W2722
            (shen/if (shen/shen.hds=? V2721 125)
                     (shen/let W2723 (shen/tail V2721)
                               (shen/shen.comb W2723 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2722) (shen/shen.parse-failure)
                     W2722)))
(defun shen/shen.<bar> (V2724)
  (shen/let W2725
            (shen/if (shen/shen.hds=? V2724 124)
                     (shen/let W2726 (shen/tail V2724)
                               (shen/shen.comb W2726 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2725) (shen/shen.parse-failure)
                     W2725)))
(defun shen/shen.<semicolon> (V2727)
  (shen/let W2728
            (shen/if (shen/shen.hds=? V2727 59)
                     (shen/let W2729 (shen/tail V2727)
                               (shen/shen.comb W2729 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2728) (shen/shen.parse-failure)
                     W2728)))
(defun shen/shen.<colon> (V2730)
  (shen/let W2731
            (shen/if (shen/shen.hds=? V2730 58)
                     (shen/let W2732 (shen/tail V2730)
                               (shen/shen.comb W2732 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2731) (shen/shen.parse-failure)
                     W2731)))
(defun shen/shen.<comma> (V2733)
  (shen/let W2734
            (shen/if (shen/shen.hds=? V2733 44)
                     (shen/let W2735 (shen/tail V2733)
                               (shen/shen.comb W2735 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2734) (shen/shen.parse-failure)
                     W2734)))
(defun shen/shen.<equal> (V2736)
  (shen/let W2737
            (shen/if (shen/shen.hds=? V2736 61)
                     (shen/let W2738 (shen/tail V2736)
                               (shen/shen.comb W2738 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2737) (shen/shen.parse-failure)
                     W2737)))
(defun shen/shen.<comment> (V2739)
  (shen/let W2740
            (shen/let W2741 (shen/shen.<singleline> V2739)
                      (shen/if (shen/shen.parse-failure? W2741)
                               (shen/shen.parse-failure)
                               (shen/let W2742 (shen/shen.in-> W2741)
                                         (shen/shen.comb W2742 'shen.skip))))
            (shen/if (shen/shen.parse-failure? W2740)
                     (shen/let W2743
                               (shen/let W2744 (shen/shen.<multiline> V2739)
                                         (shen/if
                                          (shen/shen.parse-failure? W2744)
                                          (shen/shen.parse-failure)
                                          (shen/let W2745 (shen/shen.in-> W2744)
                                                    (shen/shen.comb W2745
                                                                    'shen.skip))))
                               (shen/if (shen/shen.parse-failure? W2743)
                                        (shen/shen.parse-failure) W2743))
                     W2740)))
(defun shen/shen.<singleline> (V2746)
  (shen/let W2747
            (shen/let W2748 (shen/shen.<backslash> V2746)
                      (shen/if (shen/shen.parse-failure? W2748)
                               (shen/shen.parse-failure)
                               (shen/let W2749 (shen/shen.in-> W2748)
                                         (shen/let W2750
                                                   (shen/shen.<backslash> W2749)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2750)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2751
                                                              (shen/shen.in->
                                                               W2750)
                                                              (shen/let W2752
                                                                        (shen/shen.<shortnatters>
                                                                         W2751)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W2752)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W2753
                                                                          (shen/shen.in->
                                                                           W2752)
                                                                          (shen/let
                                                                           W2754
                                                                           (shen/shen.<returns>
                                                                            W2753)
                                                                           (shen/if
                                                                            (shen/shen.parse-failure?
                                                                             W2754)
                                                                            (shen/shen.parse-failure)
                                                                            (shen/let
                                                                             W2755
                                                                             (shen/shen.in->
                                                                              W2754)
                                                                             (shen/shen.comb
                                                                              W2755
                                                                              'shen.skip)))))))))))))
            (shen/if (shen/shen.parse-failure? W2747) (shen/shen.parse-failure)
                     W2747)))
(defun shen/shen.<backslash> (V2756)
  (shen/let W2757
            (shen/if (shen/shen.hds=? V2756 92)
                     (shen/let W2758 (shen/tail V2756)
                               (shen/shen.comb W2758 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2757) (shen/shen.parse-failure)
                     W2757)))
(defun shen/shen.<shortnatters> (V2759)
  (shen/let W2760
            (shen/let W2761 (shen/shen.<shortnatter> V2759)
                      (shen/if (shen/shen.parse-failure? W2761)
                               (shen/shen.parse-failure)
                               (shen/let W2762 (shen/shen.in-> W2761)
                                         (shen/let W2763
                                                   (shen/shen.<shortnatters>
                                                    W2762)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2763)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2764
                                                              (shen/shen.in->
                                                               W2763)
                                                              (shen/shen.comb
                                                               W2764 'shen.skip)))))))
            (shen/if (shen/shen.parse-failure? W2760)
                     (shen/let W2765
                               (shen/let W2766 (shen/<e> V2759)
                                         (shen/if
                                          (shen/shen.parse-failure? W2766)
                                          (shen/shen.parse-failure)
                                          (shen/let W2767 (shen/shen.in-> W2766)
                                                    (shen/shen.comb W2767
                                                                    'shen.skip))))
                               (shen/if (shen/shen.parse-failure? W2765)
                                        (shen/shen.parse-failure) W2765))
                     W2760)))
(defun shen/shen.<shortnatter> (V2768)
  (shen/let W2769
            (shen/if (shen/cons? V2768)
                     (shen/let W2770 (shen/head V2768)
                               (shen/let W2771 (shen/tail V2768)
                                         (shen/if
                                          (shen/not (shen/shen.return? W2770))
                                          (shen/shen.comb W2771 'shen.skip)
                                          (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2769) (shen/shen.parse-failure)
                     W2769)))
(defun shen/shen.<returns> (V2772)
  (shen/let W2773
            (shen/let W2774 (shen/shen.<return> V2772)
                      (shen/if (shen/shen.parse-failure? W2774)
                               (shen/shen.parse-failure)
                               (shen/let W2775 (shen/shen.in-> W2774)
                                         (shen/let W2776
                                                   (shen/shen.<returns> W2775)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2776)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2777
                                                              (shen/shen.in->
                                                               W2776)
                                                              (shen/shen.comb
                                                               W2777 'shen.skip)))))))
            (shen/if (shen/shen.parse-failure? W2773)
                     (shen/let W2778
                               (shen/let W2779 (shen/shen.<return> V2772)
                                         (shen/if
                                          (shen/shen.parse-failure? W2779)
                                          (shen/shen.parse-failure)
                                          (shen/let W2780 (shen/shen.in-> W2779)
                                                    (shen/shen.comb W2780
                                                                    'shen.skip))))
                               (shen/if (shen/shen.parse-failure? W2778)
                                        (shen/shen.parse-failure) W2778))
                     W2773)))
(defun shen/shen.<return> (V2781)
  (shen/let W2782
            (shen/if (shen/cons? V2781)
                     (shen/let W2783 (shen/head V2781)
                               (shen/let W2784 (shen/tail V2781)
                                         (shen/if (shen/shen.return? W2783)
                                                  (shen/shen.comb W2784
                                                                  'shen.skip)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2782) (shen/shen.parse-failure)
                     W2782)))
(defun shen/shen.return? (V2785) (shen/element? V2785 (list 9 10 13)))
(defun shen/shen.<multiline> (V2786)
  (shen/let W2787
            (shen/let W2788 (shen/shen.<backslash> V2786)
                      (shen/if (shen/shen.parse-failure? W2788)
                               (shen/shen.parse-failure)
                               (shen/let W2789 (shen/shen.in-> W2788)
                                         (shen/let W2790
                                                   (shen/shen.<times> W2789)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2790)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2791
                                                              (shen/shen.in->
                                                               W2790)
                                                              (shen/let W2792
                                                                        (shen/shen.<longnatter>
                                                                         W2791)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W2792)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W2793
                                                                          (shen/shen.in->
                                                                           W2792)
                                                                          (shen/shen.comb
                                                                           W2793
                                                                           'shen.skip))))))))))
            (shen/if (shen/shen.parse-failure? W2787) (shen/shen.parse-failure)
                     W2787)))
(defun shen/shen.<times> (V2794)
  (shen/let W2795
            (shen/if (shen/shen.hds=? V2794 42)
                     (shen/let W2796 (shen/tail V2794)
                               (shen/shen.comb W2796 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2795) (shen/shen.parse-failure)
                     W2795)))
(defun shen/shen.<longnatter> (V2797)
  (shen/let W2798
            (shen/let W2799 (shen/shen.<comment> V2797)
                      (shen/if (shen/shen.parse-failure? W2799)
                               (shen/shen.parse-failure)
                               (shen/let W2800 (shen/shen.in-> W2799)
                                         (shen/let W2801
                                                   (shen/shen.<longnatter> W2800)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2801)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2802
                                                              (shen/shen.in->
                                                               W2801)
                                                              (shen/shen.comb
                                                               W2802 'shen.skip)))))))
            (shen/if (shen/shen.parse-failure? W2798)
                     (shen/let W2803
                               (shen/let W2804 (shen/shen.<times> V2797)
                                         (shen/if
                                          (shen/shen.parse-failure? W2804)
                                          (shen/shen.parse-failure)
                                          (shen/let W2805 (shen/shen.in-> W2804)
                                                    (shen/let W2806
                                                              (shen/shen.<backslash>
                                                               W2805)
                                                              (shen/if
                                                               (shen/shen.parse-failure?
                                                                W2806)
                                                               (shen/shen.parse-failure)
                                                               (shen/let W2807
                                                                         (shen/shen.in->
                                                                          W2806)
                                                                         (shen/shen.comb
                                                                          W2807
                                                                          'shen.skip)))))))
                               (shen/if (shen/shen.parse-failure? W2803)
                                        (shen/let W2808
                                                  (shen/if (shen/cons? V2797)
                                                           (shen/let W2809
                                                                     (shen/tail
                                                                      V2797)
                                                                     (shen/let
                                                                      W2810
                                                                      (shen/shen.<longnatter>
                                                                       W2809)
                                                                      (shen/if
                                                                       (shen/shen.parse-failure?
                                                                        W2810)
                                                                       (shen/shen.parse-failure)
                                                                       (shen/let
                                                                        W2811
                                                                        (shen/shen.in->
                                                                         W2810)
                                                                        (shen/shen.comb
                                                                         W2811
                                                                         'shen.skip)))))
                                                           (shen/shen.parse-failure))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W2808)
                                                   (shen/shen.parse-failure)
                                                   W2808))
                                        W2803))
                     W2798)))
(defun shen/shen.<atom> (V2812)
  (shen/let W2813
            (shen/let W2814 (shen/shen.<str> V2812)
                      (shen/if (shen/shen.parse-failure? W2814)
                               (shen/shen.parse-failure)
                               (shen/let W2815 (shen/shen.<-out W2814)
                                         (shen/let W2816 (shen/shen.in-> W2814)
                                                   (shen/shen.comb W2816 W2815)))))
            (shen/if (shen/shen.parse-failure? W2813)
                     (shen/let W2817
                               (shen/let W2818 (shen/shen.<number> V2812)
                                         (shen/if
                                          (shen/shen.parse-failure? W2818)
                                          (shen/shen.parse-failure)
                                          (shen/let W2819
                                                    (shen/shen.<-out W2818)
                                                    (shen/let W2820
                                                              (shen/shen.in->
                                                               W2818)
                                                              (shen/shen.comb
                                                               W2820 W2819)))))
                               (shen/if (shen/shen.parse-failure? W2817)
                                        (shen/let W2821
                                                  (shen/let W2822
                                                            (shen/shen.<sym>
                                                             V2812)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W2822)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W2823
                                                                       (shen/shen.<-out
                                                                        W2822)
                                                                       (shen/let
                                                                        W2824
                                                                        (shen/shen.in->
                                                                         W2822)
                                                                        (shen/shen.comb
                                                                         W2824
                                                                         (shen/if
                                                                          (shen/=
                                                                           W2823
                                                                           "<>")
                                                                          (list
                                                                           'vector
                                                                           0)
                                                                          (shen/intern
                                                                           W2823)))))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W2821)
                                                   (shen/shen.parse-failure)
                                                   W2821))
                                        W2817))
                     W2813)))
(defun shen/shen.<sym> (V2825)
  (shen/let W2826
            (shen/let W2827 (shen/shen.<alpha> V2825)
                      (shen/if (shen/shen.parse-failure? W2827)
                               (shen/shen.parse-failure)
                               (shen/let W2828 (shen/shen.<-out W2827)
                                         (shen/let W2829 (shen/shen.in-> W2827)
                                                   (shen/let W2830
                                                             (shen/shen.<alphanums>
                                                              W2829)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2830)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W2831
                                                                        (shen/shen.<-out
                                                                         W2830)
                                                                        (shen/let
                                                                         W2832
                                                                         (shen/shen.in->
                                                                          W2830)
                                                                         (shen/shen.comb
                                                                          W2832
                                                                          (shen/cn
                                                                           W2828
                                                                           W2831))))))))))
            (shen/if (shen/shen.parse-failure? W2826) (shen/shen.parse-failure)
                     W2826)))
(defun shen/shen.<alpha> (V2833)
  (shen/let W2834
            (shen/if (shen/cons? V2833)
                     (shen/let W2835 (shen/head V2833)
                               (shen/let W2836 (shen/tail V2833)
                                         (shen/if (shen/shen.alpha? W2835)
                                                  (shen/shen.comb W2836
                                                                  (shen/n->string
                                                                   W2835))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2834) (shen/shen.parse-failure)
                     W2834)))
(defun shen/shen.alpha? (V2837)
  (shen/or (shen/shen.lowercase? V2837)
           (shen/or (shen/shen.uppercase? V2837) (shen/shen.misc? V2837))))
(defun shen/shen.lowercase? (V2838)
  (shen/and (shen/>= V2838 97) (shen/<= V2838 122)))
(defun shen/shen.uppercase? (V2839)
  (shen/and (shen/>= V2839 65) (shen/<= V2839 90)))
(defun shen/shen.misc? (V2840)
  (shen/element? V2840
                 (list 61 45 42 47 43 95 63 36 33 64 126 46 62 60 38 37 39 35 96)))
(defun shen/shen.<alphanums> (V2841)
  (shen/let W2842
            (shen/let W2843 (shen/shen.<alphanum> V2841)
                      (shen/if (shen/shen.parse-failure? W2843)
                               (shen/shen.parse-failure)
                               (shen/let W2844 (shen/shen.<-out W2843)
                                         (shen/let W2845 (shen/shen.in-> W2843)
                                                   (shen/let W2846
                                                             (shen/shen.<alphanums>
                                                              W2845)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2846)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W2847
                                                                        (shen/shen.<-out
                                                                         W2846)
                                                                        (shen/let
                                                                         W2848
                                                                         (shen/shen.in->
                                                                          W2846)
                                                                         (shen/shen.comb
                                                                          W2848
                                                                          (shen/cn
                                                                           W2844
                                                                           W2847))))))))))
            (shen/if (shen/shen.parse-failure? W2842)
                     (shen/let W2849
                               (shen/let W2850 (shen/<e> V2841)
                                         (shen/if
                                          (shen/shen.parse-failure? W2850)
                                          (shen/shen.parse-failure)
                                          (shen/let W2851 (shen/shen.in-> W2850)
                                                    (shen/shen.comb W2851 ""))))
                               (shen/if (shen/shen.parse-failure? W2849)
                                        (shen/shen.parse-failure) W2849))
                     W2842)))
(defun shen/shen.<alphanum> (V2852)
  (shen/let W2853
            (shen/let W2854 (shen/shen.<alpha> V2852)
                      (shen/if (shen/shen.parse-failure? W2854)
                               (shen/shen.parse-failure)
                               (shen/let W2855 (shen/shen.<-out W2854)
                                         (shen/let W2856 (shen/shen.in-> W2854)
                                                   (shen/shen.comb W2856 W2855)))))
            (shen/if (shen/shen.parse-failure? W2853)
                     (shen/let W2857
                               (shen/let W2858 (shen/shen.<numeral> V2852)
                                         (shen/if
                                          (shen/shen.parse-failure? W2858)
                                          (shen/shen.parse-failure)
                                          (shen/let W2859
                                                    (shen/shen.<-out W2858)
                                                    (shen/let W2860
                                                              (shen/shen.in->
                                                               W2858)
                                                              (shen/shen.comb
                                                               W2860 W2859)))))
                               (shen/if (shen/shen.parse-failure? W2857)
                                        (shen/shen.parse-failure) W2857))
                     W2853)))
(defun shen/shen.<numeral> (V2861)
  (shen/let W2862
            (shen/if (shen/cons? V2861)
                     (shen/let W2863 (shen/head V2861)
                               (shen/let W2864 (shen/tail V2861)
                                         (shen/if (shen/shen.digit? W2863)
                                                  (shen/shen.comb W2864
                                                                  (shen/n->string
                                                                   W2863))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2862) (shen/shen.parse-failure)
                     W2862)))
(defun shen/shen.digit? (V2865)
  (shen/and (shen/>= V2865 48) (shen/<= V2865 57)))
(defun shen/shen.<str> (V2866)
  (shen/let W2867
            (shen/let W2868 (shen/shen.<dbq> V2866)
                      (shen/if (shen/shen.parse-failure? W2868)
                               (shen/shen.parse-failure)
                               (shen/let W2869 (shen/shen.in-> W2868)
                                         (shen/let W2870
                                                   (shen/shen.<strcontents>
                                                    W2869)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2870)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2871
                                                              (shen/shen.<-out
                                                               W2870)
                                                              (shen/let W2872
                                                                        (shen/shen.in->
                                                                         W2870)
                                                                        (shen/let
                                                                         W2873
                                                                         (shen/shen.<dbq>
                                                                          W2872)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W2873)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W2874
                                                                           (shen/shen.in->
                                                                            W2873)
                                                                           (shen/shen.comb
                                                                            W2874
                                                                            W2871)))))))))))
            (shen/if (shen/shen.parse-failure? W2867) (shen/shen.parse-failure)
                     W2867)))
(defun shen/shen.<dbq> (V2875)
  (shen/let W2876
            (shen/if (shen/shen.hds=? V2875 34)
                     (shen/let W2877 (shen/tail V2875)
                               (shen/shen.comb W2877 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2876) (shen/shen.parse-failure)
                     W2876)))
(defun shen/shen.<strcontents> (V2878)
  (shen/let W2879
            (shen/let W2880 (shen/shen.<strc> V2878)
                      (shen/if (shen/shen.parse-failure? W2880)
                               (shen/shen.parse-failure)
                               (shen/let W2881 (shen/shen.<-out W2880)
                                         (shen/let W2882 (shen/shen.in-> W2880)
                                                   (shen/let W2883
                                                             (shen/shen.<strcontents>
                                                              W2882)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2883)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W2884
                                                                        (shen/shen.<-out
                                                                         W2883)
                                                                        (shen/let
                                                                         W2885
                                                                         (shen/shen.in->
                                                                          W2883)
                                                                         (shen/shen.comb
                                                                          W2885
                                                                          (shen/cn
                                                                           W2881
                                                                           W2884))))))))))
            (shen/if (shen/shen.parse-failure? W2879)
                     (shen/let W2886
                               (shen/let W2887 (shen/<e> V2878)
                                         (shen/if
                                          (shen/shen.parse-failure? W2887)
                                          (shen/shen.parse-failure)
                                          (shen/let W2888 (shen/shen.in-> W2887)
                                                    (shen/shen.comb W2888 ""))))
                               (shen/if (shen/shen.parse-failure? W2886)
                                        (shen/shen.parse-failure) W2886))
                     W2879)))
(defun shen/shen.<strc> (V2889)
  (shen/let W2890
            (shen/let W2891 (shen/shen.<control> V2889)
                      (shen/if (shen/shen.parse-failure? W2891)
                               (shen/shen.parse-failure)
                               (shen/let W2892 (shen/shen.<-out W2891)
                                         (shen/let W2893 (shen/shen.in-> W2891)
                                                   (shen/shen.comb W2893 W2892)))))
            (shen/if (shen/shen.parse-failure? W2890)
                     (shen/let W2894
                               (shen/let W2895 (shen/shen.<notdbq> V2889)
                                         (shen/if
                                          (shen/shen.parse-failure? W2895)
                                          (shen/shen.parse-failure)
                                          (shen/let W2896
                                                    (shen/shen.<-out W2895)
                                                    (shen/let W2897
                                                              (shen/shen.in->
                                                               W2895)
                                                              (shen/shen.comb
                                                               W2897 W2896)))))
                               (shen/if (shen/shen.parse-failure? W2894)
                                        (shen/shen.parse-failure) W2894))
                     W2890)))
(defun shen/shen.<control> (V2898)
  (shen/let W2899
            (shen/let W2900 (shen/shen.<lowC> V2898)
                      (shen/if (shen/shen.parse-failure? W2900)
                               (shen/shen.parse-failure)
                               (shen/let W2901 (shen/shen.in-> W2900)
                                         (shen/let W2902
                                                   (shen/shen.<hash> W2901)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2902)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2903
                                                              (shen/shen.in->
                                                               W2902)
                                                              (shen/let W2904
                                                                        (shen/shen.<integer>
                                                                         W2903)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W2904)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W2905
                                                                          (shen/shen.<-out
                                                                           W2904)
                                                                          (shen/let
                                                                           W2906
                                                                           (shen/shen.in->
                                                                            W2904)
                                                                           (shen/let
                                                                            W2907
                                                                            (shen/shen.<semicolon>
                                                                             W2906)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W2907)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W2908
                                                                              (shen/shen.in->
                                                                               W2907)
                                                                              (shen/shen.comb
                                                                               W2908
                                                                               (shen/n->string
                                                                                W2905)))))))))))))))
            (shen/if (shen/shen.parse-failure? W2899) (shen/shen.parse-failure)
                     W2899)))
(defun shen/shen.<notdbq> (V2909)
  (shen/let W2910
            (shen/if (shen/cons? V2909)
                     (shen/let W2911 (shen/head V2909)
                               (shen/let W2912 (shen/tail V2909)
                                         (shen/if (shen/not (shen/= W2911 34))
                                                  (shen/shen.comb W2912
                                                                  (shen/n->string
                                                                   W2911))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2910) (shen/shen.parse-failure)
                     W2910)))
(defun shen/shen.<lowC> (V2913)
  (shen/let W2914
            (shen/if (shen/shen.hds=? V2913 99)
                     (shen/let W2915 (shen/tail V2913)
                               (shen/shen.comb W2915 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2914) (shen/shen.parse-failure)
                     W2914)))
(defun shen/shen.<hash> (V2916)
  (shen/let W2917
            (shen/if (shen/shen.hds=? V2916 35)
                     (shen/let W2918 (shen/tail V2916)
                               (shen/shen.comb W2918 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2917) (shen/shen.parse-failure)
                     W2917)))
(defun shen/shen.<number> (V2919)
  (shen/let W2920
            (shen/let W2921 (shen/shen.<minus> V2919)
                      (shen/if (shen/shen.parse-failure? W2921)
                               (shen/shen.parse-failure)
                               (shen/let W2922 (shen/shen.in-> W2921)
                                         (shen/let W2923
                                                   (shen/shen.<number> W2922)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W2923)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W2924
                                                              (shen/shen.<-out
                                                               W2923)
                                                              (shen/let W2925
                                                                        (shen/shen.in->
                                                                         W2923)
                                                                        (shen/shen.comb
                                                                         W2925
                                                                         (shen/-
                                                                          0
                                                                          W2924)))))))))
            (shen/if (shen/shen.parse-failure? W2920)
                     (shen/let W2926
                               (shen/let W2927 (shen/shen.<plus> V2919)
                                         (shen/if
                                          (shen/shen.parse-failure? W2927)
                                          (shen/shen.parse-failure)
                                          (shen/let W2928 (shen/shen.in-> W2927)
                                                    (shen/let W2929
                                                              (shen/shen.<number>
                                                               W2928)
                                                              (shen/if
                                                               (shen/shen.parse-failure?
                                                                W2929)
                                                               (shen/shen.parse-failure)
                                                               (shen/let W2930
                                                                         (shen/shen.<-out
                                                                          W2929)
                                                                         (shen/let
                                                                          W2931
                                                                          (shen/shen.in->
                                                                           W2929)
                                                                          (shen/shen.comb
                                                                           W2931
                                                                           W2930))))))))
                               (shen/if (shen/shen.parse-failure? W2926)
                                        (shen/let W2932
                                                  (shen/let W2933
                                                            (shen/shen.<e-number>
                                                             V2919)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W2933)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W2934
                                                                       (shen/shen.<-out
                                                                        W2933)
                                                                       (shen/let
                                                                        W2935
                                                                        (shen/shen.in->
                                                                         W2933)
                                                                        (shen/shen.comb
                                                                         W2935
                                                                         W2934)))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W2932)
                                                   (shen/let W2936
                                                             (shen/let W2937
                                                                       (shen/shen.<float>
                                                                        V2919)
                                                                       (shen/if
                                                                        (shen/shen.parse-failure?
                                                                         W2937)
                                                                        (shen/shen.parse-failure)
                                                                        (shen/let
                                                                         W2938
                                                                         (shen/shen.<-out
                                                                          W2937)
                                                                         (shen/let
                                                                          W2939
                                                                          (shen/shen.in->
                                                                           W2937)
                                                                          (shen/shen.comb
                                                                           W2939
                                                                           W2938)))))
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2936)
                                                              (shen/let W2940
                                                                        (shen/let
                                                                         W2941
                                                                         (shen/shen.<integer>
                                                                          V2919)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W2941)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W2942
                                                                           (shen/shen.<-out
                                                                            W2941)
                                                                           (shen/let
                                                                            W2943
                                                                            (shen/shen.in->
                                                                             W2941)
                                                                            (shen/shen.comb
                                                                             W2943
                                                                             W2942)))))
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W2940)
                                                                         (shen/shen.parse-failure)
                                                                         W2940))
                                                              W2936))
                                                   W2932))
                                        W2926))
                     W2920)))
(defun shen/shen.<minus> (V2944)
  (shen/let W2945
            (shen/if (shen/shen.hds=? V2944 45)
                     (shen/let W2946 (shen/tail V2944)
                               (shen/shen.comb W2946 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2945) (shen/shen.parse-failure)
                     W2945)))
(defun shen/shen.<plus> (V2947)
  (shen/let W2948
            (shen/if (shen/shen.hds=? V2947 43)
                     (shen/let W2949 (shen/tail V2947)
                               (shen/shen.comb W2949 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2948) (shen/shen.parse-failure)
                     W2948)))
(defun shen/shen.<integer> (V2950)
  (shen/let W2951
            (shen/let W2952 (shen/shen.<digits> V2950)
                      (shen/if (shen/shen.parse-failure? W2952)
                               (shen/shen.parse-failure)
                               (shen/let W2953 (shen/shen.<-out W2952)
                                         (shen/let W2954 (shen/shen.in-> W2952)
                                                   (shen/shen.comb W2954
                                                                   (shen/shen.compute-integer
                                                                    W2953))))))
            (shen/if (shen/shen.parse-failure? W2951) (shen/shen.parse-failure)
                     W2951)))
(defun shen/shen.<digits> (V2955)
  (shen/let W2956
            (shen/let W2957 (shen/shen.<digit> V2955)
                      (shen/if (shen/shen.parse-failure? W2957)
                               (shen/shen.parse-failure)
                               (shen/let W2958 (shen/shen.<-out W2957)
                                         (shen/let W2959 (shen/shen.in-> W2957)
                                                   (shen/let W2960
                                                             (shen/shen.<digits>
                                                              W2959)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2960)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W2961
                                                                        (shen/shen.<-out
                                                                         W2960)
                                                                        (shen/let
                                                                         W2962
                                                                         (shen/shen.in->
                                                                          W2960)
                                                                         (shen/shen.comb
                                                                          W2962
                                                                          (append
                                                                           (list
                                                                            W2958)
                                                                           W2961))))))))))
            (shen/if (shen/shen.parse-failure? W2956)
                     (shen/let W2963
                               (shen/let W2964 (shen/shen.<digit> V2955)
                                         (shen/if
                                          (shen/shen.parse-failure? W2964)
                                          (shen/shen.parse-failure)
                                          (shen/let W2965
                                                    (shen/shen.<-out W2964)
                                                    (shen/let W2966
                                                              (shen/shen.in->
                                                               W2964)
                                                              (shen/shen.comb
                                                               W2966
                                                               (list W2965))))))
                               (shen/if (shen/shen.parse-failure? W2963)
                                        (shen/shen.parse-failure) W2963))
                     W2956)))
(defun shen/shen.<digit> (V2967)
  (shen/let W2968
            (shen/if (shen/cons? V2967)
                     (shen/let W2969 (shen/head V2967)
                               (shen/let W2970 (shen/tail V2967)
                                         (shen/if (shen/shen.digit? W2969)
                                                  (shen/shen.comb W2970
                                                                  (shen/shen.byte->digit
                                                                   W2969))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2968) (shen/shen.parse-failure)
                     W2968)))
(defun shen/shen.byte->digit (V2971) (shen/- V2971 48))
(defun shen/shen.compute-integer (V2972)
  (shen/shen.compute-integer-h (shen/reverse V2972) 0))
(defun shen/shen.compute-integer-h (V2975 V2976)
  (shen/cond ((shen/internal/predicate->shen (null V2975)) 0)
             ((shen/cons? V2975)
              (shen/+ (shen/* (shen/shen.expt 10 V2976) (shen/hd V2975))
                      (shen/shen.compute-integer-h (nthcdr 1 V2975) (1+ V2976))))
             (shen/true (shen/shen.f-error 'shen.compute-integer-h))))
(defun shen/shen.expt (V2979 V2980)
  (shen/cond ((shen/= 0 V2980) 1)
             ((shen/> V2980 0)
              (shen/* V2979 (shen/shen.expt V2979 (shen/- V2980 1))))
             (shen/true (shen// (shen/shen.expt V2979 (1+ V2980)) V2979))))
(defun shen/shen.<float> (V2981)
  (shen/let W2982
            (shen/let W2983 (shen/shen.<integer> V2981)
                      (shen/if (shen/shen.parse-failure? W2983)
                               (shen/shen.parse-failure)
                               (shen/let W2984 (shen/shen.<-out W2983)
                                         (shen/let W2985 (shen/shen.in-> W2983)
                                                   (shen/let W2986
                                                             (shen/shen.<stop>
                                                              W2985)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W2986)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W2987
                                                                        (shen/shen.in->
                                                                         W2986)
                                                                        (shen/let
                                                                         W2988
                                                                         (shen/shen.<fraction>
                                                                          W2987)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W2988)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W2989
                                                                           (shen/shen.<-out
                                                                            W2988)
                                                                           (shen/let
                                                                            W2990
                                                                            (shen/shen.in->
                                                                             W2988)
                                                                            (shen/shen.comb
                                                                             W2990
                                                                             (shen/+
                                                                              W2984
                                                                              W2989)))))))))))))
            (shen/if (shen/shen.parse-failure? W2982)
                     (shen/let W2991
                               (shen/let W2992 (shen/shen.<stop> V2981)
                                         (shen/if
                                          (shen/shen.parse-failure? W2992)
                                          (shen/shen.parse-failure)
                                          (shen/let W2993 (shen/shen.in-> W2992)
                                                    (shen/let W2994
                                                              (shen/shen.<fraction>
                                                               W2993)
                                                              (shen/if
                                                               (shen/shen.parse-failure?
                                                                W2994)
                                                               (shen/shen.parse-failure)
                                                               (shen/let W2995
                                                                         (shen/shen.<-out
                                                                          W2994)
                                                                         (shen/let
                                                                          W2996
                                                                          (shen/shen.in->
                                                                           W2994)
                                                                          (shen/shen.comb
                                                                           W2996
                                                                           W2995))))))))
                               (shen/if (shen/shen.parse-failure? W2991)
                                        (shen/shen.parse-failure) W2991))
                     W2982)))
(defun shen/shen.<stop> (V2997)
  (shen/let W2998
            (shen/if (shen/shen.hds=? V2997 46)
                     (shen/let W2999 (shen/tail V2997)
                               (shen/shen.comb W2999 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W2998) (shen/shen.parse-failure)
                     W2998)))
(defun shen/shen.<fraction> (V3000)
  (shen/let W3001
            (shen/let W3002 (shen/shen.<digits> V3000)
                      (shen/if (shen/shen.parse-failure? W3002)
                               (shen/shen.parse-failure)
                               (shen/let W3003 (shen/shen.<-out W3002)
                                         (shen/let W3004 (shen/shen.in-> W3002)
                                                   (shen/shen.comb W3004
                                                                   (shen/shen.compute-fraction
                                                                    W3003))))))
            (shen/if (shen/shen.parse-failure? W3001) (shen/shen.parse-failure)
                     W3001)))
(defun shen/shen.compute-fraction (V3005)
  (shen/shen.compute-fraction-h V3005 -1))
(defun shen/shen.compute-fraction-h (V3008 V3009)
  (shen/cond ((shen/internal/predicate->shen (null V3008)) 0)
             ((shen/cons? V3008)
              (shen/+ (shen/* (shen/shen.expt 10 V3009) (shen/hd V3008))
                      (shen/shen.compute-fraction-h (nthcdr 1 V3008)
                                                    (shen/- V3009 1))))
             (shen/true (shen/shen.f-error 'shen.compute-fraction-h))))
(defun shen/shen.<e-number> (V3010)
  (shen/let W3011
            (shen/let W3012 (shen/shen.<float> V3010)
                      (shen/if (shen/shen.parse-failure? W3012)
                               (shen/shen.parse-failure)
                               (shen/let W3013 (shen/shen.<-out W3012)
                                         (shen/let W3014 (shen/shen.in-> W3012)
                                                   (shen/let W3015
                                                             (shen/shen.<lowE>
                                                              W3014)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3015)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3016
                                                                        (shen/shen.in->
                                                                         W3015)
                                                                        (shen/let
                                                                         W3017
                                                                         (shen/shen.<log10>
                                                                          W3016)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W3017)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W3018
                                                                           (shen/shen.<-out
                                                                            W3017)
                                                                           (shen/let
                                                                            W3019
                                                                            (shen/shen.in->
                                                                             W3017)
                                                                            (shen/shen.comb
                                                                             W3019
                                                                             (shen/shen.compute-E
                                                                              W3013
                                                                              W3018)))))))))))))
            (shen/if (shen/shen.parse-failure? W3011)
                     (shen/let W3020
                               (shen/let W3021 (shen/shen.<integer> V3010)
                                         (shen/if
                                          (shen/shen.parse-failure? W3021)
                                          (shen/shen.parse-failure)
                                          (shen/let W3022
                                                    (shen/shen.<-out W3021)
                                                    (shen/let W3023
                                                              (shen/shen.in->
                                                               W3021)
                                                              (shen/let W3024
                                                                        (shen/shen.<lowE>
                                                                         W3023)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W3024)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W3025
                                                                          (shen/shen.in->
                                                                           W3024)
                                                                          (shen/let
                                                                           W3026
                                                                           (shen/shen.<log10>
                                                                            W3025)
                                                                           (shen/if
                                                                            (shen/shen.parse-failure?
                                                                             W3026)
                                                                            (shen/shen.parse-failure)
                                                                            (shen/let
                                                                             W3027
                                                                             (shen/shen.<-out
                                                                              W3026)
                                                                             (shen/let
                                                                              W3028
                                                                              (shen/shen.in->
                                                                               W3026)
                                                                              (shen/shen.comb
                                                                               W3028
                                                                               (shen/shen.compute-E
                                                                                W3022
                                                                                W3027)))))))))))))
                               (shen/if (shen/shen.parse-failure? W3020)
                                        (shen/shen.parse-failure) W3020))
                     W3011)))
(defun shen/shen.<log10> (V3029)
  (shen/let W3030
            (shen/let W3031 (shen/shen.<plus> V3029)
                      (shen/if (shen/shen.parse-failure? W3031)
                               (shen/shen.parse-failure)
                               (shen/let W3032 (shen/shen.in-> W3031)
                                         (shen/let W3033
                                                   (shen/shen.<log10> W3032)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W3033)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W3034
                                                              (shen/shen.<-out
                                                               W3033)
                                                              (shen/let W3035
                                                                        (shen/shen.in->
                                                                         W3033)
                                                                        (shen/shen.comb
                                                                         W3035
                                                                         W3034))))))))
            (shen/if (shen/shen.parse-failure? W3030)
                     (shen/let W3036
                               (shen/let W3037 (shen/shen.<minus> V3029)
                                         (shen/if
                                          (shen/shen.parse-failure? W3037)
                                          (shen/shen.parse-failure)
                                          (shen/let W3038 (shen/shen.in-> W3037)
                                                    (shen/let W3039
                                                              (shen/shen.<log10>
                                                               W3038)
                                                              (shen/if
                                                               (shen/shen.parse-failure?
                                                                W3039)
                                                               (shen/shen.parse-failure)
                                                               (shen/let W3040
                                                                         (shen/shen.<-out
                                                                          W3039)
                                                                         (shen/let
                                                                          W3041
                                                                          (shen/shen.in->
                                                                           W3039)
                                                                          (shen/shen.comb
                                                                           W3041
                                                                           (shen/-
                                                                            0
                                                                            W3040)))))))))
                               (shen/if (shen/shen.parse-failure? W3036)
                                        (shen/let W3042
                                                  (shen/let W3043
                                                            (shen/shen.<integer>
                                                             V3029)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W3043)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W3044
                                                                       (shen/shen.<-out
                                                                        W3043)
                                                                       (shen/let
                                                                        W3045
                                                                        (shen/shen.in->
                                                                         W3043)
                                                                        (shen/shen.comb
                                                                         W3045
                                                                         W3044)))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W3042)
                                                   (shen/shen.parse-failure)
                                                   W3042))
                                        W3036))
                     W3030)))
(defun shen/shen.<lowE> (V3046)
  (shen/let W3047
            (shen/if (shen/shen.hds=? V3046 101)
                     (shen/let W3048 (shen/tail V3046)
                               (shen/shen.comb W3048 'shen.skip))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3047) (shen/shen.parse-failure)
                     W3047)))
(defun shen/shen.compute-E (V3049 V3050)
  (shen/* V3049 (shen/shen.expt 10 V3050)))
(defun shen/shen.<whitespaces> (V3051)
  (shen/let W3052
            (shen/let W3053 (shen/shen.<whitespace> V3051)
                      (shen/if (shen/shen.parse-failure? W3053)
                               (shen/shen.parse-failure)
                               (shen/let W3054 (shen/shen.in-> W3053)
                                         (shen/let W3055
                                                   (shen/shen.<whitespaces>
                                                    W3054)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W3055)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W3056
                                                              (shen/shen.in->
                                                               W3055)
                                                              (shen/shen.comb
                                                               W3056 'shen.skip)))))))
            (shen/if (shen/shen.parse-failure? W3052)
                     (shen/let W3057
                               (shen/let W3058 (shen/shen.<whitespace> V3051)
                                         (shen/if
                                          (shen/shen.parse-failure? W3058)
                                          (shen/shen.parse-failure)
                                          (shen/let W3059 (shen/shen.in-> W3058)
                                                    (shen/shen.comb W3059
                                                                    'shen.skip))))
                               (shen/if (shen/shen.parse-failure? W3057)
                                        (shen/shen.parse-failure) W3057))
                     W3052)))
(defun shen/shen.<whitespace> (V3060)
  (shen/let W3061
            (shen/if (shen/cons? V3060)
                     (shen/let W3062 (shen/head V3060)
                               (shen/let W3063 (shen/tail V3060)
                                         (shen/if (shen/shen.whitespace? W3062)
                                                  (shen/shen.comb W3063
                                                                  'shen.skip)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3061) (shen/shen.parse-failure)
                     W3061)))
(defun shen/shen.whitespace? (V3066)
  (shen/cond ((shen/= 32 V3066) 'true) ((shen/= 13 V3066) 'true)
             ((shen/= 10 V3066) 'true) ((shen/= 9 V3066) 'true)
             (shen/true 'false)))
(defun shen/shen.unpackage&macroexpand (V3067)
  (cl-flet
      ((tail-trampoline (V3067)
         (shen/cond ((shen/internal/predicate->shen (null V3067)) nil)
                    ((shen/and (shen/cons? V3067)
                               (shen/shen.packaged? (shen/hd V3067)))
                     (vector
                      (list
                       (shen/append (shen/shen.unpackage (shen/hd V3067))
                                    (nthcdr 1 V3067)))))
                    ((shen/cons? V3067)
                     (shen/let W3068 (shen/macroexpand (shen/hd V3067))
                               (shen/if (shen/shen.packaged? W3068)
                                        (vector
                                         (list
                                          (append (list W3068) (nthcdr 1 V3067))))
                                        (append (list W3068)
                                                (shen/shen.unpackage&macroexpand
                                                 (nthcdr 1 V3067))))))
                    (shen/true (shen/shen.f-error 'shen.unpackage&macroexpand)))))
    (let ((result (funcall #'tail-trampoline V3067)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.packaged? (V3071)
  (shen/cond
   ((shen/and (shen/cons? V3071)
              (shen/and (shen/= 'package (shen/hd V3071))
                        (shen/and (shen/cons? (nthcdr 1 V3071))
                                  (shen/cons? (nthcdr 2 V3071)))))
    'true)
   (shen/true 'false)))
(defun shen/shen.unpackage (V3074)
  (shen/cond
   ((shen/and (shen/cons? V3074)
              (shen/and (shen/= 'package (shen/hd V3074))
                        (shen/and (shen/cons? (nthcdr 1 V3074))
                                  (shen/and
                                   (shen/= 'null (shen/hd (nthcdr 1 V3074)))
                                   (shen/cons? (nthcdr 2 V3074))))))
    (nthcdr 3 V3074))
   ((shen/and (shen/cons? V3074)
              (shen/and (shen/= 'package (shen/hd V3074))
                        (shen/and (shen/cons? (nthcdr 1 V3074))
                                  (shen/cons? (nthcdr 2 V3074)))))
    (shen/let W3075 (shen/eval (shen/hd (nthcdr 2 V3074)))
              (shen/let W3076
                        (shen/shen.package-symbols
                         (shen/str (shen/hd (nthcdr 1 V3074))) W3075
                         (nthcdr 3 V3074))
                        (shen/let W3077
                                  (shen/shen.record-external
                                   (shen/hd (nthcdr 1 V3074)) W3075)
                                  (shen/let W3078
                                            (shen/shen.record-internal
                                             (shen/hd (nthcdr 1 V3074)) W3075
                                             (nthcdr 3 V3074))
                                            W3076)))))
   (shen/true (shen/shen.f-error 'shen.unpackage))))
(defun shen/shen.record-internal (V3079 V3080 V3081)
  (shen/put V3079 'shen.internal-symbols
            (shen/shen.internal-symbols (shen/str V3079) V3080 V3081)
            (shen/value '*property-vector*)))
(defun shen/shen.internal-symbols (V3088 V3089 V3090)
  (shen/cond
   ((shen/cons? V3090)
    (shen/union (shen/shen.internal-symbols V3088 V3089 (shen/hd V3090))
                (shen/shen.internal-symbols V3088 V3089 (nthcdr 1 V3090))))
   ((shen/shen.internal? V3090 V3088 V3089)
    (list (shen/shen.intern-in-package V3088 V3090)))
   (shen/true nil)))
(defun shen/shen.record-external (V3091 V3092)
  (shen/let W3093
            (shen/trap-error
             (shen/get V3091 'shen.external-symbols
                       (shen/value '*property-vector*))
             (shen/lambda Z3094 nil))
            (shen/put V3091 'shen.external-symbols (shen/union V3092 W3093)
                      (shen/value '*property-vector*))))
(defun shen/shen.package-symbols (V3099 V3100 V3101)
  (shen/cond
   ((shen/cons? V3101)
    (shen/map (shen/lambda Z3102 (shen/shen.package-symbols V3099 V3100 Z3102))
              V3101))
   ((shen/shen.internal? V3101 V3099 V3100)
    (shen/shen.intern-in-package V3099 V3101))
   (shen/true V3101)))
(defun shen/shen.intern-in-package (V3103 V3104)
  (shen/intern (concat (concat V3103 ".") (shen/str V3104))))
(defun shen/shen.internal? (V3105 V3106 V3107)
  (shen/and (shen/not (shen/element? V3105 V3107))
            (shen/and (shen/not (shen/shen.sng? V3105))
                      (shen/and (shen/not (shen/shen.dbl? V3105))
                                (shen/and (shen/symbol? V3105)
                                          (shen/and
                                           (shen/not (shen/shen.sysfunc? V3105))
                                           (shen/and
                                            (shen/not (shen/variable? V3105))
                                            (shen/and
                                             (shen/not
                                              (shen/shen.internal-to-shen?
                                               (shen/str V3105)))
                                             (shen/not
                                              (shen/shen.internal-to-P? V3106
                                                                        (shen/str
                                                                         V3105)))))))))))
(defun shen/shen.internal-to-shen? (V3112)
  (shen/cond
   ((shen/and (shen/shen.+string? V3112)
              (shen/and (shen/= "s" (shen/hdstr V3112))
                        (shen/and (shen/shen.+string? (shen/tlstr V3112))
                                  (shen/and
                                   (shen/= "h" (shen/hdstr (shen/tlstr V3112)))
                                   (shen/and
                                    (shen/shen.+string?
                                     (shen/tlstr (shen/tlstr V3112)))
                                    (shen/and
                                     (shen/= "e"
                                             (shen/hdstr
                                              (shen/tlstr (shen/tlstr V3112))))
                                     (shen/and
                                      (shen/shen.+string?
                                       (shen/tlstr
                                        (shen/tlstr (shen/tlstr V3112))))
                                      (shen/and
                                       (shen/= "n"
                                               (shen/hdstr
                                                (shen/tlstr
                                                 (shen/tlstr (shen/tlstr V3112)))))
                                       (shen/and
                                        (shen/shen.+string?
                                         (shen/tlstr
                                          (shen/tlstr
                                           (shen/tlstr (shen/tlstr V3112)))))
                                        (shen/= "."
                                                (shen/hdstr
                                                 (shen/tlstr
                                                  (shen/tlstr
                                                   (shen/tlstr
                                                    (shen/tlstr V3112)))))))))))))))
    'true)
   (shen/true 'false)))
(defun shen/shen.sysfunc? (V3113)
  (shen/element? V3113
                 (shen/get 'shen 'shen.external-symbols
                           (shen/value '*property-vector*))))
(defun shen/shen.internal-to-P? (V3121 V3122)
  (cl-flet
      ((tail-trampoline (V3121 V3122)
         (shen/cond
          ((shen/and (shen/= "" V3121)
                     (shen/and (shen/shen.+string? V3122)
                               (shen/= "." (shen/hdstr V3122))))
           'true)
          ((shen/and (shen/shen.+string? V3121)
                     (shen/and (shen/shen.+string? V3122)
                               (shen/= (shen/hdstr V3121) (shen/hdstr V3122))))
           (vector (list (shen/tlstr V3121) (shen/tlstr V3122))))
          (shen/true 'false))))
    (let ((result (funcall #'tail-trampoline V3121 V3122)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.process-applications (V3125 V3126)
  (shen/cond ((shen/element? V3125 V3126) V3125)
             ((shen/and (shen/cons? V3125) (shen/= 'cond (shen/hd V3125)))
              (append (list 'cond)
                      (shen/shen.process-cond-clauses (nthcdr 1 V3125) V3126)))
             ((shen/and (shen/cons? V3125)
                        (shen/shen.non-application? (shen/hd V3125)))
              (shen/shen.special-case (shen/hd V3125) V3125 V3126))
             ((shen/cons? V3125)
              (shen/shen.process-application
               (shen/map
                (shen/lambda Z3127 (shen/shen.process-applications Z3127 V3126))
                V3125)
               V3126))
             (shen/true V3125)))
(defun shen/shen.non-application? (V3130)
  (shen/cond ((shen/= 'define V3130) 'true) ((shen/= 'defun V3130) 'true)
             ((shen/= 'synonyms V3130) 'true) ((shen/shen.special? V3130) 'true)
             ((shen/shen.extraspecial? V3130) 'true) (shen/true 'false)))
(defun shen/shen.special-case (V3135 V3136 V3137)
  (shen/cond
   ((shen/and (shen/= 'lambda V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'lambda (shen/hd V3136))
                                  (shen/and (shen/cons? (nthcdr 1 V3136))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V3136))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V3136))))))))
    (list 'lambda (shen/hd (nthcdr 1 V3136))
          (shen/shen.process-applications (shen/hd (nthcdr 2 V3136)) V3137)))
   ((shen/and (shen/= 'let V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'let (shen/hd V3136))
                                  (shen/and (shen/cons? (nthcdr 1 V3136))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V3136))
                                             (shen/and
                                              (shen/cons? (nthcdr 3 V3136))
                                              (shen/internal/predicate->shen
                                               (null (nthcdr 4 V3136)))))))))
    (list 'let (shen/hd (nthcdr 1 V3136))
          (shen/shen.process-applications (shen/hd (nthcdr 2 V3136)) V3137)
          (shen/shen.process-applications (shen/hd (nthcdr 3 V3136)) V3137)))
   ((shen/and (shen/= 'defun V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'defun (shen/hd V3136))
                                  (shen/and (shen/cons? (nthcdr 1 V3136))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V3136))
                                             (shen/and
                                              (shen/cons? (nthcdr 3 V3136))
                                              (shen/internal/predicate->shen
                                               (null (nthcdr 4 V3136)))))))))
    V3136)
   ((shen/and (shen/= 'define V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'define (shen/hd V3136))
                                  (shen/and (shen/cons? (nthcdr 1 V3136))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V3136))
                                             (shen/= '{
                                                     (shen/hd (nthcdr 2 V3136))))))))
    (append (list 'define (shen/hd (nthcdr 1 V3136)) '{)
            (shen/shen.process-after-type (shen/hd (nthcdr 1 V3136))
                                          (nthcdr 3 V3136) V3137)))
   ((shen/and (shen/= 'define V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'define (shen/hd V3136))
                                  (shen/cons? (nthcdr 1 V3136)))))
    (append (list 'define (shen/hd (nthcdr 1 V3136)))
            (shen/map
             (shen/lambda Z3138 (shen/shen.process-applications Z3138 V3137))
             (nthcdr 2 V3136))))
   ((shen/= 'synonyms V3135) (append (list 'synonyms) V3136))
   ((shen/and (shen/= 'type V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'type (shen/hd V3136))
                                  (shen/and (shen/cons? (nthcdr 1 V3136))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V3136))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V3136))))))))
    (append
     (list 'type
           (shen/shen.process-applications (shen/hd (nthcdr 1 V3136)) V3137))
     (nthcdr 2 V3136)))
   ((shen/and (shen/= 'input+ V3135)
              (shen/and (shen/cons? V3136)
                        (shen/and (shen/= 'input+ (shen/hd V3136))
                                  (shen/and (shen/cons? (nthcdr 1 V3136))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V3136))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V3136))))))))
    (list 'input+ (shen/hd (nthcdr 1 V3136))
          (shen/shen.process-applications (shen/hd (nthcdr 2 V3136)) V3137)))
   ((shen/and (shen/cons? V3136) (shen/shen.special? (shen/hd V3136)))
    (append (list (shen/hd V3136))
            (shen/map
             (shen/lambda Z3139 (shen/shen.process-applications Z3139 V3137))
             (nthcdr 1 V3136))))
   ((shen/and (shen/cons? V3136) (shen/shen.extraspecial? (shen/hd V3136)))
    V3136)
   (shen/true (shen/shen.f-error 'shen.special-case))))
(defun shen/shen.process-cond-clauses (V3142 V3143)
  (shen/cond ((shen/internal/predicate->shen (null V3142)) nil)
             ((shen/and (shen/cons? V3142)
                        (shen/and (shen/cons? (shen/hd V3142))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V3142)))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V3142)))))))
              (append
               (list
                (list
                 (shen/shen.process-applications (shen/hd (shen/hd V3142)) V3143)
                 (shen/shen.process-applications
                  (shen/hd (nthcdr 1 (shen/hd V3142))) V3143)))
               (shen/shen.process-cond-clauses (nthcdr 1 V3142) V3143)))
             (shen/true (shen/shen.f-error 'shen.process-cond-clauses))))
(defun shen/shen.process-after-type (V3146 V3147 V3148)
  (shen/cond
   ((shen/and (shen/cons? V3147) (shen/= '} (shen/hd V3147)))
    (append (list '})
            (shen/map
             (shen/lambda Z3149 (shen/shen.process-applications Z3149 V3148))
             (nthcdr 1 V3147))))
   ((shen/cons? V3147)
    (append (list (shen/hd V3147))
            (shen/shen.process-after-type V3146 (nthcdr 1 V3147) V3148)))
   (shen/true
    (shen/simple-error
     (shen/cn "missing } in " (shen/shen.app V3146 "\n" 'shen.a))))))
(defun shen/shen.process-application (V3150 V3151)
  (shen/cond
   ((shen/cons? V3150)
    (shen/let W3152 (shen/arity (shen/hd V3150))
              (shen/let W3153 (shen/length (nthcdr 1 V3150))
                        (shen/if (shen/element? V3150 V3151) V3150
                                 (shen/if (shen/shen.shen-call? (shen/hd V3150))
                                          V3150
                                          (shen/if (shen/shen.foreign? V3150)
                                                   (shen/shen.unpack-foreign
                                                    V3150)
                                                   (shen/if
                                                    (shen/shen.fn-call? V3150)
                                                    (shen/shen.fn-call V3150)
                                                    (shen/if
                                                     (shen/shen.zero-place?
                                                      V3150)
                                                     V3150
                                                     (shen/if
                                                      (shen/shen.undefined-f?
                                                       (shen/hd V3150) W3152)
                                                      (shen/shen.simple-curry
                                                       (append
                                                        (list
                                                         (list 'fn
                                                               (shen/hd V3150)))
                                                        (nthcdr 1 V3150)))
                                                      (shen/if
                                                       (shen/variable?
                                                        (shen/hd V3150))
                                                       (shen/shen.simple-curry
                                                        V3150)
                                                       (shen/if
                                                        (shen/shen.application?
                                                         (shen/hd V3150))
                                                        (shen/shen.simple-curry
                                                         V3150)
                                                        (shen/if
                                                         (shen/shen.partial-application*?
                                                          (shen/hd V3150) W3152
                                                          W3153)
                                                         (shen/shen.lambda-function
                                                          V3150
                                                          (shen/- W3152 W3153))
                                                         (shen/if
                                                          (shen/shen.overapplication?
                                                           (shen/hd V3150) W3152
                                                           W3153)
                                                          (shen/shen.simple-curry
                                                           (append
                                                            (list
                                                             (list 'fn
                                                                   (shen/hd
                                                                    V3150)))
                                                            (nthcdr 1 V3150)))
                                                          V3150)))))))))))))
   (shen/true (shen/shen.f-error 'shen.process-application))))
(defun shen/shen.unpack-foreign (V3154)
  (shen/cond
   ((shen/and (shen/cons? V3154)
              (shen/and (shen/cons? (shen/hd V3154))
                        (shen/and (shen/= 'foreign (shen/hd (shen/hd V3154)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V3154)))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V3154))))))))
    (append (list (shen/hd (nthcdr 1 (shen/hd V3154)))) (nthcdr 1 V3154)))
   (shen/true (shen/shen.f-error 'shen.unpack-foreign))))
(defun shen/shen.foreign? (V3157)
  (shen/cond
   ((shen/and (shen/cons? V3157)
              (shen/and (shen/cons? (shen/hd V3157))
                        (shen/and (shen/= 'foreign (shen/hd (shen/hd V3157)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V3157)))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V3157))))))))
    'true)
   (shen/true 'false)))
(defun shen/shen.zero-place? (V3160)
  (shen/cond
   ((shen/and (shen/cons? V3160)
              (shen/internal/predicate->shen (null (nthcdr 1 V3160))))
    'true)
   (shen/true 'false)))
(defun shen/shen.shen-call? (V3161)
  (shen/and (shen/symbol? V3161) (shen/shen.internal-to-shen? (shen/str V3161))))
(defun shen/shen.internal-to-shen? (V3166)
  (shen/cond
   ((shen/and (shen/shen.+string? V3166)
              (shen/and (shen/= "s" (shen/hdstr V3166))
                        (shen/and (shen/shen.+string? (shen/tlstr V3166))
                                  (shen/and
                                   (shen/= "h" (shen/hdstr (shen/tlstr V3166)))
                                   (shen/and
                                    (shen/shen.+string?
                                     (shen/tlstr (shen/tlstr V3166)))
                                    (shen/and
                                     (shen/= "e"
                                             (shen/hdstr
                                              (shen/tlstr (shen/tlstr V3166))))
                                     (shen/and
                                      (shen/shen.+string?
                                       (shen/tlstr
                                        (shen/tlstr (shen/tlstr V3166))))
                                      (shen/and
                                       (shen/= "n"
                                               (shen/hdstr
                                                (shen/tlstr
                                                 (shen/tlstr (shen/tlstr V3166)))))
                                       (shen/and
                                        (shen/shen.+string?
                                         (shen/tlstr
                                          (shen/tlstr
                                           (shen/tlstr (shen/tlstr V3166)))))
                                        (shen/= "."
                                                (shen/hdstr
                                                 (shen/tlstr
                                                  (shen/tlstr
                                                   (shen/tlstr
                                                    (shen/tlstr V3166)))))))))))))))
    'true)
   (shen/true 'false)))
(defun shen/shen.application? (V3171)
  (shen/cond
   ((shen/and (shen/cons? V3171)
              (shen/and (shen/= 'protect (shen/hd V3171))
                        (shen/and (shen/cons? (nthcdr 1 V3171))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3171))))))
    'false)
   ((shen/and (shen/cons? V3171)
              (shen/and (shen/= 'foreign (shen/hd V3171))
                        (shen/and (shen/cons? (nthcdr 1 V3171))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3171))))))
    'false)
   (shen/true (shen/cons? V3171))))
(defun shen/shen.undefined-f? (V3176 V3177)
  (shen/cond
   ((shen/= -1 V3177)
    (shen/and (shen/shen.lowercase-symbol? V3176)
              (shen/not (shen/element? V3176 (shen/external 'shen)))))
   (shen/true 'false)))
(defun shen/shen.lowercase-symbol? (V3178)
  (shen/and (shen/symbol? V3178) (shen/not (shen/variable? V3178))))
(defun shen/shen.simple-curry (V3179)
  (cl-flet
      ((tail-trampoline (V3179)
         (shen/cond
          ((shen/and (shen/cons? V3179)
                     (shen/and (shen/cons? (nthcdr 1 V3179))
                               (shen/internal/predicate->shen
                                (null (nthcdr 2 V3179)))))
           V3179)
          ((shen/and (shen/cons? V3179)
                     (shen/and (shen/cons? (nthcdr 1 V3179))
                               (shen/cons? (nthcdr 2 V3179))))
           (vector
            (list
             (append (list (list (shen/hd V3179) (shen/hd (nthcdr 1 V3179))))
                     (nthcdr 2 V3179)))))
          (shen/true V3179))))
    (let ((result (funcall #'tail-trampoline V3179)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/function (S)
  (shen/shen.lookup-func (shen/internal/unprefix-symbol S)))
(defun shen/fn (V3181)
  (shen/trap-error
   (shen/get V3181 'shen.lambda-form (shen/value '*property-vector*))
   (shen/lambda Z3182
                (shen/simple-error
                 (shen/cn "fn: " (shen/shen.app V3181 " is undefined\n" 'shen.a))))))
(defun shen/shen.fn-call? (V3185)
  (shen/cond
   ((shen/and (shen/cons? V3185)
              (shen/and (shen/= 'fn (shen/hd V3185))
                        (shen/and (shen/cons? (nthcdr 1 V3185))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3185))))))
    'true)
   ((shen/and (shen/cons? V3185)
              (shen/and (shen/= 'function (shen/hd V3185))
                        (shen/and (shen/cons? (nthcdr 1 V3185))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3185))))))
    'true)
   (shen/true 'false)))
(defun shen/shen.fn-call (V3186)
  (cl-flet
      ((tail-trampoline (V3186)
         (shen/cond
          ((shen/and (shen/cons? V3186)
                     (shen/and (shen/= 'function (shen/hd V3186))
                               (shen/and (shen/cons? (nthcdr 1 V3186))
                                         (shen/internal/predicate->shen
                                          (null (nthcdr 2 V3186))))))
           (vector (list (append (list 'fn) (nthcdr 1 V3186)))))
          ((shen/and (shen/cons? V3186)
                     (shen/and (shen/= 'fn (shen/hd V3186))
                               (shen/and (shen/cons? (nthcdr 1 V3186))
                                         (shen/internal/predicate->shen
                                          (null (nthcdr 2 V3186))))))
           (shen/let W3187 (shen/arity (shen/hd (nthcdr 1 V3186)))
                     (shen/if (shen/= W3187 -1) V3186
                              (shen/if (shen/= W3187 0)
                                       (shen/simple-error
                                        "fn cannot be applied to a zero place function\n")
                                       (shen/shen.lambda-function
                                        (nthcdr 1 V3186) W3187)))))
          (shen/true (shen/shen.f-error 'shen.fn-call)))))
    (let ((result (funcall #'tail-trampoline V3186)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.partial-application*? (V3188 V3189 V3190)
  (shen/let W3191 (shen/> V3189 V3190)
            (shen/let W3192
                      (shen/if
                       (shen/and W3191
                                 (shen/and (shen/shen.loading?)
                                           (shen/not
                                            (shen/element? V3188 (list '+ '-)))))
                       (shen/pr
                        (shen/cn "partial application of "
                                 (shen/shen.app V3188 "\n" 'shen.a))
                        (shen/stoutput))
                       'shen.skip)
                      W3191)))
(defun shen/shen.loading? nil (shen/value 'shen.*loading?*))
(defun shen/shen.overapplication? (V3197 V3198 V3199)
  (shen/cond ((shen/= -1 V3198) 'false)
             (shen/true
              (shen/let W3200 (shen/< V3198 V3199)
                        (shen/let W3201
                                  (shen/if (shen/and W3200 (shen/shen.loading?))
                                           (shen/pr
                                            (shen/shen.app V3197
                                                           (shen/cn
                                                            " might not like "
                                                            (shen/shen.app V3199
                                                                           (shen/cn
                                                                            " argument"
                                                                            (shen/shen.app
                                                                             (shen/if
                                                                              (shen/=
                                                                               V3199
                                                                               1)
                                                                              ""
                                                                              "s")
                                                                             "\n"
                                                                             'shen.a))
                                                                           'shen.a))
                                                           'shen.a)
                                            (shen/stoutput))
                                           'shen.skip)
                                  W3200)))))
(defun shen/prolog-memory (V861) (shen/set 'shen.*prolog-memory* V861))
(defun shen/arity (V862)
  (shen/trap-error (shen/get V862 'arity (shen/value '*property-vector*))
                   (shen/lambda Z863 -1)))
(defun shen/shen.initialise-arity-table (V866)
  (cl-flet
      ((tail-trampoline (V866)
         (shen/cond ((shen/internal/predicate->shen (null V866)) nil)
                    ((shen/and (shen/cons? V866) (shen/cons? (nthcdr 1 V866)))
                     (shen/let W867
                               (shen/put (shen/hd V866) 'arity
                                         (shen/hd (nthcdr 1 V866))
                                         (shen/value '*property-vector*))
                               (vector (list (nthcdr 2 V866)))))
                    (shen/true
                     (shen/simple-error
                      "implementation error in shen.initialise-arity-table")))))
    (let ((result (funcall #'tail-trampoline V866)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/systemf (V868)
  (shen/let W869
            (shen/get 'shen 'shen.external-symbols
                      (shen/value '*property-vector*))
            (shen/let W870
                      (shen/put 'shen 'shen.external-symbols
                                (shen/adjoin V868 W869)
                                (shen/value '*property-vector*))
                      V868)))
(defun shen/adjoin (V871 V872)
  (shen/if (shen/element? V871 V872) V872 (append (list V871) V872)))
(defun shen/shen.lambda-entry (V873)
  (shen/let W874 (shen/arity V873)
            (shen/if (shen/or (shen/= W874 -1) (shen/= W874 0)) nil
                     (append (list V873)
                             (shen/eval-kl
                              (shen/shen.lambda-function (list V873) W874))))))
(defun shen/shen.set-lambda-form-entry (V875)
  (shen/cond
   ((shen/cons? V875)
    (shen/put (shen/hd V875) 'shen.lambda-form (nthcdr 1 V875)
              (shen/value '*property-vector*)))
   (shen/true (shen/shen.f-error 'shen.set-lambda-form-entry))))
(defun shen/shen.build-lambda-table (V876)
  (shen/let W877
            (shen/map (shen/lambda Z878 (shen/shen.lambda-entry Z878)) V876)
            (shen/shen.for-each
             (shen/lambda Z879 (shen/shen.set-lambda-form-entry Z879))
             (append
              (list
               (append (list 'shen.tuple)
                       (shen/lambda Z880 (shen/shen.tuple Z880)))
               (append (list 'shen.pvar)
                       (shen/lambda Z881 (shen/shen.pvar Z881)))
               (append (list 'shen.dictionary)
                       (shen/lambda Z882 (shen/shen.dictionary Z882)))
               (append (list 'shen.print-prolog-vector)
                       (shen/lambda Z883 (shen/shen.print-prolog-vector Z883)))
               (append (list 'shen.print-freshterm)
                       (shen/lambda Z884 (shen/shen.print-freshterm Z884)))
               (append (list 'shen.printF)
                       (shen/lambda Z885 (shen/shen.printF Z885))))
              W877))))
(defun shen/shen.repl nil (shen/do (shen/shen.credits) (shen/shen.loop)))
(defun shen/shen.loop nil
  (cl-flet
      ((tail-trampoline nil
         (shen/do (shen/shen.initialise_environment)
                  (shen/do (shen/shen.prompt)
                           (shen/do
                            (shen/trap-error (shen/shen.read-evaluate-print)
                                             (shen/lambda Z5695
                                                          (shen/shen.toplevel-display-exception
                                                           Z5695)))
                            (vector (list)))))))
    (let ((result (funcall #'tail-trampoline)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.toplevel-display-exception (V5696)
  (shen/do (shen/pr (shen/error-to-string V5696) (shen/stoutput)) (shen/nl 0)))
(defun shen/shen.credits nil
  (shen/do
   (shen/pr
    "\nShen, www.shenlanguage.org, copyright (C) 2010-2023, Mark Tarver\n"
    (shen/stoutput))
   (shen/do
    (shen/pr
     (shen/cn "version: S"
              (shen/shen.app (shen/value '*version*)
                             (shen/cn ", language: "
                                      (shen/shen.app (shen/value '*language*)
                                                     (shen/cn ", platform: "
                                                              (shen/shen.app
                                                               (shen/value
                                                                '*implementation*)
                                                               (shen/cn " "
                                                                        (shen/shen.app
                                                                         (shen/value
                                                                          '*release*)
                                                                         "\n"
                                                                         'shen.a))
                                                               'shen.a))
                                                     'shen.a))
                             'shen.a))
     (shen/stoutput))
    (shen/pr
     (shen/cn "port "
              (shen/shen.app (shen/value '*port*)
                             (shen/cn ", ported by "
                                      (shen/shen.app (shen/value '*porters*)
                                                     "\n\n" 'shen.a))
                             'shen.a))
     (shen/stoutput)))))
(defun shen/shen.initialise_environment nil
  (shen/do (shen/set 'shen.*call* 0) (shen/set 'shen.*infs* 0)))
(defun shen/shen.prompt nil
  (shen/if (shen/value 'shen.*tc*)
           (shen/pr
            (shen/cn "\n("
                     (shen/shen.app (shen/length (shen/value 'shen.*history*))
                                    "+) " 'shen.a))
            (shen/stoutput))
           (shen/pr
            (shen/cn "\n("
                     (shen/shen.app (shen/length (shen/value 'shen.*history*))
                                    "-) " 'shen.a))
            (shen/stoutput))))
(defun shen/shen.read-evaluate-print nil
  (shen/let W5697 (shen/value 'shen.*package*)
            (shen/let W5698
                      (shen/shen.package-user-input W5697
                                                    (shen/lineread
                                                     (shen/stinput)))
                      (shen/let W5699 (shen/shen.update-history)
                                (shen/shen.evaluate-lineread W5698 W5699
                                                             (shen/value
                                                              'shen.*tc*))))))
(defun shen/shen.package-user-input (V5700 V5701)
  (shen/cond ((shen/= 'null V5700) V5701)
             (shen/true
              (shen/let W5702 (shen/str V5700)
                        (shen/let W5703 (shen/external V5700)
                                  (shen/map
                                   (shen/lambda Z5704
                                                (shen/shen.pui-h W5702 W5703
                                                                 Z5704))
                                   V5701))))))
(defun shen/shen.pui-h (V5709 V5710 V5711)
  (shen/cond
   ((shen/and (shen/cons? V5711)
              (shen/and (shen/= 'fn (shen/hd V5711))
                        (shen/and (shen/cons? (nthcdr 1 V5711))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V5711))))))
    (shen/if (shen/shen.internal? (shen/hd (nthcdr 1 V5711)) V5709 V5710)
             (list 'fn
                   (shen/shen.intern-in-package V5709 (shen/hd (nthcdr 1 V5711))))
             V5711))
   ((shen/cons? V5711)
    (shen/if (shen/shen.internal? (shen/hd V5711) V5709 V5710)
             (append (list (shen/shen.intern-in-package V5709 (shen/hd V5711)))
                     (shen/map
                      (shen/lambda Z5712 (shen/shen.pui-h V5709 V5710 Z5712))
                      (nthcdr 1 V5711)))
             (shen/if (shen/cons? (shen/hd V5711))
                      (shen/map
                       (shen/lambda Z5713 (shen/shen.pui-h V5709 V5710 Z5713))
                       V5711)
                      (append (list (shen/hd V5711))
                              (shen/map
                               (shen/lambda Z5714
                                            (shen/shen.pui-h V5709 V5710 Z5714))
                               (nthcdr 1 V5711))))))
   (shen/true V5711)))
(defun shen/shen.update-history nil
  (shen/set 'shen.*history*
            (append (list (shen/shen.trim-it (shen/it)))
                    (shen/value 'shen.*history*))))
(defun shen/shen.trim-it (V5715)
  (cl-flet
      ((tail-trampoline (V5715)
         (shen/cond
          ((shen/and (shen/shen.+string? V5715)
                     (shen/shen.whitespace? (shen/string->n (shen/hdstr V5715))))
           (vector (list (shen/tlstr V5715))))
          (shen/true V5715))))
    (let ((result (funcall #'tail-trampoline V5715)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.evaluate-lineread (V5734 V5735 V5736)
  (cl-flet
      ((tail-trampoline (V5734 V5735 V5736)
         (shen/cond
          ((shen/and (shen/cons? V5734)
                     (shen/and
                      (shen/internal/predicate->shen (null (nthcdr 1 V5734)))
                      (shen/and (shen/cons? V5735)
                                (shen/and (shen/= "!!" (shen/hd V5735))
                                          (shen/cons? (nthcdr 1 V5735))))))
           (shen/let W5737 (shen/read-from-string (shen/hd (nthcdr 1 V5735)))
                     (shen/let W5738
                               (shen/set 'shen.*history*
                                         (append
                                          (list (shen/hd (nthcdr 1 V5735)))
                                          (nthcdr 1 V5735)))
                               (shen/let W5739
                                         (shen/pr
                                          (shen/shen.app
                                           (shen/hd (nthcdr 1 V5735)) "\n"
                                           'shen.a)
                                          (shen/stoutput))
                                         (vector (list W5737 W5738 V5736))))))
          ((shen/and (shen/cons? V5734)
                     (shen/and
                      (shen/internal/predicate->shen (null (nthcdr 1 V5734)))
                      (shen/and (shen/cons? V5735)
                                (shen/and (shen/shen.+string? (shen/hd V5735))
                                          (shen/= "%"
                                                  (shen/hdstr (shen/hd V5735)))))))
           (shen/let W5740
                     (shen/hd
                      (shen/read-from-string (shen/tlstr (shen/hd V5735))))
                     (shen/let W5741
                               (shen/shen.peek-history W5740
                                                       (shen/tlstr
                                                        (shen/hd V5735))
                                                       (nthcdr 1 V5735))
                               (shen/let W5742
                                         (shen/set 'shen.*history*
                                                   (nthcdr 1 V5735))
                                         (shen/abort)))))
          ((shen/and (shen/cons? V5734)
                     (shen/and
                      (shen/internal/predicate->shen (null (nthcdr 1 V5734)))
                      (shen/and (shen/cons? V5735)
                                (shen/and (shen/shen.+string? (shen/hd V5735))
                                          (shen/= "!"
                                                  (shen/hdstr (shen/hd V5735)))))))
           (shen/let W5743
                     (shen/hd
                      (shen/read-from-string (shen/tlstr (shen/hd V5735))))
                     (shen/let W5744
                               (shen/shen.use-history W5743
                                                      (shen/tlstr
                                                       (shen/hd V5735))
                                                      (nthcdr 1 V5735))
                               (shen/let W5745
                                         (shen/pr
                                          (shen/shen.app W5744 "\n" 'shen.a)
                                          (shen/stoutput))
                                         (shen/let W5746
                                                   (shen/read-from-string W5744)
                                                   (shen/let W5747
                                                             (shen/set
                                                              'shen.*history*
                                                              (append
                                                               (list W5744)
                                                               (nthcdr 1 V5735)))
                                                             (vector
                                                              (list W5746 W5747
                                                                    V5736))))))))
          ((shen/and (shen/cons? V5734)
                     (shen/and
                      (shen/internal/predicate->shen (null (nthcdr 1 V5734)))
                      (shen/and (shen/cons? V5735)
                                (shen/and (shen/shen.+string? (shen/hd V5735))
                                          (shen/= "%"
                                                  (shen/hdstr (shen/hd V5735)))))))
           (shen/let W5748
                     (shen/hd
                      (shen/read-from-string (shen/tlstr (shen/hd V5735))))
                     (shen/let W5749
                               (shen/shen.peek-history W5748
                                                       (shen/tlstr
                                                        (shen/hd V5735))
                                                       (nthcdr 1 V5735))
                               (shen/let W5750
                                         (shen/set 'shen.*history*
                                                   (nthcdr 1 V5735))
                                         (shen/abort)))))
          ((shen/= 'true V5736) (shen/shen.check-eval-and-print V5734))
          ((shen/= 'false V5736) (shen/shen.eval-and-print V5734))
          (shen/true
           (shen/simple-error "implementation error in shen.evaluate-lineread")))))
    (let ((result (funcall #'tail-trampoline V5734 V5735 V5736)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.use-history (V5751 V5752 V5753)
  (shen/if (shen/integer? V5751) (shen/nth (1+ V5751) (shen/reverse V5753))
           (shen/if (shen/symbol? V5751) (shen/shen.string-match V5752 V5753)
                    (shen/simple-error "! expects a number or a symbol\n"))))
(defun shen/shen.peek-history (V5754 V5755 V5756)
  (shen/if (shen/integer? V5754)
           (shen/pr
            (shen/cn "\n"
                     (shen/shen.app (shen/nth (1+ V5754) (shen/reverse V5756))
                                    "" 'shen.a))
            (shen/stoutput))
           (shen/if (shen/or (shen/= V5755 "") (shen/symbol? V5754))
                    (shen/shen.recursive-string-match 0 V5755
                                                      (shen/reverse V5756))
                    (shen/simple-error "% expects a number or a symbol\n"))))
(defun shen/shen.string-match (V5766 V5767)
  (cl-flet
      ((tail-trampoline (V5766 V5767)
         (shen/cond
          ((shen/internal/predicate->shen (null V5767))
           (shen/simple-error "\ninput not found"))
          ((shen/and (shen/cons? V5767)
                     (shen/shen.string-prefix? V5766 (shen/hd V5767)))
           (shen/hd V5767))
          ((shen/cons? V5767) (vector (list V5766 (nthcdr 1 V5767))))
          (shen/true
           (shen/simple-error "implementation error in shen.string-match")))))
    (let ((result (funcall #'tail-trampoline V5766 V5767)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.string-prefix? (V5775 V5776)
  (cl-flet
      ((tail-trampoline (V5775 V5776)
         (shen/cond ((shen/= "" V5775) 'true)
                    ((shen/and (shen/shen.+string? V5775)
                               (shen/shen.whitespace?
                                (shen/string->n (shen/hdstr V5775))))
                     (vector (list (shen/tlstr V5775) V5776)))
                    ((shen/and (shen/shen.+string? V5776)
                               (shen/shen.whitespace?
                                (shen/string->n (shen/hdstr V5776))))
                     (vector (list V5775 (shen/tlstr V5776))))
                    ((shen/and (shen/shen.+string? V5776)
                               (shen/= "(" (shen/hdstr V5776)))
                     (vector (list V5775 (shen/tlstr V5776))))
                    ((shen/and (shen/shen.+string? V5775)
                               (shen/and (shen/shen.+string? V5776)
                                         (shen/= (shen/hdstr V5775)
                                                 (shen/hdstr V5776))))
                     (vector (list (shen/tlstr V5775) (shen/tlstr V5776))))
                    (shen/true 'false))))
    (let ((result (funcall #'tail-trampoline V5775 V5776)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.recursive-string-match (V5787 V5788 V5789)
  (cl-flet
      ((tail-trampoline (V5787 V5788 V5789)
         (shen/cond ((shen/internal/predicate->shen (null V5789)) 'shen.skip)
                    ((shen/cons? V5789)
                     (shen/do
                      (shen/if (shen/shen.string-prefix? V5788 (shen/hd V5789))
                               (shen/pr
                                (shen/shen.app V5787
                                               (shen/cn ". "
                                                        (shen/shen.app
                                                         (shen/hd V5789) "\n"
                                                         'shen.a))
                                               'shen.a)
                                (shen/stoutput))
                               'shen.skip)
                      (vector (list (1+ V5787) V5788 (nthcdr 1 V5789)))))
                    (shen/true
                     (shen/simple-error
                      "implementation error in shen.recursive-string-match")))))
    (let ((result (funcall #'tail-trampoline V5787 V5788 V5789)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/macroexpand (V6898)
  (shen/let W6899
            (shen/map (shen/lambda Z6900 (nthcdr 1 Z6900))
                      (shen/value '*macros*))
            (shen/shen.macroexpand-h V6898 W6899 W6899)))
(defun shen/shen.macroexpand-h (V6909 V6910 V6911)
  (cl-flet
      ((tail-trampoline (V6909 V6910 V6911)
         (shen/if (shen/internal/predicate->shen (null V6910)) V6909
                  (shen/if (shen/cons? V6910)
                           (shen/let W6912
                                     (shen/shen.walk (shen/hd V6910) V6909)
                                     (shen/if (shen/= V6909 W6912)
                                              (vector
                                               (list V6909 (nthcdr 1 V6910)
                                                     V6911))
                                              (vector (list W6912 V6911 V6911))))
                           (shen/simple-error
                            "implementation error in shen.macroexpand-h")))))
    (let ((result (funcall #'tail-trampoline V6909 V6910 V6911)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.walk (V6913 V6914)
  (shen/if (shen/cons? V6914)
           (shen/internal/apply-higher-order-function V6913
                                                      (list
                                                       (shen/map
                                                        (shen/lambda Z6915
                                                                     (shen/shen.walk
                                                                      V6913
                                                                      Z6915))
                                                        V6914)))
           (shen/internal/apply-higher-order-function V6913 (list V6914))))
(defun shen/shen.macros (V6916)
  (shen/let GoTo6917 (shen/freeze V6916)
            (shen/if (shen/cons? V6916)
                     (shen/let Select6918 (shen/hd V6916)
                               (shen/let Select6919 (nthcdr 1 V6916)
                                         (shen/if
                                          (shen/and
                                           (shen/= 'defmacro Select6918)
                                           (shen/cons? Select6919))
                                          (shen/shen.process-def
                                           (shen/hd Select6919)
                                           (nthcdr 1 Select6919))
                                          (shen/if (shen/= 'defcc Select6918)
                                                   (shen/shen.yacc->shen
                                                    Select6919)
                                                   (shen/if
                                                    (shen/and
                                                     (shen/= 'u! Select6918)
                                                     (shen/and
                                                      (shen/cons? Select6919)
                                                      (shen/internal/predicate->shen
                                                       (null
                                                        (nthcdr 1 Select6919)))))
                                                    (list 'protect
                                                          (shen/shen.make-uppercase
                                                           (shen/hd Select6919)))
                                                    (shen/if
                                                     (shen/and
                                                      (shen/= 'error Select6918)
                                                      (shen/cons? Select6919))
                                                     (list 'simple-error
                                                           (shen/shen.mkstr
                                                            (shen/hd Select6919)
                                                            (nthcdr 1 Select6919)))
                                                     (shen/if
                                                      (shen/and
                                                       (shen/= 'output
                                                               Select6918)
                                                       (shen/cons? Select6919))
                                                      (list 'pr
                                                            (shen/shen.mkstr
                                                             (shen/hd Select6919)
                                                             (nthcdr 1
                                                                     Select6919))
                                                            (list 'stoutput))
                                                      (shen/if
                                                       (shen/and
                                                        (shen/= 'pr Select6918)
                                                        (shen/and
                                                         (shen/cons? Select6919)
                                                         (shen/internal/predicate->shen
                                                          (null
                                                           (nthcdr 1 Select6919)))))
                                                       (list 'pr
                                                             (shen/hd Select6919)
                                                             (list 'stoutput))
                                                       (shen/if
                                                        (shen/and
                                                         (shen/= 'make-string
                                                                 Select6918)
                                                         (shen/cons? Select6919))
                                                        (shen/shen.mkstr
                                                         (shen/hd Select6919)
                                                         (nthcdr 1 Select6919))
                                                        (shen/if
                                                         (shen/and
                                                          (shen/= 'lineread
                                                                  Select6918)
                                                          (shen/internal/predicate->shen
                                                           (null Select6919)))
                                                         (list 'lineread
                                                               (list 'stinput))
                                                         (shen/if
                                                          (shen/and
                                                           (shen/= 'input
                                                                   Select6918)
                                                           (shen/internal/predicate->shen
                                                            (null Select6919)))
                                                          (list 'input
                                                                (list 'stinput))
                                                          (shen/if
                                                           (shen/and
                                                            (shen/= 'read
                                                                    Select6918)
                                                            (shen/internal/predicate->shen
                                                             (null Select6919)))
                                                           (list 'read
                                                                 (list 'stinput))
                                                           (shen/if
                                                            (shen/and
                                                             (shen/= 'input+
                                                                     Select6918)
                                                             (shen/and
                                                              (shen/cons?
                                                               Select6919)
                                                              (shen/internal/predicate->shen
                                                               (null
                                                                (nthcdr 1
                                                                        Select6919)))))
                                                            (list 'input+
                                                                  (shen/hd
                                                                   Select6919)
                                                                  (list 'stinput))
                                                            (shen/if
                                                             (shen/and
                                                              (shen/= 'read-byte
                                                                      Select6918)
                                                              (shen/internal/predicate->shen
                                                               (null Select6919)))
                                                             (shen/shen.process-read-byte)
                                                             (shen/if
                                                              (shen/= 'prolog?
                                                                      Select6918)
                                                              (shen/shen.call-prolog
                                                               Select6919)
                                                              (shen/if
                                                               (shen/and
                                                                (shen/=
                                                                 'defprolog
                                                                 Select6918)
                                                                (shen/cons?
                                                                 Select6919))
                                                               (shen/shen.compile-prolog
                                                                (shen/hd
                                                                 Select6919)
                                                                (nthcdr 1
                                                                        Select6919))
                                                               (shen/if
                                                                (shen/and
                                                                 (shen/=
                                                                  'datatype
                                                                  Select6918)
                                                                 (shen/cons?
                                                                  Select6919))
                                                                (shen/shen.process-datatype
                                                                 (shen/hd
                                                                  Select6919)
                                                                 (nthcdr 1
                                                                         Select6919))
                                                                (shen/if
                                                                 (shen/= '@s
                                                                         Select6918)
                                                                 (shen/shen.process-@s
                                                                  V6916)
                                                                 (shen/if
                                                                  (shen/=
                                                                   'synonyms
                                                                   Select6918)
                                                                  (shen/shen.process-synonyms
                                                                   Select6919)
                                                                  (shen/if
                                                                   (shen/and
                                                                    (shen/= 'nl
                                                                            Select6918)
                                                                    (shen/internal/predicate->shen
                                                                     (null
                                                                      Select6919)))
                                                                   (list 'nl 1)
                                                                   (shen/if
                                                                    (shen/= 'let
                                                                            Select6918)
                                                                    (shen/shen.process-let
                                                                     V6916)
                                                                    (shen/if
                                                                     (shen/= '/.
                                                                             Select6918)
                                                                     (shen/shen.process-lambda
                                                                      V6916)
                                                                     (shen/if
                                                                      (shen/=
                                                                       'cases
                                                                       Select6918)
                                                                      (shen/shen.process-cases
                                                                       V6916)
                                                                      (shen/if
                                                                       (shen/and
                                                                        (shen/=
                                                                         'time
                                                                         Select6918)
                                                                        (shen/and
                                                                         (shen/cons?
                                                                          Select6919)
                                                                         (shen/internal/predicate->shen
                                                                          (null
                                                                           (nthcdr
                                                                            1
                                                                            Select6919)))))
                                                                       (shen/shen.process-time
                                                                        (shen/hd
                                                                         Select6919))
                                                                       (shen/if
                                                                        (shen/and
                                                                         (shen/=
                                                                          'put
                                                                          Select6918)
                                                                         (shen/and
                                                                          (shen/cons?
                                                                           Select6919)
                                                                          (shen/and
                                                                           (shen/cons?
                                                                            (nthcdr
                                                                             1
                                                                             Select6919))
                                                                           (shen/and
                                                                            (shen/cons?
                                                                             (nthcdr
                                                                              2
                                                                              Select6919))
                                                                            (shen/internal/predicate->shen
                                                                             (null
                                                                              (nthcdr
                                                                               3
                                                                               Select6919)))))))
                                                                        (list
                                                                         'put
                                                                         (shen/hd
                                                                          Select6919)
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           1
                                                                           Select6919))
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           2
                                                                           Select6919))
                                                                         (list
                                                                          'value
                                                                          '*property-vector*))
                                                                        (shen/if
                                                                         (shen/and
                                                                          (shen/=
                                                                           'get
                                                                           Select6918)
                                                                          (shen/and
                                                                           (shen/cons?
                                                                            Select6919)
                                                                           (shen/and
                                                                            (shen/cons?
                                                                             (nthcdr
                                                                              1
                                                                              Select6919))
                                                                            (shen/internal/predicate->shen
                                                                             (null
                                                                              (nthcdr
                                                                               2
                                                                               Select6919))))))
                                                                         (list
                                                                          'get
                                                                          (shen/hd
                                                                           Select6919)
                                                                          (shen/hd
                                                                           (nthcdr
                                                                            1
                                                                            Select6919))
                                                                          (list
                                                                           'value
                                                                           '*property-vector*))
                                                                         (shen/if
                                                                          (shen/and
                                                                           (shen/=
                                                                            'unput
                                                                            Select6918)
                                                                           (shen/and
                                                                            (shen/cons?
                                                                             Select6919)
                                                                            (shen/and
                                                                             (shen/cons?
                                                                              (nthcdr
                                                                               1
                                                                               Select6919))
                                                                             (shen/internal/predicate->shen
                                                                              (null
                                                                               (nthcdr
                                                                                2
                                                                                Select6919))))))
                                                                          (list
                                                                           'unput
                                                                           (shen/hd
                                                                            Select6919)
                                                                           (shen/hd
                                                                            (nthcdr
                                                                             1
                                                                             Select6919))
                                                                           (list
                                                                            'value
                                                                            '*property-vector*))
                                                                          (shen/if
                                                                           (shen/and
                                                                            (shen/cons?
                                                                             Select6919)
                                                                            (shen/and
                                                                             (shen/cons?
                                                                              (nthcdr
                                                                               1
                                                                               Select6919))
                                                                             (shen/and
                                                                              (shen/cons?
                                                                               (nthcdr
                                                                                2
                                                                                Select6919))
                                                                              (shen/element?
                                                                               Select6918
                                                                               (list
                                                                                '@p
                                                                                '@v
                                                                                'append
                                                                                'and
                                                                                'or
                                                                                '+
                                                                                '*
                                                                                'do)))))
                                                                           (list
                                                                            Select6918
                                                                            (shen/hd
                                                                             Select6919)
                                                                            (shen/shen.process-assoc
                                                                             (append
                                                                              (list
                                                                               Select6918)
                                                                              (nthcdr
                                                                               1
                                                                               Select6919))))
                                                                           (shen/thaw
                                                                            GoTo6917)))))))))))))))))))))))))))))
                     (shen/thaw GoTo6917))))
(defun shen/shen.process-def (V6920 V6921)
  (shen/let W6922 (list 'X '-> 'X)
            (shen/let W6923
                      (shen/eval
                       (append (list 'define V6920) (shen/append V6921 W6922)))
                      (shen/let W6924
                                (shen/shen.record-macro V6920 (shen/fn V6920))
                                V6920))))
(defun shen/shen.process-let (V6925)
  (shen/if
   (shen/and (shen/cons? V6925)
             (shen/and (shen/= 'let (shen/hd V6925))
                       (shen/and (shen/cons? (nthcdr 1 V6925))
                                 (shen/and (shen/cons? (nthcdr 2 V6925))
                                           (shen/and
                                            (shen/cons? (nthcdr 3 V6925))
                                            (shen/cons? (nthcdr 4 V6925)))))))
   (list 'let (shen/hd (nthcdr 1 V6925)) (shen/hd (nthcdr 2 V6925))
         (append (list 'let) (nthcdr 3 V6925)))
   V6925))
(defun shen/shen.process-@s (V6926)
  (cl-flet
      ((tail-trampoline (V6926)
         (shen/let GoTo6928 (shen/freeze V6926)
                   (shen/if (shen/cons? V6926)
                            (shen/let Select6935 (nthcdr 1 V6926)
                                      (shen/if (shen/= '@s (shen/hd V6926))
                                               (shen/if (shen/cons? Select6935)
                                                        (shen/let Select6933
                                                                  (shen/hd
                                                                   Select6935)
                                                                  (shen/let
                                                                   Select6934
                                                                   (nthcdr 1
                                                                           Select6935)
                                                                   (shen/if
                                                                    (shen/cons?
                                                                     Select6934)
                                                                    (shen/let
                                                                     Select6932
                                                                     (nthcdr 1
                                                                             Select6934)
                                                                     (shen/if
                                                                      (shen/cons?
                                                                       Select6932)
                                                                      (list '@s
                                                                            Select6933
                                                                            (shen/shen.process-@s
                                                                             (append
                                                                              (list
                                                                               '@s)
                                                                              Select6934)))
                                                                      (shen/if
                                                                       (shen/and
                                                                        (shen/internal/predicate->shen
                                                                         (null
                                                                          Select6932))
                                                                        (shen/string?
                                                                         Select6933))
                                                                       (shen/let
                                                                        W6927
                                                                        (shen/explode
                                                                         Select6933)
                                                                        (shen/if
                                                                         (shen/>
                                                                          (shen/length
                                                                           W6927)
                                                                          1)
                                                                         (vector
                                                                          (list
                                                                           (append
                                                                            (list
                                                                             '@s)
                                                                            (shen/append
                                                                             W6927
                                                                             Select6934))))
                                                                         V6926))
                                                                       (shen/thaw
                                                                        GoTo6928))))
                                                                    (shen/thaw
                                                                     GoTo6928))))
                                                        (shen/thaw GoTo6928))
                                               (shen/thaw GoTo6928)))
                            (shen/thaw GoTo6928)))))
    (let ((result (funcall #'tail-trampoline V6926)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.process-datatype (V6936 V6937)
  (shen/let W6938 (shen/shen.intern-type V6936)
            (shen/let W6939
                      (shen/compile
                       (shen/lambda Z6940 (shen/shen.<datatype> Z6940))
                       (append (list W6938) V6937))
                      W6938)))
(defun shen/shen.intern-type (V6941)
  (shen/intern (shen/cn (shen/str V6941) "#type")))
(defun shen/shen.process-synonyms (V6942)
  (shen/shen.synonyms-h
   (shen/set 'shen.*synonyms* (shen/append V6942 (shen/value 'shen.*synonyms*)))))
(defun shen/shen.synonyms-h (V6943)
  (shen/let W6944
            (shen/map (shen/lambda Z6945 (shen/shen.curry-type Z6945)) V6943)
            (shen/let W6946
                      (shen/eval
                       (append (list 'define 'shen.demod)
                               (shen/shen.compile-synonyms W6944)))
                      'synonyms)))
(defun shen/shen.compile-synonyms (V6949)
  (shen/if (shen/internal/predicate->shen (null V6949))
           (shen/let W6950 (shen/gensym 'X) (list W6950 '-> W6950))
           (shen/if (shen/and (shen/cons? V6949) (shen/cons? (nthcdr 1 V6949)))
                    (append
                     (list (shen/shen.rcons_form (shen/hd V6949)) '->
                           (shen/shen.rcons_form (shen/hd (nthcdr 1 V6949))))
                     (shen/shen.compile-synonyms (nthcdr 2 V6949)))
                    (shen/simple-error
                     "synonyms requires an even number of arguments\n"))))
(defun shen/shen.process-lambda (V6951)
  (shen/let GoTo6952 (shen/freeze V6951)
            (shen/if (shen/cons? V6951)
                     (shen/let Select6959 (nthcdr 1 V6951)
                               (shen/if (shen/= '/. (shen/hd V6951))
                                        (shen/if (shen/cons? Select6959)
                                                 (shen/let Select6957
                                                           (shen/hd Select6959)
                                                           (shen/let Select6958
                                                                     (nthcdr 1
                                                                             Select6959)
                                                                     (shen/if
                                                                      (shen/cons?
                                                                       Select6958)
                                                                      (shen/let
                                                                       Select6956
                                                                       (nthcdr 1
                                                                               Select6958)
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         Select6956)
                                                                        (list
                                                                         'lambda
                                                                         Select6957
                                                                         (shen/shen.process-lambda
                                                                          (append
                                                                           (list
                                                                            '/.)
                                                                           Select6958)))
                                                                        (shen/if
                                                                         (shen/internal/predicate->shen
                                                                          (null
                                                                           Select6956))
                                                                         (shen/if
                                                                          (shen/variable?
                                                                           Select6957)
                                                                          (append
                                                                           (list
                                                                            'lambda)
                                                                           Select6959)
                                                                          (shen/simple-error
                                                                           (shen/shen.app
                                                                            Select6957
                                                                            " is not a variable\n"
                                                                            'shen.s)))
                                                                         (shen/thaw
                                                                          GoTo6952))))
                                                                      (shen/thaw
                                                                       GoTo6952))))
                                                 (shen/thaw GoTo6952))
                                        (shen/thaw GoTo6952)))
                     (shen/thaw GoTo6952))))
(defun shen/shen.process-cases (V6962)
  (shen/let GoTo6963 (shen/freeze V6962)
            (shen/if (shen/cons? V6962)
                     (shen/let Select6971 (nthcdr 1 V6962)
                               (shen/if (shen/= 'cases (shen/hd V6962))
                                        (shen/if (shen/cons? Select6971)
                                                 (shen/let Select6969
                                                           (shen/hd Select6971)
                                                           (shen/let Select6970
                                                                     (nthcdr 1
                                                                             Select6971)
                                                                     (shen/if
                                                                      (shen/and
                                                                       (shen/=
                                                                        'true
                                                                        Select6969)
                                                                       (shen/cons?
                                                                        Select6970))
                                                                      (shen/hd
                                                                       Select6970)
                                                                      (shen/let
                                                                       GoTo6966
                                                                       (shen/freeze
                                                                        (shen/if
                                                                         (shen/internal/predicate->shen
                                                                          (null
                                                                           Select6970))
                                                                         (shen/simple-error
                                                                          "error: odd number of case elements\n")
                                                                         (shen/thaw
                                                                          GoTo6963)))
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         Select6970)
                                                                        (shen/let
                                                                         Select6967
                                                                         (shen/hd
                                                                          Select6970)
                                                                         (shen/let
                                                                          Select6968
                                                                          (nthcdr
                                                                           1
                                                                           Select6970)
                                                                          (shen/if
                                                                           (shen/internal/predicate->shen
                                                                            (null
                                                                             Select6968))
                                                                           (list
                                                                            'if
                                                                            Select6969
                                                                            Select6967
                                                                            (list
                                                                             'simple-error
                                                                             "error: cases exhausted"))
                                                                           (list
                                                                            'if
                                                                            Select6969
                                                                            Select6967
                                                                            (shen/shen.process-cases
                                                                             (append
                                                                              (list
                                                                               'cases)
                                                                              Select6968))))))
                                                                        (shen/thaw
                                                                         GoTo6966))))))
                                                 (shen/thaw GoTo6963))
                                        (shen/thaw GoTo6963)))
                     (shen/thaw GoTo6963))))
(defun shen/shen.process-time (V6972)
  (list 'let 'Start (list 'get-time 'run) 'Result V6972 'Finish
        (list 'get-time 'run) 'Time (list '- 'Finish 'Start) 'Message
        (list 'pr
              (list 'cn "\nrun time: " (list 'cn (list 'str 'Time) " secs\n"))
              (list 'stoutput))
        'Result))
(defun shen/shen.process-assoc (V6973)
  (shen/if
   (shen/and (shen/cons? V6973)
             (shen/and (shen/cons? (nthcdr 1 V6973))
                       (shen/and (shen/cons? (nthcdr 2 V6973))
                                 (shen/cons? (nthcdr 3 V6973)))))
   (list (shen/hd V6973) (shen/hd (nthcdr 1 V6973))
         (append (list (shen/hd V6973)) (nthcdr 2 V6973)))
   V6973))
(defun shen/shen.make-uppercase (V6974)
  (shen/intern (shen/shen.mu-h (shen/str V6974))))
(defun shen/shen.mu-h (V6975)
  (shen/if (shen/= "" V6975) ""
           (shen/if (shen/shen.+string? V6975)
                    (shen/let W6976 (shen/string->n (shen/hdstr V6975))
                              (shen/let W6977 (shen/- W6976 32)
                                        (shen/let W6978
                                                  (shen/if
                                                   (shen/and (shen/>= W6976 97)
                                                             (shen/<= W6976 122))
                                                   (shen/n->string W6977)
                                                   (shen/hdstr V6975))
                                                  (concat (concat W6978)
                                                          (shen/shen.mu-h
                                                           (shen/tlstr V6975))))))
                    (shen/shen.f-error 'shen.mu-h))))
(defun shen/shen.record-macro (V6979 V6980)
  (shen/set '*macros*
            (shen/shen.update-assoc V6979 V6980 (shen/value '*macros*))))
(defun shen/shen.update-assoc (V6990 V6991 V6992)
  (shen/if (shen/internal/predicate->shen (null V6992))
           (list (append (list V6990) V6991))
           (shen/let GoTo6993
                     (shen/freeze
                      (shen/simple-error
                       "implementation error in shen.update-assoc"))
                     (shen/if (shen/cons? V6992)
                              (shen/let Select6994 (shen/hd V6992)
                                        (shen/let Select6995 (nthcdr 1 V6992)
                                                  (shen/if
                                                   (shen/and
                                                    (shen/cons? Select6994)
                                                    (shen/= V6990
                                                            (shen/hd Select6994)))
                                                   (append
                                                    (list
                                                     (append
                                                      (list (shen/hd Select6994))
                                                      V6991))
                                                    Select6995)
                                                   (append (list Select6994)
                                                           (shen/shen.update-assoc
                                                            V6990 V6991
                                                            Select6995)))))
                              (shen/thaw GoTo6993)))))
(defun shen/shen.process-read-byte nil
  (shen/if (shen/shen.char-stinput? (shen/stinput))
           (list 'string->n (list 'shen.read-unit-string (list 'stinput)))
           (list 'read-byte (list 'stinput))))
(defun shen/shen.call-prolog (V6996)
  (shen/let W6997 (list 'shen.prolog-vector)
            (shen/let W6998 (list '@v 'true 0 (list 'vector 0))
                      (shen/let W6999 0
                                (shen/let W7000 (list 'freeze 'true)
                                          (shen/let W7001
                                                    (shen/compile
                                                     (shen/lambda Z7002
                                                                  (shen/shen.<body>
                                                                   Z7002))
                                                     V6996)
                                                    (shen/let W7003
                                                              (shen/shen.received
                                                               V6996)
                                                              (shen/let W7004
                                                                        (shen/gensym
                                                                         'V)
                                                                        (shen/let
                                                                         W7005
                                                                         (shen/gensym
                                                                          'L)
                                                                         (shen/let
                                                                          W7006
                                                                          (shen/gensym
                                                                           'K)
                                                                          (shen/let
                                                                           W7007
                                                                           (shen/gensym
                                                                            'C)
                                                                           (shen/let
                                                                            W7008
                                                                            (list
                                                                             'lambda
                                                                             W7004
                                                                             (list
                                                                              'lambda
                                                                              W7005
                                                                              (list
                                                                               'lambda
                                                                               W7006
                                                                               (list
                                                                                'lambda
                                                                                W7007
                                                                                (shen/shen.continue
                                                                                 W7003
                                                                                 W7001
                                                                                 W7004
                                                                                 W7005
                                                                                 W7006
                                                                                 W7007)))))
                                                                            (list
                                                                             W7008
                                                                             W6997
                                                                             W6998
                                                                             W6999
                                                                             W7000)))))))))))))
(defun shen/shen.received (V7011)
  (shen/let GoTo7012 (shen/freeze nil)
            (shen/if (shen/cons? V7011)
                     (shen/let Select7013 (shen/hd V7011)
                               (shen/let Select7014 (nthcdr 1 V7011)
                                         (shen/if
                                          (shen/and (shen/= 'receive Select7013)
                                                    (shen/and
                                                     (shen/cons? Select7014)
                                                     (shen/internal/predicate->shen
                                                      (null
                                                       (nthcdr 1 Select7014)))))
                                          Select7014
                                          (shen/union
                                           (shen/shen.received Select7013)
                                           (shen/shen.received Select7014)))))
                     (shen/thaw GoTo7012))))
(defun shen/shen.prolog-vector nil
  (shen/let W7015 (shen/absvector (shen/value 'shen.*prolog-memory*))
            (shen/let W7016 (shen/address-> W7015 0 'shen.print-prolog-vector)
                      (shen/let W7017 (shen/address-> W7015 1 2) W7017))))
(defun shen/receive (V7018) V7018)
(defun shen/shen.rcons_form (V7019)
  (shen/if (shen/cons? V7019)
           (list 'cons (shen/shen.rcons_form (shen/hd V7019))
                 (shen/shen.rcons_form (nthcdr 1 V7019)))
           V7019))
(defun shen/shen.tuple-up (V7020)
  (shen/if (shen/cons? V7020)
           (list '@p (shen/hd V7020) (shen/shen.tuple-up (nthcdr 1 V7020)))
           V7020))
(defun shen/undefmacro (V7021)
  (shen/do
   (shen/set '*macros*
             (shen/remove (shen/assoc V7021 (shen/value '*macros*))
                          (shen/value '*macros*)))
   V7021))
(defun shen/load (V1192)
  (shen/let W1193 (shen/value 'shen.*tc*)
            (shen/let W1194
                      (shen/let W1195 (shen/get-time 'run)
                                (shen/let W1196
                                          (shen/shen.load-help W1193
                                                               (shen/read-file
                                                                V1192))
                                          (shen/let W1197 (shen/get-time 'run)
                                                    (shen/let W1198
                                                              (shen/- W1197
                                                                      W1195)
                                                              (shen/let W1199
                                                                        (shen/pr
                                                                         (shen/cn
                                                                          "\nrun time: "
                                                                          (shen/cn
                                                                           (shen/str
                                                                            W1198)
                                                                           " secs\n"))
                                                                         (shen/stoutput))
                                                                        W1196)))))
                      (shen/let W1200
                                (shen/if W1193
                                         (shen/pr
                                          (shen/cn "\ntypechecked in "
                                                   (shen/shen.app
                                                    (shen/inferences)
                                                    " inferences\n" 'shen.a))
                                          (shen/stoutput))
                                         'shen.skip)
                                'loaded))))
(defun shen/shen.load-help (V1203 V1204)
  (shen/cond ((shen/= 'false V1203) (shen/shen.eval-and-print V1204))
             (shen/true (shen/shen.check-eval-and-print V1204))))
(defun shen/shen.eval-and-print (V1205)
  (shen/shen.for-each
   (shen/lambda Z1206
                (shen/pr
                 (shen/shen.app (shen/eval-kl (shen/shen.shen->kl Z1206)) "\n"
                                'shen.s)
                 (shen/stoutput)))
   V1205))
(defun shen/shen.check-eval-and-print (V1207)
  (shen/let W1208
            (shen/mapcan (shen/lambda Z1209 (shen/shen.typetable Z1209)) V1207)
            (shen/let W1210
                      (shen/trap-error (shen/shen.assumetypes W1208)
                                       (shen/lambda Z1211
                                                    (shen/shen.unwind-types
                                                     Z1211 W1208)))
                      (shen/trap-error (shen/shen.work-through V1207)
                                       (shen/lambda Z1212
                                                    (shen/shen.unwind-types
                                                     Z1212 W1208))))))
(defun shen/shen.typetable (V1217)
  (shen/cond
   ((shen/and (shen/cons? V1217)
              (shen/and (shen/= 'define (shen/hd V1217))
                        (shen/and (shen/cons? (nthcdr 1 V1217))
                                  (shen/and (shen/cons? (nthcdr 2 V1217))
                                            (shen/= '{
                                                    (shen/hd (nthcdr 2 V1217)))))))
    (list (shen/hd (nthcdr 1 V1217))
          (shen/shen.rectify-type
           (shen/shen.type-F (shen/hd (nthcdr 1 V1217)) (nthcdr 3 V1217)))))
   ((shen/and (shen/cons? V1217)
              (shen/and (shen/= 'define (shen/hd V1217))
                        (shen/cons? (nthcdr 1 V1217))))
    (shen/simple-error
     (shen/cn "missing { in "
              (shen/shen.app (shen/hd (nthcdr 1 V1217)) "\n" 'shen.a))))
   (shen/true nil)))
(defun shen/shen.type-F (V1224 V1225)
  (shen/cond ((shen/and (shen/cons? V1225) (shen/= '} (shen/hd V1225))) nil)
             ((shen/cons? V1225)
              (append (list (shen/hd V1225))
                      (shen/shen.type-F V1224 (nthcdr 1 V1225))))
             (shen/true
              (shen/simple-error
               (shen/cn "missing } in " (shen/shen.app V1224 "\n" 'shen.a))))))
(defun shen/shen.assumetypes (V1228)
  (cl-flet
      ((tail-trampoline (V1228)
         (shen/cond ((shen/internal/predicate->shen (null V1228)) nil)
                    ((shen/and (shen/cons? V1228) (shen/cons? (nthcdr 1 V1228)))
                     (shen/do
                      (shen/declare (shen/hd V1228) (shen/hd (nthcdr 1 V1228)))
                      (vector (list (nthcdr 2 V1228)))))
                    (shen/true
                     (shen/simple-error
                      "implementation error in shen.assumetype")))))
    (let ((result (funcall #'tail-trampoline V1228)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.unwind-types (V1233 V1234)
  (cl-flet
      ((tail-trampoline (V1233 V1234)
         (shen/cond
          ((shen/and (shen/cons? V1234) (shen/cons? (nthcdr 1 V1234)))
           (shen/do (shen/destroy (shen/hd V1234))
                    (vector (list V1233 (nthcdr 2 V1234)))))
          (shen/true (shen/simple-error (shen/error-to-string V1233))))))
    (let ((result (funcall #'tail-trampoline V1233 V1234)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.work-through (V1237)
  (cl-flet
      ((tail-trampoline (V1237)
         (shen/cond ((shen/internal/predicate->shen (null V1237)) nil)
                    ((shen/and (shen/cons? V1237)
                               (shen/and (shen/cons? (nthcdr 1 V1237))
                                         (shen/and (shen/cons? (nthcdr 2 V1237))
                                                   (shen/=
                                                    (shen/hd (nthcdr 1 V1237))
                                                    (shen/intern ":")))))
                     (shen/let W1238
                               (shen/shen.typecheck (shen/hd V1237)
                                                    (shen/hd (nthcdr 2 V1237)))
                               (shen/if (shen/= W1238 'false)
                                        (shen/shen.type-error)
                                        (shen/let W1239
                                                  (shen/eval-kl
                                                   (shen/shen.shen->kl
                                                    (shen/hd V1237)))
                                                  (shen/let W1240
                                                            (shen/pr
                                                             (shen/shen.app
                                                              W1239
                                                              (shen/cn " : "
                                                                       (shen/shen.app
                                                                        (shen/shen.pretty-type
                                                                         W1238)
                                                                        "\n"
                                                                        'shen.r))
                                                              'shen.s)
                                                             (shen/stoutput))
                                                            (vector
                                                             (list
                                                              (nthcdr 3 V1237))))))))
                    ((shen/cons? V1237)
                     (vector
                      (list
                       (append (list (shen/hd V1237) (shen/intern ":") 'A)
                               (nthcdr 1 V1237)))))
                    (shen/true
                     (shen/simple-error
                      "implementation error in shen.work-through")))))
    (let ((result (funcall #'tail-trampoline V1237)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.pretty-type (V1242)
  (shen/cond
   ((shen/and (shen/cons? V1242)
              (shen/and (shen/cons? (shen/hd V1242))
                        (shen/and (shen/= 'list (shen/hd (shen/hd V1242)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V1242)))
                                   (shen/and
                                    (shen/internal/predicate->shen
                                     (null (nthcdr 2 (shen/hd V1242))))
                                    (shen/and (shen/cons? (nthcdr 1 V1242))
                                              (shen/and
                                               (shen/= '-->
                                                       (shen/hd (nthcdr 1 V1242)))
                                               (shen/and
                                                (shen/cons? (nthcdr 2 V1242))
                                                (shen/and
                                                 (shen/cons?
                                                  (shen/hd (nthcdr 2 V1242)))
                                                 (shen/and
                                                  (shen/= 'str
                                                          (shen/hd
                                                           (shen/hd
                                                            (nthcdr 2 V1242))))
                                                  (shen/and
                                                   (shen/cons?
                                                    (nthcdr 1
                                                            (shen/hd
                                                             (nthcdr 2 V1242))))
                                                   (shen/and
                                                    (shen/cons?
                                                     (shen/hd
                                                      (nthcdr 1
                                                              (shen/hd
                                                               (nthcdr 2 V1242)))))
                                                    (shen/and
                                                     (shen/= 'list
                                                             (shen/hd
                                                              (shen/hd
                                                               (nthcdr 1
                                                                       (shen/hd
                                                                        (nthcdr
                                                                         2 V1242))))))
                                                     (shen/and
                                                      (shen/cons?
                                                       (nthcdr 1
                                                               (shen/hd
                                                                (nthcdr 1
                                                                        (shen/hd
                                                                         (nthcdr
                                                                          2
                                                                          V1242))))))
                                                      (shen/and
                                                       (shen/internal/predicate->shen
                                                        (null
                                                         (nthcdr 2
                                                                 (shen/hd
                                                                  (nthcdr 1
                                                                          (shen/hd
                                                                           (nthcdr
                                                                            2
                                                                            V1242)))))))
                                                       (shen/and
                                                        (shen/cons?
                                                         (nthcdr 2
                                                                 (shen/hd
                                                                  (nthcdr 2
                                                                          V1242))))
                                                        (shen/and
                                                         (shen/internal/predicate->shen
                                                          (null
                                                           (nthcdr 3
                                                                   (shen/hd
                                                                    (nthcdr 2
                                                                            V1242)))))
                                                         (shen/and
                                                          (shen/internal/predicate->shen
                                                           (null
                                                            (nthcdr 3 V1242)))
                                                          (shen/=
                                                           (shen/hd
                                                            (nthcdr 1
                                                                    (shen/hd
                                                                     V1242)))
                                                           (shen/hd
                                                            (nthcdr 1
                                                                    (shen/hd
                                                                     (nthcdr 1
                                                                             (shen/hd
                                                                              (nthcdr
                                                                               2
                                                                               V1242)))))))))))))))))))))))))
    (append (list (shen/hd (nthcdr 1 (shen/hd (nthcdr 2 V1242)))) '==>)
            (nthcdr 2 (shen/hd (nthcdr 2 V1242)))))
   ((shen/cons? V1242)
    (shen/map (shen/lambda Z1243 (shen/shen.pretty-type Z1243)) V1242))
   (shen/true V1242)))
(defun shen/shen.type-error nil (shen/simple-error "type error\n"))
(defun shen/bootstrap (V1244)
  (shen/let W1245 (shen/shen.klfile V1244)
            (shen/let W1246 (shen/read-file V1244)
                      (shen/let W1247 (shen/open W1245 'out)
                                (shen/let W1248
                                          (shen/map
                                           (shen/lambda Z1249
                                                        (shen/shen.partial
                                                         (shen/shen.shen->kl-h
                                                          Z1249)))
                                           W1246)
                                          (shen/let W1250
                                                    (shen/shen.write-kl W1248
                                                                        W1247)
                                                    W1245))))))
(defun shen/shen.partial (V1251)
  (shen/cond
   ((shen/and (shen/cons? V1251)
              (shen/and (shen/= 'shen.f-error (shen/hd V1251))
                        (shen/and (shen/cons? (nthcdr 1 V1251))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V1251))))))
    (list 'simple-error
          (shen/cn "partial function " (shen/str (shen/hd (nthcdr 1 V1251))))))
   ((shen/cons? V1251)
    (shen/map (shen/lambda Z1252 (shen/shen.partial Z1252)) V1251))
   (shen/true V1251)))
(defun shen/shen.write-kl (V1255 V1256)
  (cl-flet
      ((tail-trampoline (V1255 V1256)
         (shen/cond
          ((shen/internal/predicate->shen (null V1255)) (shen/close V1256))
          ((shen/and (shen/cons? V1255) (shen/cons? (shen/hd V1255)))
           (vector
            (list (nthcdr 1 V1255)
                  (shen/do (shen/shen.write-kl-h (shen/hd V1255) V1256) V1256))))
          ((shen/cons? V1255) (vector (list (nthcdr 1 V1255) V1256)))
          (shen/true (shen/shen.f-error 'shen.write-kl)))))
    (let ((result (funcall #'tail-trampoline V1255 V1256)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.write-kl-h (V1259 V1260)
  (shen/cond
   ((shen/and (shen/cons? V1259)
              (shen/and (shen/= 'defun (shen/hd V1259))
                        (shen/and (shen/cons? (nthcdr 1 V1259))
                                  (shen/and
                                   (shen/= 'fail (shen/hd (nthcdr 1 V1259)))
                                   (shen/and (shen/cons? (nthcdr 2 V1259))
                                             (shen/and
                                              (shen/internal/predicate->shen
                                               (null (shen/hd (nthcdr 2 V1259))))
                                              (shen/and
                                               (shen/cons? (nthcdr 3 V1259))
                                               (shen/internal/predicate->shen
                                                (null (nthcdr 4 V1259))))))))))
    (shen/pr "(defun fail () shen.fail!)" V1260))
   (shen/true (shen/pr (shen/shen.app V1259 "\n\n" 'shen.r) V1260))))
(defun shen/shen.klfile (V1261)
  (shen/cond ((shen/= "" V1261) ".kl") ((shen/= ".shen" V1261) ".kl")
             ((shen/shen.+string? V1261)
              (concat (concat (shen/hdstr V1261))
                      (shen/shen.klfile (shen/tlstr V1261))))
             (shen/true (shen/shen.f-error 'shen.klfile))))
(defun shen/asserta (V1530) (shen/shen.assert* V1530 'shen.top))
(defun shen/assertz (V1531) (shen/shen.assert* V1531 'shen.bottom))
(defun shen/shen.assert* (V1532 V1533)
  (shen/cond
   ((shen/and (shen/cons? V1532)
              (shen/and (shen/cons? (nthcdr 1 V1532))
                        (shen/= '<-- (shen/hd (nthcdr 1 V1532)))))
    (shen/let W1534 (shen/shen.predicate (shen/hd V1532))
              (shen/let W1535 (shen/shen.terms (shen/hd V1532))
                        (shen/let W1536 (shen/length W1535)
                                  (shen/let W1537 (shen/shen.parameters W1536)
                                            (shen/let W1538 (shen/arity W1534)
                                                      (shen/let W1539
                                                                (shen/if
                                                                 (shen/= W1538
                                                                         -1)
                                                                 (shen/do
                                                                  (shen/eval
                                                                   (shen/shen.create-skeleton
                                                                    W1534 W1537))
                                                                  (shen/put
                                                                   W1534
                                                                   'shen.dynamic
                                                                   nil
                                                                   (shen/value
                                                                    '*property-vector*)))
                                                                 'shen.skip)
                                                                (shen/let W1540
                                                                          (shen/shen.insert-info
                                                                           W1534
                                                                           W1535
                                                                           (nthcdr
                                                                            2
                                                                            V1532)
                                                                           V1532
                                                                           V1533)
                                                                          W1534))))))))
   (shen/true (shen/shen.f-error 'shen.assert*))))
(defun shen/shen.predicate (V1543)
  (shen/cond ((shen/cons? V1543) (shen/hd V1543)) (shen/true V1543)))
(defun shen/shen.terms (V1548)
  (shen/cond ((shen/cons? V1548) (nthcdr 1 V1548)) (shen/true nil)))
(defun shen/shen.create-skeleton (V1549 V1550)
  (append (list 'defprolog V1549) (shen/shen.dynamic-default V1549 V1550)))
(defun shen/shen.dynamic-default (V1551 V1552)
  (shen/append V1552
               (list '<--
                     (list 'shen.call-dynamic (shen/shen.cons-form V1552)
                           (list 'get V1551 'shen.dynamic))
                     (shen/intern ";"))))
(defun shen/shen.insert-info (V1553 V1554 V1555 V1556 V1557)
  (shen/let W1558 (shen/gensym 'shen.g)
            (shen/let W1559
                      (shen/eval
                       (shen/append (list 'defprolog W1558)
                                    (shen/append V1554
                                                 (append (list '<--) V1555))))
                      (shen/let W1560
                                (append (list (shen/fn W1558) W1558) V1556)
                                (shen/let W1561
                                          (shen/get V1553 'shen.dynamic
                                                    (shen/value
                                                     '*property-vector*))
                                          (shen/let W1562
                                                    (shen/if
                                                     (shen/= V1557 'shen.top)
                                                     (append (list W1560) W1561)
                                                     (shen/append W1561
                                                                  (list W1560)))
                                                    (shen/put V1553
                                                              'shen.dynamic
                                                              W1562
                                                              (shen/value
                                                               '*property-vector*))))))))
(defun shen/shen.newname nil
  (shen/let W1563 (shen/value 'shen.*names*)
            (shen/let W1564
                      (shen/if (shen/empty? W1563) (shen/gensym 'shen.g)
                               (shen/do
                                (shen/set 'shen.*names* (nthcdr 1 W1563))
                                (shen/hd W1563)))
                      W1564)))
(defun shen/shen.call-dynamic (V1565 V1566 V1567 V1568 V1569 V1570)
  (cl-flet
      ((tail-trampoline (V1565 V1566 V1567 V1568 V1569 V1570)
         (shen/let W1571
                   (shen/if (shen/shen.unlocked? V1568)
                            (shen/let W1572 (shen/shen.lazyderef V1566 V1567)
                                      (shen/if (shen/cons? W1572)
                                               (shen/let W1573
                                                         (shen/shen.lazyderef
                                                          (shen/hd W1572) V1567)
                                                         (shen/if
                                                          (shen/cons? W1573)
                                                          (shen/let W1574
                                                                    (shen/hd
                                                                     W1573)
                                                                    (shen/do
                                                                     (shen/shen.incinfs)
                                                                     (shen/shen.callrec
                                                                      W1574
                                                                      V1565
                                                                      V1567
                                                                      V1568
                                                                      V1569
                                                                      V1570)))
                                                          'false))
                                               'false))
                            'false)
                   (shen/if (shen/= W1571 'false)
                            (shen/if (shen/shen.unlocked? V1568)
                                     (shen/let W1575
                                               (shen/shen.lazyderef V1566 V1567)
                                               (shen/if (shen/cons? W1575)
                                                        (shen/let W1576
                                                                  (nthcdr 1
                                                                          W1575)
                                                                  (shen/do
                                                                   (shen/shen.incinfs)
                                                                   (vector
                                                                    (list V1565
                                                                          W1576
                                                                          V1567
                                                                          V1568
                                                                          V1569
                                                                          V1570))))
                                                        'false))
                                     'false)
                            W1571))))
    (let
        ((result (funcall #'tail-trampoline V1565 V1566 V1567 V1568 V1569 V1570)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.callrec (V1577 V1578 V1579 V1580 V1581 V1582)
  (cl-flet
      ((tail-trampoline (V1577 V1578 V1579 V1580 V1581 V1582)
         (shen/cond
          ((shen/internal/predicate->shen (null V1578))
           (shen/internal/apply-function-expression
            (shen/internal/apply-function-expression
             (shen/internal/apply-function-expression
              (shen/internal/apply-higher-order-function V1577 (list V1579))
              (list V1580))
             (list V1581))
            (list V1582)))
          ((shen/cons? V1578)
           (vector
            (list
             (shen/internal/apply-higher-order-function V1577
                                                        (list (shen/hd V1578)))
             (nthcdr 1 V1578) V1579 V1580 V1581 V1582)))
          (shen/true (shen/shen.f-error 'shen.callrec)))))
    (let
        ((result (funcall #'tail-trampoline V1577 V1578 V1579 V1580 V1581 V1582)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/retract (V1583)
  (shen/cond
   ((shen/and (shen/cons? V1583)
              (shen/and (shen/cons? (nthcdr 1 V1583))
                        (shen/= '<-- (shen/hd (nthcdr 1 V1583)))))
    (shen/let W1584 (shen/shen.predicate (shen/hd V1583))
              (shen/let W1585
                        (shen/get W1584 'shen.dynamic
                                  (shen/value '*property-vector*))
                        (shen/put W1584 'shen.dynamic
                                  (shen/shen.retract-clause V1583 W1585)
                                  (shen/value '*property-vector*)))))
   (shen/true (shen/shen.f-error 'retract))))
(defun shen/shen.retract-clause (V1591 V1592)
  (shen/cond ((shen/internal/predicate->shen (null V1592)) nil)
             ((shen/and (shen/cons? V1592)
                        (shen/and (shen/cons? (shen/hd V1592))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V1592)))
                                   (shen/= V1591 (nthcdr 2 (shen/hd V1592))))))
              (shen/do
               (shen/set 'shen.*names*
                         (append (list (shen/hd (nthcdr 1 (shen/hd V1592))))
                                 (shen/value 'shen.*names*)))
               (nthcdr 1 V1592)))
             ((shen/cons? V1592)
              (append (list (shen/hd V1592))
                      (shen/shen.retract-clause V1591 (nthcdr 1 V1592))))
             (shen/true (shen/shen.f-error 'shen.retract-clause))))
(defun shen/shen.compile-prolog (V1593 V1594)
  (shen/compile (shen/lambda Z1595 (shen/shen.<defprolog> Z1595))
                (append (list V1593) V1594)))
(defun shen/shen.<defprolog> (V1596)
  (shen/let W1597
            (shen/if (shen/cons? V1596)
                     (shen/let W1598 (shen/head V1596)
                               (shen/let W1599 (shen/tail V1596)
                                         (shen/let W1600
                                                   (shen/shen.<clauses> W1599)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W1600)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W1601
                                                              (shen/shen.<-out
                                                               W1600)
                                                              (shen/let W1602
                                                                        (shen/shen.in->
                                                                         W1600)
                                                                        (shen/shen.comb
                                                                         W1602
                                                                         (shen/let
                                                                          W1603
                                                                          (shen/shen.prolog-arity-check
                                                                           W1598
                                                                           W1601)
                                                                          (shen/let
                                                                           W1604
                                                                           (shen/map
                                                                            (shen/lambda
                                                                             Z1605
                                                                             (shen/shen.linearise-clause
                                                                              Z1605))
                                                                            W1601)
                                                                           (shen/shen.horn-clause-procedure
                                                                            W1598
                                                                            W1604))))))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W1597) (shen/shen.parse-failure)
                     W1597)))
(defun shen/shen.prolog-arity-check (V1608 V1609)
  (shen/cond
   ((shen/and (shen/cons? V1609)
              (shen/and (shen/cons? (shen/hd V1609))
                        (shen/and (shen/cons? (nthcdr 1 (shen/hd V1609)))
                                  (shen/and
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V1609))))
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 1 V1609)))))))
    (shen/length (shen/hd (shen/hd V1609))))
   ((shen/and (shen/cons? V1609)
              (shen/and (shen/cons? (shen/hd V1609))
                        (shen/and (shen/cons? (nthcdr 1 (shen/hd V1609)))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 (shen/hd V1609)))))))
    (shen/shen.pac-h V1608 (shen/length (shen/hd (shen/hd V1609)))
                     (nthcdr 1 V1609)))
   (shen/true (shen/shen.f-error 'shen.prolog-arity-check))))
(defun shen/shen.pac-h (V1614 V1615 V1616)
  (cl-flet
      ((tail-trampoline (V1614 V1615 V1616)
         (shen/cond ((shen/internal/predicate->shen (null V1616)) V1615)
                    ((shen/and (shen/cons? V1616) (shen/cons? (shen/hd V1616)))
                     (shen/if
                      (shen/= V1615 (shen/length (shen/hd (shen/hd V1616))))
                      (vector (list V1614 V1615 (nthcdr 1 V1616)))
                      (shen/simple-error
                       (shen/cn "arity error in prolog procedure "
                                (shen/shen.app V1614 "\n" 'shen.a)))))
                    (shen/true (shen/shen.f-error 'shen.pac-h)))))
    (let ((result (funcall #'tail-trampoline V1614 V1615 V1616)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.<clauses> (V1617)
  (shen/let W1618
            (shen/let W1619 (shen/shen.<clause> V1617)
                      (shen/if (shen/shen.parse-failure? W1619)
                               (shen/shen.parse-failure)
                               (shen/let W1620 (shen/shen.<-out W1619)
                                         (shen/let W1621 (shen/shen.in-> W1619)
                                                   (shen/let W1622
                                                             (shen/shen.<clauses>
                                                              W1621)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W1622)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W1623
                                                                        (shen/shen.<-out
                                                                         W1622)
                                                                        (shen/let
                                                                         W1624
                                                                         (shen/shen.in->
                                                                          W1622)
                                                                         (shen/shen.comb
                                                                          W1624
                                                                          (append
                                                                           (list
                                                                            W1620)
                                                                           W1623))))))))))
            (shen/if (shen/shen.parse-failure? W1618)
                     (shen/let W1625
                               (shen/let W1626 (shen/<!> V1617)
                                         (shen/if
                                          (shen/shen.parse-failure? W1626)
                                          (shen/shen.parse-failure)
                                          (shen/let W1627
                                                    (shen/shen.<-out W1626)
                                                    (shen/let W1628
                                                              (shen/shen.in->
                                                               W1626)
                                                              (shen/shen.comb
                                                               W1628
                                                               (shen/if
                                                                (shen/empty?
                                                                 W1627)
                                                                nil
                                                                (shen/simple-error
                                                                 (shen/cn
                                                                  "Prolog syntax error here:\n "
                                                                  (shen/shen.app
                                                                   W1627
                                                                   "\n ..."
                                                                   'shen.r)))))))))
                               (shen/if (shen/shen.parse-failure? W1625)
                                        (shen/shen.parse-failure) W1625))
                     W1618)))
(defun shen/shen.linearise-clause (V1629)
  (shen/cond
   ((shen/and (shen/cons? V1629)
              (shen/and (shen/cons? (nthcdr 1 V1629))
                        (shen/internal/predicate->shen (null (nthcdr 2 V1629)))))
    (shen/shen.lch
     (shen/shen.linearise (shen/@p (shen/hd V1629) (shen/hd (nthcdr 1 V1629))))))
   (shen/true (shen/shen.f-error 'shen.linearise-clause))))
(defun shen/shen.lch (V1630)
  (shen/cond
   ((shen/tuple? V1630)
    (list (shen/fst V1630) (shen/shen.lchh (shen/snd V1630))))
   (shen/true (shen/shen.f-error 'shen.lch))))
(defun shen/shen.lchh (V1631)
  (shen/cond
   ((shen/and (shen/cons? V1631)
              (shen/and (shen/= 'where (shen/hd V1631))
                        (shen/and (shen/cons? (nthcdr 1 V1631))
                                  (shen/and
                                   (shen/cons? (shen/hd (nthcdr 1 V1631)))
                                   (shen/and
                                    (shen/= '=
                                            (shen/hd (shen/hd (nthcdr 1 V1631))))
                                    (shen/and
                                     (shen/cons?
                                      (nthcdr 1 (shen/hd (nthcdr 1 V1631))))
                                     (shen/and
                                      (shen/cons?
                                       (nthcdr 2 (shen/hd (nthcdr 1 V1631))))
                                      (shen/and
                                       (shen/internal/predicate->shen
                                        (null
                                         (nthcdr 3 (shen/hd (nthcdr 1 V1631)))))
                                       (shen/and (shen/cons? (nthcdr 2 V1631))
                                                 (shen/internal/predicate->shen
                                                  (null (nthcdr 3 V1631))))))))))))
    (append
     (list
      (append (list (shen/if (shen/value 'shen.*occurs*) 'is! 'is))
              (nthcdr 1 (shen/hd (nthcdr 1 V1631)))))
     (shen/shen.lchh (shen/hd (nthcdr 2 V1631)))))
   (shen/true V1631)))
(defun shen/shen.<clause> (V1632)
  (shen/let W1633
            (shen/let W1634 (shen/shen.<head> V1632)
                      (shen/if (shen/shen.parse-failure? W1634)
                               (shen/shen.parse-failure)
                               (shen/let W1635 (shen/shen.<-out W1634)
                                         (shen/let W1636 (shen/shen.in-> W1634)
                                                   (shen/if
                                                    (shen/shen.hds=? W1636 '<--)
                                                    (shen/let W1637
                                                              (shen/tail W1636)
                                                              (shen/let W1638
                                                                        (shen/shen.<body>
                                                                         W1637)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W1638)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W1639
                                                                          (shen/shen.<-out
                                                                           W1638)
                                                                          (shen/let
                                                                           W1640
                                                                           (shen/shen.in->
                                                                            W1638)
                                                                           (shen/let
                                                                            W1641
                                                                            (shen/shen.<sc>
                                                                             W1640)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W1641)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W1642
                                                                              (shen/shen.in->
                                                                               W1641)
                                                                              (shen/shen.comb
                                                                               W1642
                                                                               (list
                                                                                W1635
                                                                                W1639))))))))))
                                                    (shen/shen.parse-failure))))))
            (shen/if (shen/shen.parse-failure? W1633) (shen/shen.parse-failure)
                     W1633)))
(defun shen/shen.<head> (V1643)
  (shen/let W1644
            (shen/let W1645 (shen/shen.<hterm> V1643)
                      (shen/if (shen/shen.parse-failure? W1645)
                               (shen/shen.parse-failure)
                               (shen/let W1646 (shen/shen.<-out W1645)
                                         (shen/let W1647 (shen/shen.in-> W1645)
                                                   (shen/let W1648
                                                             (shen/shen.<head>
                                                              W1647)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W1648)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W1649
                                                                        (shen/shen.<-out
                                                                         W1648)
                                                                        (shen/let
                                                                         W1650
                                                                         (shen/shen.in->
                                                                          W1648)
                                                                         (shen/shen.comb
                                                                          W1650
                                                                          (append
                                                                           (list
                                                                            W1646)
                                                                           W1649))))))))))
            (shen/if (shen/shen.parse-failure? W1644)
                     (shen/let W1651
                               (shen/let W1652 (shen/<e> V1643)
                                         (shen/if
                                          (shen/shen.parse-failure? W1652)
                                          (shen/shen.parse-failure)
                                          (shen/let W1653 (shen/shen.in-> W1652)
                                                    (shen/shen.comb W1653 nil))))
                               (shen/if (shen/shen.parse-failure? W1651)
                                        (shen/shen.parse-failure) W1651))
                     W1644)))
(defun shen/shen.<hterm> (V1654)
  (shen/let W1655
            (shen/if (shen/cons? V1654)
                     (shen/let W1656 (shen/head V1654)
                               (shen/let W1657 (shen/tail V1654)
                                         (shen/if
                                          (shen/and (shen/atom? W1656)
                                                    (shen/not
                                                     (shen/shen.prolog-keyword?
                                                      W1656)))
                                          (shen/shen.comb W1657 W1656)
                                          (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W1655)
                     (shen/let W1658
                               (shen/if (shen/cons? V1654)
                                        (shen/let W1659 (shen/head V1654)
                                                  (shen/let W1660
                                                            (shen/tail V1654)
                                                            (shen/if
                                                             (shen/= W1659
                                                                     (shen/intern
                                                                      ":"))
                                                             (shen/shen.comb
                                                              W1660 W1659)
                                                             (shen/shen.parse-failure))))
                                        (shen/shen.parse-failure))
                               (shen/if (shen/shen.parse-failure? W1658)
                                        (shen/let W1661
                                                  (shen/if
                                                   (shen/shen.ccons? V1654)
                                                   (shen/let W1662
                                                             (shen/head V1654)
                                                             (shen/let W1663
                                                                       (shen/tail
                                                                        V1654)
                                                                       (shen/if
                                                                        (shen/shen.hds=?
                                                                         W1662
                                                                         'cons)
                                                                        (shen/let
                                                                         W1664
                                                                         (shen/tail
                                                                          W1662)
                                                                         (shen/let
                                                                          W1665
                                                                          (shen/shen.<hterm1>
                                                                           W1664)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W1665)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W1666
                                                                            (shen/shen.<-out
                                                                             W1665)
                                                                            (shen/let
                                                                             W1667
                                                                             (shen/shen.in->
                                                                              W1665)
                                                                             (shen/let
                                                                              W1668
                                                                              (shen/shen.<hterm2>
                                                                               W1667)
                                                                              (shen/if
                                                                               (shen/shen.parse-failure?
                                                                                W1668)
                                                                               (shen/shen.parse-failure)
                                                                               (shen/let
                                                                                W1669
                                                                                (shen/shen.<-out
                                                                                 W1668)
                                                                                (shen/let
                                                                                 W1670
                                                                                 (shen/shen.in->
                                                                                  W1668)
                                                                                 (shen/let
                                                                                  W1671
                                                                                  (shen/<end>
                                                                                   W1670)
                                                                                  (shen/if
                                                                                   (shen/shen.parse-failure?
                                                                                    W1671)
                                                                                   (shen/shen.parse-failure)
                                                                                   (shen/let
                                                                                    W1672
                                                                                    (shen/shen.in->
                                                                                     W1671)
                                                                                    (shen/shen.comb
                                                                                     W1663
                                                                                     (list
                                                                                      'cons
                                                                                      W1666
                                                                                      W1669))))))))))))))
                                                                        (shen/shen.parse-failure))))
                                                   (shen/shen.parse-failure))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W1661)
                                                   (shen/let W1673
                                                             (shen/if
                                                              (shen/shen.ccons?
                                                               V1654)
                                                              (shen/let W1674
                                                                        (shen/head
                                                                         V1654)
                                                                        (shen/let
                                                                         W1675
                                                                         (shen/tail
                                                                          V1654)
                                                                         (shen/if
                                                                          (shen/shen.hds=?
                                                                           W1674
                                                                           '+)
                                                                          (shen/let
                                                                           W1676
                                                                           (shen/tail
                                                                            W1674)
                                                                           (shen/let
                                                                            W1677
                                                                            (shen/shen.<hterm>
                                                                             W1676)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W1677)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W1678
                                                                              (shen/shen.<-out
                                                                               W1677)
                                                                              (shen/let
                                                                               W1679
                                                                               (shen/shen.in->
                                                                                W1677)
                                                                               (shen/let
                                                                                W1680
                                                                                (shen/<end>
                                                                                 W1679)
                                                                                (shen/if
                                                                                 (shen/shen.parse-failure?
                                                                                  W1680)
                                                                                 (shen/shen.parse-failure)
                                                                                 (shen/let
                                                                                  W1681
                                                                                  (shen/shen.in->
                                                                                   W1680)
                                                                                  (shen/shen.comb
                                                                                   W1675
                                                                                   (list
                                                                                    'shen.+m
                                                                                    W1678))))))))))
                                                                          (shen/shen.parse-failure))))
                                                              (shen/shen.parse-failure))
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W1673)
                                                              (shen/let W1682
                                                                        (shen/if
                                                                         (shen/shen.ccons?
                                                                          V1654)
                                                                         (shen/let
                                                                          W1683
                                                                          (shen/head
                                                                           V1654)
                                                                          (shen/let
                                                                           W1684
                                                                           (shen/tail
                                                                            V1654)
                                                                           (shen/if
                                                                            (shen/shen.hds=?
                                                                             W1683
                                                                             '-)
                                                                            (shen/let
                                                                             W1685
                                                                             (shen/tail
                                                                              W1683)
                                                                             (shen/let
                                                                              W1686
                                                                              (shen/shen.<hterm>
                                                                               W1685)
                                                                              (shen/if
                                                                               (shen/shen.parse-failure?
                                                                                W1686)
                                                                               (shen/shen.parse-failure)
                                                                               (shen/let
                                                                                W1687
                                                                                (shen/shen.<-out
                                                                                 W1686)
                                                                                (shen/let
                                                                                 W1688
                                                                                 (shen/shen.in->
                                                                                  W1686)
                                                                                 (shen/let
                                                                                  W1689
                                                                                  (shen/<end>
                                                                                   W1688)
                                                                                  (shen/if
                                                                                   (shen/shen.parse-failure?
                                                                                    W1689)
                                                                                   (shen/shen.parse-failure)
                                                                                   (shen/let
                                                                                    W1690
                                                                                    (shen/shen.in->
                                                                                     W1689)
                                                                                    (shen/shen.comb
                                                                                     W1684
                                                                                     (list
                                                                                      'shen.-m
                                                                                      W1687))))))))))
                                                                            (shen/shen.parse-failure))))
                                                                         (shen/shen.parse-failure))
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W1682)
                                                                         (shen/let
                                                                          W1691
                                                                          (shen/if
                                                                           (shen/shen.ccons?
                                                                            V1654)
                                                                           (shen/let
                                                                            W1692
                                                                            (shen/head
                                                                             V1654)
                                                                            (shen/let
                                                                             W1693
                                                                             (shen/tail
                                                                              V1654)
                                                                             (shen/if
                                                                              (shen/shen.hds=?
                                                                               W1692
                                                                               'mode)
                                                                              (shen/let
                                                                               W1694
                                                                               (shen/tail
                                                                                W1692)
                                                                               (shen/let
                                                                                W1695
                                                                                (shen/shen.<hterm>
                                                                                 W1694)
                                                                                (shen/if
                                                                                 (shen/shen.parse-failure?
                                                                                  W1695)
                                                                                 (shen/shen.parse-failure)
                                                                                 (shen/let
                                                                                  W1696
                                                                                  (shen/shen.<-out
                                                                                   W1695)
                                                                                  (shen/let
                                                                                   W1697
                                                                                   (shen/shen.in->
                                                                                    W1695)
                                                                                   (shen/if
                                                                                    (shen/shen.hds=?
                                                                                     W1697
                                                                                     '+)
                                                                                    (shen/let
                                                                                     W1698
                                                                                     (shen/tail
                                                                                      W1697)
                                                                                     (shen/let
                                                                                      W1699
                                                                                      (shen/<end>
                                                                                       W1698)
                                                                                      (shen/if
                                                                                       (shen/shen.parse-failure?
                                                                                        W1699)
                                                                                       (shen/shen.parse-failure)
                                                                                       (shen/let
                                                                                        W1700
                                                                                        (shen/shen.in->
                                                                                         W1699)
                                                                                        (shen/shen.comb
                                                                                         W1693
                                                                                         (list
                                                                                          'shen.+m
                                                                                          W1696))))))
                                                                                    (shen/shen.parse-failure)))))))
                                                                              (shen/shen.parse-failure))))
                                                                           (shen/shen.parse-failure))
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W1691)
                                                                           (shen/let
                                                                            W1701
                                                                            (shen/if
                                                                             (shen/shen.ccons?
                                                                              V1654)
                                                                             (shen/let
                                                                              W1702
                                                                              (shen/head
                                                                               V1654)
                                                                              (shen/let
                                                                               W1703
                                                                               (shen/tail
                                                                                V1654)
                                                                               (shen/if
                                                                                (shen/shen.hds=?
                                                                                 W1702
                                                                                 'mode)
                                                                                (shen/let
                                                                                 W1704
                                                                                 (shen/tail
                                                                                  W1702)
                                                                                 (shen/let
                                                                                  W1705
                                                                                  (shen/shen.<hterm>
                                                                                   W1704)
                                                                                  (shen/if
                                                                                   (shen/shen.parse-failure?
                                                                                    W1705)
                                                                                   (shen/shen.parse-failure)
                                                                                   (shen/let
                                                                                    W1706
                                                                                    (shen/shen.<-out
                                                                                     W1705)
                                                                                    (shen/let
                                                                                     W1707
                                                                                     (shen/shen.in->
                                                                                      W1705)
                                                                                     (shen/if
                                                                                      (shen/shen.hds=?
                                                                                       W1707
                                                                                       '-)
                                                                                      (shen/let
                                                                                       W1708
                                                                                       (shen/tail
                                                                                        W1707)
                                                                                       (shen/let
                                                                                        W1709
                                                                                        (shen/<end>
                                                                                         W1708)
                                                                                        (shen/if
                                                                                         (shen/shen.parse-failure?
                                                                                          W1709)
                                                                                         (shen/shen.parse-failure)
                                                                                         (shen/let
                                                                                          W1710
                                                                                          (shen/shen.in->
                                                                                           W1709)
                                                                                          (shen/shen.comb
                                                                                           W1703
                                                                                           (list
                                                                                            'shen.-m
                                                                                            W1706))))))
                                                                                      (shen/shen.parse-failure)))))))
                                                                                (shen/shen.parse-failure))))
                                                                             (shen/shen.parse-failure))
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W1701)
                                                                             (shen/shen.parse-failure)
                                                                             W1701))
                                                                           W1691))
                                                                         W1682))
                                                              W1673))
                                                   W1661))
                                        W1658))
                     W1655)))
(defun shen/shen.prolog-keyword? (V1711)
  (shen/element? V1711 (list (shen/intern ";") '<--)))
(defun shen/atom? (V1712)
  (shen/or (shen/symbol? V1712)
           (shen/or (shen/string? V1712)
                    (shen/or (shen/boolean? V1712)
                             (shen/or (shen/number? V1712) (shen/empty? V1712))))))
(defun shen/shen.<hterm1> (V1713)
  (shen/let W1714
            (shen/let W1715 (shen/shen.<hterm> V1713)
                      (shen/if (shen/shen.parse-failure? W1715)
                               (shen/shen.parse-failure)
                               (shen/let W1716 (shen/shen.<-out W1715)
                                         (shen/let W1717 (shen/shen.in-> W1715)
                                                   (shen/shen.comb W1717 W1716)))))
            (shen/if (shen/shen.parse-failure? W1714) (shen/shen.parse-failure)
                     W1714)))
(defun shen/shen.<hterm2> (V1718)
  (shen/let W1719
            (shen/let W1720 (shen/shen.<hterm> V1718)
                      (shen/if (shen/shen.parse-failure? W1720)
                               (shen/shen.parse-failure)
                               (shen/let W1721 (shen/shen.<-out W1720)
                                         (shen/let W1722 (shen/shen.in-> W1720)
                                                   (shen/shen.comb W1722 W1721)))))
            (shen/if (shen/shen.parse-failure? W1719) (shen/shen.parse-failure)
                     W1719)))
(defun shen/shen.<body> (V1723)
  (shen/let W1724
            (shen/let W1725 (shen/shen.<literal> V1723)
                      (shen/if (shen/shen.parse-failure? W1725)
                               (shen/shen.parse-failure)
                               (shen/let W1726 (shen/shen.<-out W1725)
                                         (shen/let W1727 (shen/shen.in-> W1725)
                                                   (shen/let W1728
                                                             (shen/shen.<body>
                                                              W1727)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W1728)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W1729
                                                                        (shen/shen.<-out
                                                                         W1728)
                                                                        (shen/let
                                                                         W1730
                                                                         (shen/shen.in->
                                                                          W1728)
                                                                         (shen/shen.comb
                                                                          W1730
                                                                          (append
                                                                           (list
                                                                            W1726)
                                                                           W1729))))))))))
            (shen/if (shen/shen.parse-failure? W1724)
                     (shen/let W1731
                               (shen/let W1732 (shen/<e> V1723)
                                         (shen/if
                                          (shen/shen.parse-failure? W1732)
                                          (shen/shen.parse-failure)
                                          (shen/let W1733 (shen/shen.in-> W1732)
                                                    (shen/shen.comb W1733 nil))))
                               (shen/if (shen/shen.parse-failure? W1731)
                                        (shen/shen.parse-failure) W1731))
                     W1724)))
(defun shen/shen.<literal> (V1734)
  (shen/let W1735
            (shen/if (shen/shen.hds=? V1734 '!)
                     (shen/let W1736 (shen/tail V1734) (shen/shen.comb W1736 '!))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W1735)
                     (shen/let W1737
                               (shen/if (shen/shen.ccons? V1734)
                                        (shen/let W1738 (shen/head V1734)
                                                  (shen/let W1739
                                                            (shen/tail V1734)
                                                            (shen/let W1740
                                                                      (shen/shen.<bterms>
                                                                       W1738)
                                                                      (shen/if
                                                                       (shen/shen.parse-failure?
                                                                        W1740)
                                                                       (shen/shen.parse-failure)
                                                                       (shen/let
                                                                        W1741
                                                                        (shen/shen.<-out
                                                                         W1740)
                                                                        (shen/let
                                                                         W1742
                                                                         (shen/shen.in->
                                                                          W1740)
                                                                         (shen/let
                                                                          W1743
                                                                          (shen/<end>
                                                                           W1742)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W1743)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W1744
                                                                            (shen/shen.in->
                                                                             W1743)
                                                                            (shen/shen.comb
                                                                             W1739
                                                                             W1741))))))))))
                                        (shen/shen.parse-failure))
                               (shen/if (shen/shen.parse-failure? W1737)
                                        (shen/shen.parse-failure) W1737))
                     W1735)))
(defun shen/shen.<bterms> (V1745)
  (shen/let W1746
            (shen/let W1747 (shen/shen.<bterm> V1745)
                      (shen/if (shen/shen.parse-failure? W1747)
                               (shen/shen.parse-failure)
                               (shen/let W1748 (shen/shen.<-out W1747)
                                         (shen/let W1749 (shen/shen.in-> W1747)
                                                   (shen/let W1750
                                                             (shen/shen.<bterms>
                                                              W1749)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W1750)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W1751
                                                                        (shen/shen.<-out
                                                                         W1750)
                                                                        (shen/let
                                                                         W1752
                                                                         (shen/shen.in->
                                                                          W1750)
                                                                         (shen/shen.comb
                                                                          W1752
                                                                          (append
                                                                           (list
                                                                            W1748)
                                                                           W1751))))))))))
            (shen/if (shen/shen.parse-failure? W1746)
                     (shen/let W1753
                               (shen/let W1754 (shen/<e> V1745)
                                         (shen/if
                                          (shen/shen.parse-failure? W1754)
                                          (shen/shen.parse-failure)
                                          (shen/let W1755 (shen/shen.in-> W1754)
                                                    (shen/shen.comb W1755 nil))))
                               (shen/if (shen/shen.parse-failure? W1753)
                                        (shen/shen.parse-failure) W1753))
                     W1746)))
(defun shen/shen.<bterm> (V1756)
  (shen/let W1757
            (shen/let W1758 (shen/shen.<wildcard> V1756)
                      (shen/if (shen/shen.parse-failure? W1758)
                               (shen/shen.parse-failure)
                               (shen/let W1759 (shen/shen.<-out W1758)
                                         (shen/let W1760 (shen/shen.in-> W1758)
                                                   (shen/shen.comb W1760 W1759)))))
            (shen/if (shen/shen.parse-failure? W1757)
                     (shen/let W1761
                               (shen/if (shen/cons? V1756)
                                        (shen/let W1762 (shen/head V1756)
                                                  (shen/let W1763
                                                            (shen/tail V1756)
                                                            (shen/if
                                                             (shen/atom? W1762)
                                                             (shen/shen.comb
                                                              W1763 W1762)
                                                             (shen/shen.parse-failure))))
                                        (shen/shen.parse-failure))
                               (shen/if (shen/shen.parse-failure? W1761)
                                        (shen/let W1764
                                                  (shen/if
                                                   (shen/shen.ccons? V1756)
                                                   (shen/let W1765
                                                             (shen/head V1756)
                                                             (shen/let W1766
                                                                       (shen/tail
                                                                        V1756)
                                                                       (shen/let
                                                                        W1767
                                                                        (shen/shen.<bterms>
                                                                         W1765)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W1767)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W1768
                                                                          (shen/shen.<-out
                                                                           W1767)
                                                                          (shen/let
                                                                           W1769
                                                                           (shen/shen.in->
                                                                            W1767)
                                                                           (shen/let
                                                                            W1770
                                                                            (shen/<end>
                                                                             W1769)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W1770)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W1771
                                                                              (shen/shen.in->
                                                                               W1770)
                                                                              (shen/shen.comb
                                                                               W1766
                                                                               W1768))))))))))
                                                   (shen/shen.parse-failure))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W1764)
                                                   (shen/shen.parse-failure)
                                                   W1764))
                                        W1761))
                     W1757)))
(defun shen/shen.<wildcard> (V1772)
  (shen/let W1773
            (shen/if (shen/cons? V1772)
                     (shen/let W1774 (shen/head V1772)
                               (shen/let W1775 (shen/tail V1772)
                                         (shen/if (shen/= W1774 '_)
                                                  (shen/shen.comb W1775
                                                                  (shen/gensym
                                                                   'Y))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W1773) (shen/shen.parse-failure)
                     W1773)))
(defun shen/shen.<sc> (V1776)
  (shen/let W1777
            (shen/if (shen/cons? V1776)
                     (shen/let W1778 (shen/head V1776)
                               (shen/let W1779 (shen/tail V1776)
                                         (shen/if (shen/shen.semicolon? W1778)
                                                  (shen/shen.comb W1779 W1778)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W1777) (shen/shen.parse-failure)
                     W1777)))
(defun shen/shen.semicolon? (V1780) (shen/= V1780 (shen/intern ";")))
(defun shen/shen.horn-clause-procedure (V1781 V1782)
  (shen/let W1783 (shen/gensym 'B)
            (shen/let W1784 (shen/gensym 'L)
                      (shen/let W1785 (shen/gensym 'K)
                                (shen/let W1786 (shen/gensym 'C)
                                          (shen/let W1787
                                                    (shen/shen.prolog-parameters
                                                     V1782)
                                                    (shen/let W1788
                                                              (shen/shen.hascut?
                                                               V1782)
                                                              (shen/let W1789
                                                                        (shen/shen.prolog-fbody
                                                                         V1782
                                                                         W1787
                                                                         W1783
                                                                         W1784
                                                                         W1785
                                                                         W1786
                                                                         W1788)
                                                                        (shen/let
                                                                         W1790
                                                                         (shen/if
                                                                          W1788
                                                                          (list
                                                                           'let
                                                                           W1785
                                                                           (list
                                                                            '+
                                                                            W1785
                                                                            1)
                                                                           W1789)
                                                                          W1789)
                                                                         (shen/let
                                                                          W1791
                                                                          (append
                                                                           (list
                                                                            'define
                                                                            V1781)
                                                                           (shen/append
                                                                            W1787
                                                                            (shen/append
                                                                             (list
                                                                              W1783
                                                                              W1784
                                                                              W1785
                                                                              W1786
                                                                              '->)
                                                                             (list
                                                                              W1790))))
                                                                          W1791))))))))))
(defun shen/shen.hascut? (V1794)
  (shen/cond ((shen/= '! V1794) 'true)
             ((shen/cons? V1794)
              (shen/or (shen/shen.hascut? (shen/hd V1794))
                       (shen/shen.hascut? (nthcdr 1 V1794))))
             (shen/true 'false)))
(defun shen/shen.prolog-parameters (V1799)
  (shen/cond
   ((shen/and (shen/cons? V1799) (shen/cons? (shen/hd V1799)))
    (shen/shen.parameters (shen/length (shen/hd (shen/hd V1799)))))
   (shen/true (shen/shen.f-error 'shen.prolog-parameters))))
(defun shen/shen.prolog-fbody (V1820 V1821 V1822 V1823 V1824 V1825 V1826)
  (shen/cond
   ((shen/and (shen/internal/predicate->shen (null V1820)) (shen/= 'true V1826))
    (list 'shen.unlock V1823 V1824))
   ((shen/and (shen/cons? V1820)
              (shen/and (shen/cons? (shen/hd V1820))
                        (shen/and (shen/cons? (nthcdr 1 (shen/hd V1820)))
                                  (shen/and
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 (shen/hd V1820))))
                                   (shen/and
                                    (shen/internal/predicate->shen
                                     (null (nthcdr 1 V1820)))
                                    (shen/= 'false V1826))))))
    (shen/let W1827
              (shen/shen.continue (shen/hd (shen/hd V1820))
                                  (shen/hd (nthcdr 1 (shen/hd V1820))) V1822
                                  V1823 V1824 V1825)
              (list 'if (list 'shen.unlocked? V1823)
                    (shen/shen.compile-head 'shen.+m (shen/hd (shen/hd V1820))
                                            V1821 V1822 W1827)
                    'false)))
   ((shen/and (shen/cons? V1820)
              (shen/and (shen/cons? (shen/hd V1820))
                        (shen/and (shen/cons? (nthcdr 1 (shen/hd V1820)))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 (shen/hd V1820)))))))
    (shen/let W1828 (shen/gensym 'C)
              (shen/let W1829
                        (shen/shen.continue (shen/hd (shen/hd V1820))
                                            (shen/hd (nthcdr 1 (shen/hd V1820)))
                                            V1822 V1823 V1824 V1825)
                        (list 'let W1828
                              (list 'if (list 'shen.unlocked? V1823)
                                    (shen/shen.compile-head 'shen.+m
                                                            (shen/hd
                                                             (shen/hd V1820))
                                                            V1821 V1822 W1829)
                                    'false)
                              (list 'if (list '= W1828 'false)
                                    (shen/shen.prolog-fbody (nthcdr 1 V1820)
                                                            V1821 V1822 V1823
                                                            V1824 V1825 V1826)
                                    W1828)))))
   (shen/true (shen/simple-error "implementation error in shen.prolog-fbody"))))
(defun shen/shen.unlock (V1830 V1831)
  (shen/if (shen/and (shen/shen.locked? V1830) (shen/shen.fits? V1831 V1830))
           (shen/shen.openlock V1830) 'false))
(defun shen/shen.locked? (V1832) (shen/not (shen/shen.unlocked? V1832)))
(defun shen/shen.unlocked? (V1833) (shen/<-address V1833 1))
(defun shen/shen.openlock (V1834)
  (shen/do (shen/address-> V1834 1 'true) 'false))
(defun shen/shen.fits? (V1835 V1836) (shen/= V1835 (shen/<-address V1836 2)))
(defun shen/shen.cut (V1839 V1840 V1841 V1842)
  (shen/let W1843 (shen/thaw V1842)
            (shen/if
             (shen/and (shen/= W1843 'false) (shen/shen.unlocked? V1840))
             (shen/shen.lock V1841 V1840) W1843)))
(defun shen/shen.lock (V1844 V1845)
  (shen/let W1846 (shen/address-> V1845 1 'false)
            (shen/let W1847 (shen/address-> V1845 2 V1844) 'false)))
(defun shen/shen.continue (V1848 V1849 V1850 V1851 V1852 V1853)
  (shen/let W1854 (shen/shen.extract-vars V1848)
            (shen/let W1855 (shen/shen.extract-free-vars V1849)
                      (shen/let W1856 (shen/difference W1855 W1854)
                                (shen/let W1857
                                          (list 'do (list 'shen.incinfs)
                                                (shen/shen.compile-body V1849
                                                                        V1850
                                                                        V1851
                                                                        V1852
                                                                        V1853))
                                          (shen/shen.stpart W1856 W1857 V1850))))))
(defun shen/shen.extract-free-vars (V1860)
  (shen/cond
   ((shen/and (shen/cons? V1860)
              (shen/and (shen/= 'lambda (shen/hd V1860))
                        (shen/and (shen/cons? (nthcdr 1 V1860))
                                  (shen/and (shen/cons? (nthcdr 2 V1860))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V1860)))))))
    (shen/remove (shen/hd (nthcdr 1 V1860))
                 (shen/shen.extract-free-vars (shen/hd (nthcdr 2 V1860)))))
   ((shen/cons? V1860)
    (shen/union (shen/shen.extract-free-vars (shen/hd V1860))
                (shen/shen.extract-free-vars (nthcdr 1 V1860))))
   ((shen/variable? V1860) (list V1860)) (shen/true nil)))
(defun shen/shen.compile-body (V1877 V1878 V1879 V1880 V1881)
  (cl-flet
      ((tail-trampoline (V1877 V1878 V1879 V1880 V1881)
         (shen/cond
          ((shen/internal/predicate->shen (null V1877)) (list 'thaw V1881))
          ((shen/and (shen/cons? V1877) (shen/= '! (shen/hd V1877)))
           (vector
            (list (append (list (list 'shen.cut)) (nthcdr 1 V1877)) V1878 V1879
                  V1880 V1881)))
          ((shen/and (shen/cons? V1877)
                     (shen/internal/predicate->shen (null (nthcdr 1 V1877))))
           (shen/append (shen/shen.deref-calls (shen/hd V1877) V1878)
                        (list V1878 V1879 V1880 V1881)))
          ((shen/cons? V1877)
           (shen/let W1882 (shen/shen.deref-calls (shen/hd V1877) V1878)
                     (shen/append W1882
                                  (list V1878 V1879 V1880
                                        (shen/shen.freeze-literals
                                         (nthcdr 1 V1877) V1878 V1879 V1880
                                         V1881)))))
          (shen/true
           (shen/simple-error "implementation error in shen.compile-fbody")))))
    (let ((result (funcall #'tail-trampoline V1877 V1878 V1879 V1880 V1881)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.freeze-literals (V1899 V1900 V1901 V1902 V1903)
  (cl-flet
      ((tail-trampoline (V1899 V1900 V1901 V1902 V1903)
         (shen/cond ((shen/internal/predicate->shen (null V1899)) V1903)
                    ((shen/and (shen/cons? V1899) (shen/= '! (shen/hd V1899)))
                     (vector
                      (list (append (list (list 'shen.cut)) (nthcdr 1 V1899))
                            V1900 V1901 V1902 V1903)))
                    ((shen/cons? V1899)
                     (shen/let W1904
                               (shen/shen.deref-calls (shen/hd V1899) V1900)
                               (list 'freeze
                                     (shen/append W1904
                                                  (list V1900 V1901 V1902
                                                        (shen/shen.freeze-literals
                                                         (nthcdr 1 V1899) V1900
                                                         V1901 V1902 V1903))))))
                    (shen/true
                     (shen/simple-error
                      "implementation error in shen.freeze-literals")))))
    (let ((result (funcall #'tail-trampoline V1899 V1900 V1901 V1902 V1903)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.deref-calls (V1909 V1910)
  (shen/cond
   ((shen/and (shen/cons? V1909) (shen/= 'fork (shen/hd V1909)))
    (list 'fork (shen/shen.deref-forked-literals (nthcdr 1 V1909) V1910)))
   ((shen/cons? V1909)
    (append (list (shen/hd V1909))
            (shen/map (shen/lambda Z1911 (shen/shen.function-calls Z1911 V1910))
                      (nthcdr 1 V1909))))
   (shen/true (shen/simple-error "implementation error in shen.deref-calls"))))
(defun shen/shen.deref-forked-literals (V1918 V1919)
  (shen/cond ((shen/internal/predicate->shen (null V1918)) nil)
             ((shen/cons? V1918)
              (list 'cons (shen/shen.deref-calls (shen/hd V1918) V1919)
                    (shen/shen.deref-forked-literals (nthcdr 1 V1918) V1919)))
             (shen/true (shen/simple-error "fork requires a list of literals\n"))))
(defun shen/shen.function-calls (V1922 V1923)
  (shen/cond
   ((shen/and (shen/cons? V1922)
              (shen/and (shen/= 'cons (shen/hd V1922))
                        (shen/and (shen/cons? (nthcdr 1 V1922))
                                  (shen/and (shen/cons? (nthcdr 2 V1922))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V1922)))))))
    (list 'cons (shen/shen.function-calls (shen/hd (nthcdr 1 V1922)) V1923)
          (shen/shen.function-calls (shen/hd (nthcdr 2 V1922)) V1923)))
   ((shen/cons? V1922) (shen/shen.deref-terms V1922 V1923 nil))
   (shen/true V1922)))
(defun shen/shen.deref-terms (V1932 V1933 V1934)
  (shen/cond
   ((shen/and (shen/cons? V1932)
              (shen/and (shen/= 0 (shen/hd V1932))
                        (shen/and (shen/cons? (nthcdr 1 V1932))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V1932))))))
    (shen/if (shen/variable? (shen/hd (nthcdr 1 V1932)))
             (shen/hd (nthcdr 1 V1932))
             (shen/simple-error
              (shen/cn "attempt to optimise a non-variable "
                       (shen/shen.app (shen/hd (nthcdr 1 V1932)) "\n" 'shen.s)))))
   ((shen/and (shen/cons? V1932)
              (shen/and (shen/= 1 (shen/hd V1932))
                        (shen/and (shen/cons? (nthcdr 1 V1932))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V1932))))))
    (shen/if (shen/variable? (shen/hd (nthcdr 1 V1932)))
             (list 'shen.lazyderef (shen/hd (nthcdr 1 V1932)) V1933)
             (shen/simple-error
              (shen/cn "attempt to optimise a non-variable "
                       (shen/shen.app (shen/hd (nthcdr 1 V1932)) "\n" 'shen.s)))))
   ((shen/and (shen/not (shen/element? V1932 V1934)) (shen/variable? V1932))
    (list 'shen.deref V1932 V1933))
   ((shen/and (shen/cons? V1932)
              (shen/and (shen/= 'lambda (shen/hd V1932))
                        (shen/and (shen/cons? (nthcdr 1 V1932))
                                  (shen/and (shen/cons? (nthcdr 2 V1932))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V1932)))))))
    (list 'lambda (shen/hd (nthcdr 1 V1932))
          (shen/shen.deref-terms (shen/hd (nthcdr 2 V1932)) V1933
                                 (append (list (shen/hd (nthcdr 1 V1932))) V1934))))
   ((shen/cons? V1932)
    (shen/map (shen/lambda Z1935 (shen/shen.deref-terms Z1935 V1933 V1934))
              V1932))
   (shen/true V1932)))
(defun shen/shen.compile-head (V1953 V1954 V1955 V1956 V1957)
  (cl-flet
      ((tail-trampoline (V1953 V1954 V1955 V1956 V1957)
         (shen/cond
          ((shen/and (shen/internal/predicate->shen (null V1954))
                     (shen/internal/predicate->shen (null V1955)))
           V1957)
          ((shen/and (shen/cons? V1954)
                     (shen/and (shen/cons? (shen/hd V1954))
                               (shen/and
                                (shen/= 'shen.+m (shen/hd (shen/hd V1954)))
                                (shen/and
                                 (shen/cons? (nthcdr 1 (shen/hd V1954)))
                                 (shen/internal/predicate->shen
                                  (null (nthcdr 2 (shen/hd V1954))))))))
           (vector
            (list V1953
                  (append
                   (list 'shen.+m (shen/hd (nthcdr 1 (shen/hd V1954))) V1953)
                   (nthcdr 1 V1954))
                  V1955 V1956 V1957)))
          ((shen/and (shen/cons? V1954)
                     (shen/and (shen/cons? (shen/hd V1954))
                               (shen/and
                                (shen/= 'shen.-m (shen/hd (shen/hd V1954)))
                                (shen/and
                                 (shen/cons? (nthcdr 1 (shen/hd V1954)))
                                 (shen/internal/predicate->shen
                                  (null (nthcdr 2 (shen/hd V1954))))))))
           (vector
            (list V1953
                  (append
                   (list 'shen.-m (shen/hd (nthcdr 1 (shen/hd V1954))) V1953)
                   (nthcdr 1 V1954))
                  V1955 V1956 V1957)))
          ((shen/and (shen/cons? V1954) (shen/= 'shen.-m (shen/hd V1954)))
           (vector (list 'shen.-m (nthcdr 1 V1954) V1955 V1956 V1957)))
          ((shen/and (shen/cons? V1954) (shen/= 'shen.+m (shen/hd V1954)))
           (vector (list 'shen.+m (nthcdr 1 V1954) V1955 V1956 V1957)))
          ((shen/and (shen/cons? V1954)
                     (shen/and (shen/cons? V1955)
                               (shen/shen.wildcard? (shen/hd V1954))))
           (vector (list V1953 (nthcdr 1 V1954) (nthcdr 1 V1955) V1956 V1957)))
          ((shen/and (shen/cons? V1954) (shen/variable? (shen/hd V1954)))
           (shen/shen.variable-case V1953 V1954 V1955 V1956 V1957))
          ((shen/and (shen/= 'shen.-m V1953)
                     (shen/and (shen/cons? V1954) (shen/atom? (shen/hd V1954))))
           (shen/shen.atom-case-minus V1954 V1955 V1956 V1957))
          ((shen/and (shen/= 'shen.-m V1953)
                     (shen/and (shen/cons? V1954)
                               (shen/and (shen/cons? (shen/hd V1954))
                                         (shen/and
                                          (shen/= 'cons
                                                  (shen/hd (shen/hd V1954)))
                                          (shen/and
                                           (shen/cons?
                                            (nthcdr 1 (shen/hd V1954)))
                                           (shen/and
                                            (shen/cons?
                                             (nthcdr 2 (shen/hd V1954)))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 (shen/hd V1954))))))))))
           (shen/shen.cons-case-minus V1954 V1955 V1956 V1957))
          ((shen/and (shen/= 'shen.+m V1953)
                     (shen/and (shen/cons? V1954) (shen/atom? (shen/hd V1954))))
           (shen/shen.atom-case-plus V1954 V1955 V1956 V1957))
          ((shen/and (shen/= 'shen.+m V1953)
                     (shen/and (shen/cons? V1954)
                               (shen/and (shen/cons? (shen/hd V1954))
                                         (shen/and
                                          (shen/= 'cons
                                                  (shen/hd (shen/hd V1954)))
                                          (shen/and
                                           (shen/cons?
                                            (nthcdr 1 (shen/hd V1954)))
                                           (shen/and
                                            (shen/cons?
                                             (nthcdr 2 (shen/hd V1954)))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 (shen/hd V1954))))))))))
           (shen/shen.cons-case-plus V1954 V1955 V1956 V1957))
          (shen/true
           (shen/simple-error "implementation error in shen.compile-head")))))
    (let ((result (funcall #'tail-trampoline V1953 V1954 V1955 V1956 V1957)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.variable-case (V1968 V1969 V1970 V1971 V1972)
  (shen/cond
   ((shen/and (shen/cons? V1969) (shen/cons? V1970))
    (shen/if (shen/variable? (shen/hd V1970))
             (shen/shen.compile-head V1968 (nthcdr 1 V1969) (nthcdr 1 V1970)
                                     V1971
                                     (shen/subst (shen/hd V1970) (shen/hd V1969)
                                                 V1972))
             (list 'let (shen/hd V1969) (shen/hd V1970)
                   (shen/shen.compile-head V1968 (nthcdr 1 V1969)
                                           (nthcdr 1 V1970) V1971 V1972))))
   (shen/true (shen/simple-error "implementation error in shen.variable-case"))))
(defun shen/shen.atom-case-minus (V1981 V1982 V1983 V1984)
  (shen/cond
   ((shen/and (shen/cons? V1981) (shen/cons? V1982))
    (shen/let W1985 (shen/gensym 'Tm)
              (list 'let W1985 (list 'shen.lazyderef (shen/hd V1982) V1983)
                    (list 'if (list '= W1985 (shen/hd V1981))
                          (shen/shen.compile-head 'shen.-m (nthcdr 1 V1981)
                                                  (nthcdr 1 V1982) V1983 V1984)
                          'false))))
   (shen/true (shen/simple-error "implementation error in shen.atom-case-minus"))))
(defun shen/shen.cons-case-minus (V1994 V1995 V1996 V1997)
  (shen/cond
   ((shen/and (shen/cons? V1994)
              (shen/and (shen/cons? (shen/hd V1994))
                        (shen/and (shen/= 'cons (shen/hd (shen/hd V1994)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V1994)))
                                   (shen/and
                                    (shen/cons? (nthcdr 2 (shen/hd V1994)))
                                    (shen/and
                                     (shen/internal/predicate->shen
                                      (null (nthcdr 3 (shen/hd V1994))))
                                     (shen/cons? V1995)))))))
    (shen/let W1998 (shen/gensym 'Tm)
              (list 'let W1998 (list 'shen.lazyderef (shen/hd V1995) V1996)
                    (list 'if (list 'cons? W1998)
                          (shen/shen.compile-head 'shen.-m
                                                  (append
                                                   (list
                                                    (shen/hd
                                                     (nthcdr 1 (shen/hd V1994)))
                                                    (shen/hd
                                                     (nthcdr 2 (shen/hd V1994))))
                                                   (nthcdr 1 V1994))
                                                  (append
                                                   (list (list 'hd W1998)
                                                         (list 'tl W1998))
                                                   (nthcdr 1 V1995))
                                                  V1996 V1997)
                          'false))))
   (shen/true (shen/simple-error "implementation error in shen.cons-case-minus"))))
(defun shen/shen.atom-case-plus (V2007 V2008 V2009 V2010)
  (shen/cond
   ((shen/and (shen/cons? V2007) (shen/cons? V2008))
    (shen/let W2011 (shen/gensym 'Tm)
              (shen/let W2012 (shen/gensym 'GoTo)
                        (list 'let W2011
                              (list 'shen.lazyderef (shen/hd V2008) V2009) W2012
                              (list 'freeze
                                    (shen/shen.compile-head 'shen.+m
                                                            (nthcdr 1 V2007)
                                                            (nthcdr 1 V2008)
                                                            V2009 V2010))
                              (list 'if (list '= W2011 (shen/hd V2007))
                                    (list 'thaw W2012)
                                    (list 'if (list 'shen.pvar? W2011)
                                          (list 'shen.bind! W2011
                                                (shen/shen.demode
                                                 (shen/hd V2007))
                                                V2009 W2012)
                                          'false))))))
   (shen/true (shen/simple-error "implementation error in shen.atom-case-plus"))))
(defun shen/shen.cons-case-plus (V2021 V2022 V2023 V2024)
  (shen/cond
   ((shen/and (shen/cons? V2021)
              (shen/and (shen/cons? (shen/hd V2021))
                        (shen/and (shen/= 'cons (shen/hd (shen/hd V2021)))
                                  (shen/and
                                   (shen/cons? (nthcdr 1 (shen/hd V2021)))
                                   (shen/and
                                    (shen/cons? (nthcdr 2 (shen/hd V2021)))
                                    (shen/and
                                     (shen/internal/predicate->shen
                                      (null (nthcdr 3 (shen/hd V2021))))
                                     (shen/cons? V2022)))))))
    (shen/let W2025 (shen/gensym 'Tm)
              (shen/let W2026 (shen/gensym 'GoTo)
                        (shen/let W2027
                                  (shen/shen.extract-vars
                                   (append
                                    (list (shen/hd (nthcdr 1 (shen/hd V2021))))
                                    (shen/hd (nthcdr 2 (shen/hd V2021)))))
                                  (shen/let W2028
                                            (shen/shen.tame (shen/hd V2021))
                                            (shen/let W2029
                                                      (shen/shen.extract-vars
                                                       W2028)
                                                      (list 'let W2025
                                                            (list
                                                             'shen.lazyderef
                                                             (shen/hd V2022)
                                                             V2023)
                                                            W2026
                                                            (shen/shen.goto
                                                             W2027
                                                             (shen/shen.compile-head
                                                              'shen.+m
                                                              (nthcdr 1 V2021)
                                                              (nthcdr 1 V2022)
                                                              V2023 V2024))
                                                            (list 'if
                                                                  (list 'cons?
                                                                        W2025)
                                                                  (shen/shen.compile-head
                                                                   'shen.+m
                                                                   (nthcdr 1
                                                                           (shen/hd
                                                                            V2021))
                                                                   (list
                                                                    (list 'hd
                                                                          W2025)
                                                                    (list 'tl
                                                                          W2025))
                                                                   V2023
                                                                   (shen/shen.invoke
                                                                    W2026 W2027))
                                                                  (list 'if
                                                                        (list
                                                                         'shen.pvar?
                                                                         W2025)
                                                                        (shen/shen.stpart
                                                                         W2029
                                                                         (list
                                                                          'shen.bind!
                                                                          W2025
                                                                          (shen/shen.demode
                                                                           W2028)
                                                                          V2023
                                                                          (list
                                                                           'freeze
                                                                           (shen/shen.invoke
                                                                            W2026
                                                                            W2027)))
                                                                         V2023)
                                                                        'false)))))))))
   (shen/true (shen/simple-error "implementation error in shen.cons-case-plus"))))
(defun shen/shen.demode (V2030)
  (cl-flet
      ((tail-trampoline (V2030)
         (shen/cond
          ((shen/and (shen/cons? V2030)
                     (shen/and (shen/= 'shen.+m (shen/hd V2030))
                               (shen/and (shen/cons? (nthcdr 1 V2030))
                                         (shen/internal/predicate->shen
                                          (null (nthcdr 2 V2030))))))
           (vector (list (shen/hd (nthcdr 1 V2030)))))
          ((shen/and (shen/cons? V2030)
                     (shen/and (shen/= 'shen.-m (shen/hd V2030))
                               (shen/and (shen/cons? (nthcdr 1 V2030))
                                         (shen/internal/predicate->shen
                                          (null (nthcdr 2 V2030))))))
           (vector (list (shen/hd (nthcdr 1 V2030)))))
          ((shen/cons? V2030)
           (shen/map (shen/lambda Z2031 (shen/shen.demode Z2031)) V2030))
          (shen/true V2030))))
    (let ((result (funcall #'tail-trampoline V2030)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.tame (V2032)
  (shen/cond ((shen/shen.wildcard? V2032) (shen/gensym 'Y))
             ((shen/cons? V2032)
              (shen/map (shen/lambda Z2033 (shen/shen.tame Z2033)) V2032))
             (shen/true V2032)))
(defun shen/shen.goto (V2034 V2035)
  (shen/cond ((shen/internal/predicate->shen (null V2034)) (list 'freeze V2035))
             (shen/true (shen/shen.goto-h V2034 V2035))))
(defun shen/shen.goto-h (V2036 V2037)
  (shen/cond ((shen/internal/predicate->shen (null V2036)) V2037)
             ((shen/cons? V2036)
              (list 'lambda (shen/hd V2036)
                    (shen/shen.goto-h (nthcdr 1 V2036) V2037)))
             (shen/true (shen/shen.f-error 'shen.goto-h))))
(defun shen/shen.invoke (V2038 V2039)
  (shen/cond ((shen/internal/predicate->shen (null V2039)) (list 'thaw V2038))
             (shen/true (append (list V2038) V2039))))
(defun shen/shen.wildcard? (V2040) (shen/= V2040 '_))
(defun shen/shen.pvar? (V2041)
  (shen/and (shen/absvector? V2041)
            (shen/=
             (shen/trap-error (shen/<-address V2041 0)
                              (shen/lambda Z2042 'shen.not-pvar))
             'shen.pvar)))
(defun shen/shen.lazyderef (X ProcessN)
  (let ((Current X) (KeepLooking t))
    (while KeepLooking
      (shen/if (shen/shen.pvar? Current)
               (shen/let Value (shen/shen.valvector Current ProcessN)
                         (shen/if (shen/= Value 'shen.-null-)
                                  (setq KeepLooking nil) (setq Current Value)))
               (setq KeepLooking nil)))
    Current))
(defun shen/shen.deref (V2046 V2047)
  (cl-flet
      ((tail-trampoline (V2046 V2047)
         (shen/cond
          ((shen/cons? V2046)
           (append (list (shen/shen.deref (shen/hd V2046) V2047))
                   (shen/shen.deref (nthcdr 1 V2046) V2047)))
          (shen/true
           (shen/if (shen/shen.pvar? V2046)
                    (shen/let W2048
                              (shen/<-address V2047 (shen/<-address V2046 1))
                              (shen/if (shen/= W2048 'shen.-null-) V2046
                                       (vector (list W2048 V2047))))
                    V2046)))))
    (let ((result (funcall #'tail-trampoline V2046 V2047)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.bind! (V2049 V2050 V2051 V2052)
  (shen/let W2053 (shen/shen.bindv V2049 V2050 V2051)
            (shen/let W2054 (shen/thaw V2052)
                      (shen/if (shen/= W2054 'false)
                               (shen/shen.unwind V2049 V2051 W2054) W2054))))
(defun shen/shen.bindv (V2055 V2056 V2057)
  (shen/address-> V2057 (shen/<-address V2055 1) V2056))
(defun shen/shen.unwind (V2058 V2059 V2060)
  (shen/do (shen/address-> V2059 (shen/<-address V2058 1) 'shen.-null-) V2060))
(defun shen/shen.stpart (V2069 V2070 V2071)
  (shen/cond ((shen/internal/predicate->shen (null V2069)) V2070)
             ((shen/cons? V2069)
              (list 'let (shen/hd V2069) (list 'shen.newpv V2071)
                    (list 'shen.gc V2071
                          (shen/shen.stpart (nthcdr 1 V2069) V2070 V2071))))
             (shen/true
              (shen/simple-error "implementation error in shen.stpart"))))
(defun shen/shen.gc (V2072 V2073)
  (shen/if (shen/= V2073 'false)
           (shen/let W2074 (shen/shen.ticket-number V2072)
                     (shen/do (shen/shen.decrement-ticket W2074 V2072) V2073))
           V2073))
(defun shen/shen.decrement-ticket (V2075 V2076)
  (shen/address-> V2076 1 (shen/- V2075 1)))
(defun shen/shen.newpv (V2077)
  (shen/let W2078 (shen/shen.ticket-number V2077)
            (shen/let W2079 (shen/shen.make-prolog-variable W2078)
                      (shen/let W2080 (shen/shen.nextticket V2077 W2078) W2079))))
(defun shen/shen.ticket-number (V2081) (shen/<-address V2081 1))
(defun shen/shen.nextticket (V2082 V2083)
  (shen/let W2084 (shen/address-> V2082 V2083 'shen.-null-)
            (shen/address-> W2084 1 (1+ V2083))))
(defun shen/shen.make-prolog-variable (V2085)
  (shen/address-> (shen/address-> (shen/absvector 2) 0 'shen.pvar) 1 V2085))
(defun shen/shen.pvar (V2086)
  (shen/cn "Var" (shen/shen.app (shen/<-address V2086 1) "" 'shen.a)))
(defun shen/shen.incinfs nil
  (shen/set 'shen.*infs* (1+ (shen/value 'shen.*infs*))))
(defun shen/shen.prolog-vector-size (V2087)
  (shen/if (shen/and (shen/integer? V2087) (shen/> V2087 0))
           (shen/set 'shen.*size-prolog-vector* V2087)
           (shen/simple-error
            (shen/cn
             "prolog vector size: size should be a positive integer; not "
             (shen/shen.app V2087 "" 'shen.a)))))
(defun shen/shen.lzy=! (V2099 V2100 V2101 V2102)
  (cl-flet
      ((tail-trampoline (V2099 V2100 V2101 V2102)
         (shen/cond ((shen/= V2099 V2100) (shen/thaw V2102))
                    ((shen/and (shen/shen.pvar? V2099)
                               (shen/not
                                (shen/shen.occurs? V2099
                                                   (shen/shen.deref V2100 V2101))))
                     (shen/shen.bind! V2099 V2100 V2101 V2102))
                    ((shen/and (shen/shen.pvar? V2100)
                               (shen/not
                                (shen/shen.occurs? V2100
                                                   (shen/shen.deref V2099 V2101))))
                     (shen/shen.bind! V2100 V2099 V2101 V2102))
                    ((shen/and (shen/cons? V2099) (shen/cons? V2100))
                     (vector
                      (list (shen/shen.lazyderef (shen/hd V2099) V2101)
                            (shen/shen.lazyderef (shen/hd V2100) V2101) V2101
                            (shen/freeze
                             (shen/shen.lzy=!
                              (shen/shen.lazyderef (nthcdr 1 V2099) V2101)
                              (shen/shen.lazyderef (nthcdr 1 V2100) V2101) V2101
                              V2102)))))
                    (shen/true 'false))))
    (let ((result (funcall #'tail-trampoline V2099 V2100 V2101 V2102)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.lzy= (V2114 V2115 V2116 V2117)
  (cl-flet
      ((tail-trampoline (V2114 V2115 V2116 V2117)
         (shen/cond ((shen/= V2114 V2115) (shen/thaw V2117))
                    ((shen/shen.pvar? V2114)
                     (shen/shen.bind! V2114 V2115 V2116 V2117))
                    ((shen/shen.pvar? V2115)
                     (shen/shen.bind! V2115 V2114 V2116 V2117))
                    ((shen/and (shen/cons? V2114) (shen/cons? V2115))
                     (vector
                      (list (shen/shen.lazyderef (shen/hd V2114) V2116)
                            (shen/shen.lazyderef (shen/hd V2115) V2116) V2116
                            (shen/freeze
                             (shen/shen.lzy=
                              (shen/shen.lazyderef (nthcdr 1 V2114) V2116)
                              (shen/shen.lazyderef (nthcdr 1 V2115) V2116) V2116
                              V2117)))))
                    (shen/true 'false))))
    (let ((result (funcall #'tail-trampoline V2114 V2115 V2116 V2117)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.occurs? (V2123 V2124)
  (shen/cond ((shen/= V2123 V2124) 'true)
             ((shen/cons? V2124)
              (shen/or (shen/shen.occurs? V2123 (shen/hd V2124))
                       (shen/shen.occurs? V2123 (nthcdr 1 V2124))))
             (shen/true 'false)))
(defun shen/call (V2125 V2126 V2127 V2128 V2129)
  (shen/internal/apply-function-expression
   (shen/internal/apply-function-expression
    (shen/internal/apply-function-expression
     (shen/internal/apply-higher-order-function V2125 (list V2126)) (list V2127))
    (list V2128))
   (list V2129)))
(defun shen/return (V2136 V2137 V2138 V2139 V2140)
  (shen/shen.deref V2136 V2137))
(defun shen/when (V2147 V2148 V2149 V2150 V2151)
  (shen/if V2147 (shen/thaw V2151) 'false))
(defun shen/is (V2152 V2153 V2154 V2155 V2156 V2157)
  (shen/shen.lzy= (shen/shen.lazyderef V2152 V2154)
                  (shen/shen.lazyderef V2153 V2154) V2154 V2157))
(defun shen/is! (V2158 V2159 V2160 V2161 V2162 V2163)
  (shen/shen.lzy=! (shen/shen.lazyderef V2158 V2160)
                   (shen/shen.lazyderef V2159 V2160) V2160 V2163))
(defun shen/bind (V2168 V2169 V2170 V2171 V2172 V2173)
  (shen/shen.bind! V2168 V2169 V2170 V2173))
(defun shen/var? (V2174 V2175 V2176 V2177 V2178)
  (shen/if (shen/shen.pvar? (shen/shen.lazyderef V2174 V2175)) (shen/thaw V2178)
           'false))
(defun shen/shen.print-prolog-vector (V2181) "|prolog vector|")
(defun shen/fork (V2200 V2201 V2202 V2203 V2204)
  (cl-flet
      ((tail-trampoline (V2200 V2201 V2202 V2203 V2204)
         (shen/cond ((shen/internal/predicate->shen (null V2200)) 'false)
                    ((shen/cons? V2200)
                     (shen/let W2205
                               (shen/internal/apply-function-expression
                                (shen/internal/apply-function-expression
                                 (shen/internal/apply-function-expression
                                  (shen/internal/apply-function-expression
                                   (shen/hd V2200) (list V2201))
                                  (list V2202))
                                 (list V2203))
                                (list V2204))
                               (shen/if (shen/= W2205 'false)
                                        (vector
                                         (list (nthcdr 1 V2200) V2201 V2202
                                               V2203 V2204))
                                        W2205)))
                    (shen/true
                     (shen/simple-error "fork expects a list of literals\n")))))
    (let ((result (funcall #'tail-trampoline V2200 V2201 V2202 V2203 V2204)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/findall (V2206 V2207 V2208 V2209 V2210 V2211 V2212)
  (shen/if (shen/shen.unlocked? V2210)
           (shen/let W2213 (shen/shen.newpv V2209)
                     (shen/shen.gc V2209
                                   (shen/do (shen/shen.incinfs)
                                            (shen/is W2213 nil V2209 V2210 V2211
                                                     (shen/freeze
                                                      (shen/shen.findall-h V2206
                                                                           V2207
                                                                           V2208
                                                                           W2213
                                                                           V2209
                                                                           V2210
                                                                           V2211
                                                                           V2212))))))
           'false))
(defun shen/shen.findall-h (V2214 V2215 V2216 V2217 V2218 V2219 V2220 V2221)
  (shen/let W2222
            (shen/if (shen/shen.unlocked? V2219)
                     (shen/do (shen/shen.incinfs)
                              (shen/call V2215 V2218 V2219 V2220
                                         (shen/freeze
                                          (shen/shen.overbind V2214 V2217 V2218
                                                              V2219 V2220 V2221))))
                     'false)
            (shen/if (shen/= W2222 'false)
                     (shen/if (shen/shen.unlocked? V2219)
                              (shen/do (shen/shen.incinfs)
                                       (shen/is! V2216 V2217 V2218 V2219 V2220
                                                 V2221))
                              'false)
                     W2222)))
(defun shen/shen.overbind (V2229 V2230 V2231 V2232 V2233 V2234)
  (shen/do
   (shen/shen.bindv V2230
                    (append (list (shen/shen.deref V2229 V2231))
                            (shen/shen.lazyderef V2230 V2231))
                    V2231)
   'false))
(defun shen/occurs-check (V2237)
  (shen/cond ((shen/= '+ V2237) (shen/set 'shen.*occurs* 'true))
             ((shen/= '- V2237) (shen/set 'shen.*occurs* 'false))
             (shen/true (shen/simple-error "occurs-check expects a + or a -.\n"))))
(defun shen/shen.<datatype> (V3341)
  (shen/let W3342
            (shen/if (shen/cons? V3341)
                     (shen/let W3343 (shen/head V3341)
                               (shen/let W3344 (shen/tail V3341)
                                         (shen/let W3345
                                                   (shen/shen.<datatype-rules>
                                                    W3344)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W3345)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W3346
                                                              (shen/shen.<-out
                                                               W3345)
                                                              (shen/let W3347
                                                                        (shen/shen.in->
                                                                         W3345)
                                                                        (shen/shen.comb
                                                                         W3347
                                                                         (shen/let
                                                                          W3348
                                                                          (shen/shen.rules->prolog
                                                                           W3343
                                                                           W3346)
                                                                          (shen/shen.remember-datatype
                                                                           W3343
                                                                           (shen/fn
                                                                            W3343))))))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3342) (shen/shen.parse-failure)
                     W3342)))
(defun shen/shen.<datatype-rules> (V3349)
  (shen/let W3350
            (shen/let W3351 (shen/shen.<datatype-rule> V3349)
                      (shen/if (shen/shen.parse-failure? W3351)
                               (shen/shen.parse-failure)
                               (shen/let W3352 (shen/shen.<-out W3351)
                                         (shen/let W3353 (shen/shen.in-> W3351)
                                                   (shen/let W3354
                                                             (shen/shen.<datatype-rules>
                                                              W3353)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3354)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3355
                                                                        (shen/shen.<-out
                                                                         W3354)
                                                                        (shen/let
                                                                         W3356
                                                                         (shen/shen.in->
                                                                          W3354)
                                                                         (shen/shen.comb
                                                                          W3356
                                                                          (shen/append
                                                                           W3352
                                                                           W3355))))))))))
            (shen/if (shen/shen.parse-failure? W3350)
                     (shen/let W3357
                               (shen/let W3358 (shen/<!> V3349)
                                         (shen/if
                                          (shen/shen.parse-failure? W3358)
                                          (shen/shen.parse-failure)
                                          (shen/let W3359
                                                    (shen/shen.<-out W3358)
                                                    (shen/let W3360
                                                              (shen/shen.in->
                                                               W3358)
                                                              (shen/shen.comb
                                                               W3360
                                                               (shen/if
                                                                (shen/empty?
                                                                 W3359)
                                                                nil
                                                                (shen/simple-error
                                                                 (shen/cn
                                                                  "datatype syntax error here:\n "
                                                                  (shen/shen.app
                                                                   W3359
                                                                   "\n ..."
                                                                   'shen.r)))))))))
                               (shen/if (shen/shen.parse-failure? W3357)
                                        (shen/shen.parse-failure) W3357))
                     W3350)))
(defun shen/shen.<datatype-rule> (V3361)
  (shen/let W3362
            (shen/let W3363 (shen/shen.<single> V3361)
                      (shen/if (shen/shen.parse-failure? W3363)
                               (shen/shen.parse-failure)
                               (shen/let W3364 (shen/shen.<-out W3363)
                                         (shen/let W3365 (shen/shen.in-> W3363)
                                                   (shen/shen.comb W3365 W3364)))))
            (shen/if (shen/shen.parse-failure? W3362)
                     (shen/let W3366
                               (shen/let W3367 (shen/shen.<double> V3361)
                                         (shen/if
                                          (shen/shen.parse-failure? W3367)
                                          (shen/shen.parse-failure)
                                          (shen/let W3368
                                                    (shen/shen.<-out W3367)
                                                    (shen/let W3369
                                                              (shen/shen.in->
                                                               W3367)
                                                              (shen/shen.comb
                                                               W3369 W3368)))))
                               (shen/if (shen/shen.parse-failure? W3366)
                                        (shen/shen.parse-failure) W3366))
                     W3362)))
(defun shen/shen.<single> (V3370)
  (shen/let W3371
            (shen/let W3372 (shen/shen.<sides> V3370)
                      (shen/if (shen/shen.parse-failure? W3372)
                               (shen/shen.parse-failure)
                               (shen/let W3373 (shen/shen.<-out W3372)
                                         (shen/let W3374 (shen/shen.in-> W3372)
                                                   (shen/let W3375
                                                             (shen/shen.<prems>
                                                              W3374)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3375)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3376
                                                                        (shen/shen.<-out
                                                                         W3375)
                                                                        (shen/let
                                                                         W3377
                                                                         (shen/shen.in->
                                                                          W3375)
                                                                         (shen/let
                                                                          W3378
                                                                          (shen/shen.<sng>
                                                                           W3377)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W3378)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W3379
                                                                            (shen/shen.in->
                                                                             W3378)
                                                                            (shen/let
                                                                             W3380
                                                                             (shen/shen.<conc>
                                                                              W3379)
                                                                             (shen/if
                                                                              (shen/shen.parse-failure?
                                                                               W3380)
                                                                              (shen/shen.parse-failure)
                                                                              (shen/let
                                                                               W3381
                                                                               (shen/shen.<-out
                                                                                W3380)
                                                                               (shen/let
                                                                                W3382
                                                                                (shen/shen.in->
                                                                                 W3380)
                                                                                (shen/let
                                                                                 W3383
                                                                                 (shen/shen.<sc>
                                                                                  W3382)
                                                                                 (shen/if
                                                                                  (shen/shen.parse-failure?
                                                                                   W3383)
                                                                                  (shen/shen.parse-failure)
                                                                                  (shen/let
                                                                                   W3384
                                                                                   (shen/shen.in->
                                                                                    W3383)
                                                                                   (shen/shen.comb
                                                                                    W3384
                                                                                    (list
                                                                                     (list
                                                                                      W3373
                                                                                      W3376
                                                                                      W3381)))))))))))))))))))))
            (shen/if (shen/shen.parse-failure? W3371) (shen/shen.parse-failure)
                     W3371)))
(defun shen/shen.<double> (V3385)
  (shen/let W3386
            (shen/let W3387 (shen/shen.<sides> V3385)
                      (shen/if (shen/shen.parse-failure? W3387)
                               (shen/shen.parse-failure)
                               (shen/let W3388 (shen/shen.<-out W3387)
                                         (shen/let W3389 (shen/shen.in-> W3387)
                                                   (shen/let W3390
                                                             (shen/shen.<formulae>
                                                              W3389)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3390)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3391
                                                                        (shen/shen.<-out
                                                                         W3390)
                                                                        (shen/let
                                                                         W3392
                                                                         (shen/shen.in->
                                                                          W3390)
                                                                         (shen/let
                                                                          W3393
                                                                          (shen/shen.<dbl>
                                                                           W3392)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W3393)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W3394
                                                                            (shen/shen.in->
                                                                             W3393)
                                                                            (shen/let
                                                                             W3395
                                                                             (shen/shen.<formula>
                                                                              W3394)
                                                                             (shen/if
                                                                              (shen/shen.parse-failure?
                                                                               W3395)
                                                                              (shen/shen.parse-failure)
                                                                              (shen/let
                                                                               W3396
                                                                               (shen/shen.<-out
                                                                                W3395)
                                                                               (shen/let
                                                                                W3397
                                                                                (shen/shen.in->
                                                                                 W3395)
                                                                                (shen/let
                                                                                 W3398
                                                                                 (shen/shen.<sc>
                                                                                  W3397)
                                                                                 (shen/if
                                                                                  (shen/shen.parse-failure?
                                                                                   W3398)
                                                                                  (shen/shen.parse-failure)
                                                                                  (shen/let
                                                                                   W3399
                                                                                   (shen/shen.in->
                                                                                    W3398)
                                                                                   (shen/shen.comb
                                                                                    W3399
                                                                                    (shen/shen.lr-rule
                                                                                     W3388
                                                                                     W3391
                                                                                     (list
                                                                                      nil
                                                                                      W3396)))))))))))))))))))))
            (shen/if (shen/shen.parse-failure? W3386) (shen/shen.parse-failure)
                     W3386)))
(defun shen/shen.<formulae> (V3400)
  (shen/let W3401
            (shen/let W3402 (shen/shen.<formula> V3400)
                      (shen/if (shen/shen.parse-failure? W3402)
                               (shen/shen.parse-failure)
                               (shen/let W3403 (shen/shen.<-out W3402)
                                         (shen/let W3404 (shen/shen.in-> W3402)
                                                   (shen/let W3405
                                                             (shen/shen.<sc>
                                                              W3404)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3405)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3406
                                                                        (shen/shen.in->
                                                                         W3405)
                                                                        (shen/let
                                                                         W3407
                                                                         (shen/shen.<formulae>
                                                                          W3406)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W3407)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W3408
                                                                           (shen/shen.<-out
                                                                            W3407)
                                                                           (shen/let
                                                                            W3409
                                                                            (shen/shen.in->
                                                                             W3407)
                                                                            (shen/shen.comb
                                                                             W3409
                                                                             (append
                                                                              (list
                                                                               (list
                                                                                nil
                                                                                W3403))
                                                                              W3408)))))))))))))
            (shen/if (shen/shen.parse-failure? W3401)
                     (shen/let W3410
                               (shen/let W3411 (shen/shen.<formula> V3400)
                                         (shen/if
                                          (shen/shen.parse-failure? W3411)
                                          (shen/shen.parse-failure)
                                          (shen/let W3412
                                                    (shen/shen.<-out W3411)
                                                    (shen/let W3413
                                                              (shen/shen.in->
                                                               W3411)
                                                              (shen/let W3414
                                                                        (shen/shen.<sc>
                                                                         W3413)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W3414)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W3415
                                                                          (shen/shen.in->
                                                                           W3414)
                                                                          (shen/shen.comb
                                                                           W3415
                                                                           (list
                                                                            (list
                                                                             nil
                                                                             W3412))))))))))
                               (shen/if (shen/shen.parse-failure? W3410)
                                        (shen/shen.parse-failure) W3410))
                     W3401)))
(defun shen/shen.<conc> (V3416)
  (shen/let W3417
            (shen/let W3418 (shen/shen.<ass> V3416)
                      (shen/if (shen/shen.parse-failure? W3418)
                               (shen/shen.parse-failure)
                               (shen/let W3419 (shen/shen.<-out W3418)
                                         (shen/let W3420 (shen/shen.in-> W3418)
                                                   (shen/if
                                                    (shen/shen.hds=? W3420 '>>)
                                                    (shen/let W3421
                                                              (shen/tail W3420)
                                                              (shen/let W3422
                                                                        (shen/shen.<formula>
                                                                         W3421)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W3422)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W3423
                                                                          (shen/shen.<-out
                                                                           W3422)
                                                                          (shen/let
                                                                           W3424
                                                                           (shen/shen.in->
                                                                            W3422)
                                                                           (shen/shen.comb
                                                                            W3424
                                                                            (list
                                                                             W3419
                                                                             W3423)))))))
                                                    (shen/shen.parse-failure))))))
            (shen/if (shen/shen.parse-failure? W3417)
                     (shen/let W3425
                               (shen/let W3426 (shen/shen.<formula> V3416)
                                         (shen/if
                                          (shen/shen.parse-failure? W3426)
                                          (shen/shen.parse-failure)
                                          (shen/let W3427
                                                    (shen/shen.<-out W3426)
                                                    (shen/let W3428
                                                              (shen/shen.in->
                                                               W3426)
                                                              (shen/shen.comb
                                                               W3428
                                                               (list nil W3427))))))
                               (shen/if (shen/shen.parse-failure? W3425)
                                        (shen/shen.parse-failure) W3425))
                     W3417)))
(defun shen/shen.<prems> (V3429)
  (shen/let W3430
            (shen/let W3431 (shen/shen.<prem> V3429)
                      (shen/if (shen/shen.parse-failure? W3431)
                               (shen/shen.parse-failure)
                               (shen/let W3432 (shen/shen.<-out W3431)
                                         (shen/let W3433 (shen/shen.in-> W3431)
                                                   (shen/let W3434
                                                             (shen/shen.<sc>
                                                              W3433)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3434)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3435
                                                                        (shen/shen.in->
                                                                         W3434)
                                                                        (shen/let
                                                                         W3436
                                                                         (shen/shen.<prems>
                                                                          W3435)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W3436)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W3437
                                                                           (shen/shen.<-out
                                                                            W3436)
                                                                           (shen/let
                                                                            W3438
                                                                            (shen/shen.in->
                                                                             W3436)
                                                                            (shen/shen.comb
                                                                             W3438
                                                                             (append
                                                                              (list
                                                                               W3432)
                                                                              W3437)))))))))))))
            (shen/if (shen/shen.parse-failure? W3430)
                     (shen/let W3439
                               (shen/let W3440 (shen/<e> V3429)
                                         (shen/if
                                          (shen/shen.parse-failure? W3440)
                                          (shen/shen.parse-failure)
                                          (shen/let W3441 (shen/shen.in-> W3440)
                                                    (shen/shen.comb W3441 nil))))
                               (shen/if (shen/shen.parse-failure? W3439)
                                        (shen/shen.parse-failure) W3439))
                     W3430)))
(defun shen/shen.<prem> (V3442)
  (shen/let W3443
            (shen/if (shen/shen.hds=? V3442 '!)
                     (shen/let W3444 (shen/tail V3442) (shen/shen.comb W3444 '!))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3443)
                     (shen/let W3445
                               (shen/let W3446 (shen/shen.<ass> V3442)
                                         (shen/if
                                          (shen/shen.parse-failure? W3446)
                                          (shen/shen.parse-failure)
                                          (shen/let W3447
                                                    (shen/shen.<-out W3446)
                                                    (shen/let W3448
                                                              (shen/shen.in->
                                                               W3446)
                                                              (shen/if
                                                               (shen/shen.hds=?
                                                                W3448 '>>)
                                                               (shen/let W3449
                                                                         (shen/tail
                                                                          W3448)
                                                                         (shen/let
                                                                          W3450
                                                                          (shen/shen.<formula>
                                                                           W3449)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W3450)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W3451
                                                                            (shen/shen.<-out
                                                                             W3450)
                                                                            (shen/let
                                                                             W3452
                                                                             (shen/shen.in->
                                                                              W3450)
                                                                             (shen/shen.comb
                                                                              W3452
                                                                              (list
                                                                               W3447
                                                                               W3451)))))))
                                                               (shen/shen.parse-failure))))))
                               (shen/if (shen/shen.parse-failure? W3445)
                                        (shen/let W3453
                                                  (shen/let W3454
                                                            (shen/shen.<formula>
                                                             V3442)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W3454)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W3455
                                                                       (shen/shen.<-out
                                                                        W3454)
                                                                       (shen/let
                                                                        W3456
                                                                        (shen/shen.in->
                                                                         W3454)
                                                                        (shen/shen.comb
                                                                         W3456
                                                                         (list
                                                                          nil
                                                                          W3455))))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W3453)
                                                   (shen/shen.parse-failure)
                                                   W3453))
                                        W3445))
                     W3443)))
(defun shen/shen.<ass> (V3457)
  (shen/let W3458
            (shen/let W3459 (shen/shen.<formula> V3457)
                      (shen/if (shen/shen.parse-failure? W3459)
                               (shen/shen.parse-failure)
                               (shen/let W3460 (shen/shen.<-out W3459)
                                         (shen/let W3461 (shen/shen.in-> W3459)
                                                   (shen/let W3462
                                                             (shen/shen.<iscomma>
                                                              W3461)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3462)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3463
                                                                        (shen/shen.in->
                                                                         W3462)
                                                                        (shen/let
                                                                         W3464
                                                                         (shen/shen.<ass>
                                                                          W3463)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W3464)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W3465
                                                                           (shen/shen.<-out
                                                                            W3464)
                                                                           (shen/let
                                                                            W3466
                                                                            (shen/shen.in->
                                                                             W3464)
                                                                            (shen/shen.comb
                                                                             W3466
                                                                             (append
                                                                              (list
                                                                               W3460)
                                                                              W3465)))))))))))))
            (shen/if (shen/shen.parse-failure? W3458)
                     (shen/let W3467
                               (shen/let W3468 (shen/shen.<formula> V3457)
                                         (shen/if
                                          (shen/shen.parse-failure? W3468)
                                          (shen/shen.parse-failure)
                                          (shen/let W3469
                                                    (shen/shen.<-out W3468)
                                                    (shen/let W3470
                                                              (shen/shen.in->
                                                               W3468)
                                                              (shen/shen.comb
                                                               W3470
                                                               (list W3469))))))
                               (shen/if (shen/shen.parse-failure? W3467)
                                        (shen/let W3471
                                                  (shen/let W3472
                                                            (shen/<e> V3457)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W3472)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W3473
                                                                       (shen/shen.in->
                                                                        W3472)
                                                                       (shen/shen.comb
                                                                        W3473
                                                                        nil))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W3471)
                                                   (shen/shen.parse-failure)
                                                   W3471))
                                        W3467))
                     W3458)))
(defun shen/shen.<iscomma> (V3474)
  (shen/let W3475
            (shen/if (shen/cons? V3474)
                     (shen/let W3476 (shen/head V3474)
                               (shen/let W3477 (shen/tail V3474)
                                         (shen/if
                                          (shen/= W3476 (shen/intern ","))
                                          (shen/shen.comb W3477 'shen.skip)
                                          (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3475) (shen/shen.parse-failure)
                     W3475)))
(defun shen/shen.<formula> (V3478)
  (shen/let W3479
            (shen/let W3480 (shen/shen.<expr> V3478)
                      (shen/if (shen/shen.parse-failure? W3480)
                               (shen/shen.parse-failure)
                               (shen/let W3481 (shen/shen.<-out W3480)
                                         (shen/let W3482 (shen/shen.in-> W3480)
                                                   (shen/let W3483
                                                             (shen/shen.<iscolon>
                                                              W3482)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3483)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3484
                                                                        (shen/shen.in->
                                                                         W3483)
                                                                        (shen/let
                                                                         W3485
                                                                         (shen/shen.<type>
                                                                          W3484)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W3485)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W3486
                                                                           (shen/shen.<-out
                                                                            W3485)
                                                                           (shen/let
                                                                            W3487
                                                                            (shen/shen.in->
                                                                             W3485)
                                                                            (shen/shen.comb
                                                                             W3487
                                                                             (list
                                                                              (shen/shen.curry
                                                                               W3481)
                                                                              (shen/intern
                                                                               ":")
                                                                              (shen/shen.rectify-type
                                                                               W3486))))))))))))))
            (shen/if (shen/shen.parse-failure? W3479)
                     (shen/let W3488
                               (shen/let W3489 (shen/shen.<expr> V3478)
                                         (shen/if
                                          (shen/shen.parse-failure? W3489)
                                          (shen/shen.parse-failure)
                                          (shen/let W3490
                                                    (shen/shen.<-out W3489)
                                                    (shen/let W3491
                                                              (shen/shen.in->
                                                               W3489)
                                                              (shen/shen.comb
                                                               W3491 W3490)))))
                               (shen/if (shen/shen.parse-failure? W3488)
                                        (shen/shen.parse-failure) W3488))
                     W3479)))
(defun shen/shen.<iscolon> (V3492)
  (shen/let W3493
            (shen/if (shen/cons? V3492)
                     (shen/let W3494 (shen/head V3492)
                               (shen/let W3495 (shen/tail V3492)
                                         (shen/if
                                          (shen/= W3494 (shen/intern ":"))
                                          (shen/shen.comb W3495 'shen.skip)
                                          (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3493) (shen/shen.parse-failure)
                     W3493)))
(defun shen/shen.<sides> (V3496)
  (shen/let W3497
            (shen/let W3498 (shen/shen.<side> V3496)
                      (shen/if (shen/shen.parse-failure? W3498)
                               (shen/shen.parse-failure)
                               (shen/let W3499 (shen/shen.<-out W3498)
                                         (shen/let W3500 (shen/shen.in-> W3498)
                                                   (shen/let W3501
                                                             (shen/shen.<sides>
                                                              W3500)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W3501)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W3502
                                                                        (shen/shen.<-out
                                                                         W3501)
                                                                        (shen/let
                                                                         W3503
                                                                         (shen/shen.in->
                                                                          W3501)
                                                                         (shen/shen.comb
                                                                          W3503
                                                                          (append
                                                                           (list
                                                                            W3499)
                                                                           W3502))))))))))
            (shen/if (shen/shen.parse-failure? W3497)
                     (shen/let W3504
                               (shen/let W3505 (shen/<e> V3496)
                                         (shen/if
                                          (shen/shen.parse-failure? W3505)
                                          (shen/shen.parse-failure)
                                          (shen/let W3506 (shen/shen.in-> W3505)
                                                    (shen/shen.comb W3506 nil))))
                               (shen/if (shen/shen.parse-failure? W3504)
                                        (shen/shen.parse-failure) W3504))
                     W3497)))
(defun shen/shen.<side> (V3507)
  (shen/let W3508
            (shen/if (shen/shen.hds=? V3507 'if)
                     (shen/let W3509 (shen/tail V3507)
                               (shen/if (shen/cons? W3509)
                                        (shen/let W3510 (shen/head W3509)
                                                  (shen/let W3511
                                                            (shen/tail W3509)
                                                            (shen/shen.comb
                                                             W3511
                                                             (list 'if W3510))))
                                        (shen/shen.parse-failure)))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3508)
                     (shen/let W3512
                               (shen/if (shen/shen.hds=? V3507 'let)
                                        (shen/let W3513 (shen/tail V3507)
                                                  (shen/if (shen/cons? W3513)
                                                           (shen/let W3514
                                                                     (shen/head
                                                                      W3513)
                                                                     (shen/let
                                                                      W3515
                                                                      (shen/tail
                                                                       W3513)
                                                                      (shen/if
                                                                       (shen/cons?
                                                                        W3515)
                                                                       (shen/let
                                                                        W3516
                                                                        (shen/head
                                                                         W3515)
                                                                        (shen/let
                                                                         W3517
                                                                         (shen/tail
                                                                          W3515)
                                                                         (shen/shen.comb
                                                                          W3517
                                                                          (list
                                                                           'let
                                                                           W3514
                                                                           W3516))))
                                                                       (shen/shen.parse-failure))))
                                                           (shen/shen.parse-failure)))
                                        (shen/shen.parse-failure))
                               (shen/if (shen/shen.parse-failure? W3512)
                                        (shen/let W3518
                                                  (shen/if
                                                   (shen/shen.hds=? V3507
                                                                    'shen.let!)
                                                   (shen/let W3519
                                                             (shen/tail V3507)
                                                             (shen/if
                                                              (shen/cons? W3519)
                                                              (shen/let W3520
                                                                        (shen/head
                                                                         W3519)
                                                                        (shen/let
                                                                         W3521
                                                                         (shen/tail
                                                                          W3519)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W3521)
                                                                          (shen/let
                                                                           W3522
                                                                           (shen/head
                                                                            W3521)
                                                                           (shen/let
                                                                            W3523
                                                                            (shen/tail
                                                                             W3521)
                                                                            (shen/shen.comb
                                                                             W3523
                                                                             (list
                                                                              'shen.let!
                                                                              W3520
                                                                              W3522))))
                                                                          (shen/shen.parse-failure))))
                                                              (shen/shen.parse-failure)))
                                                   (shen/shen.parse-failure))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W3518)
                                                   (shen/shen.parse-failure)
                                                   W3518))
                                        W3512))
                     W3508)))
(defun shen/shen.lr-rule (V3530 V3531 V3532)
  (shen/cond
   ((shen/and (shen/cons? V3532)
              (shen/and (shen/internal/predicate->shen (null (shen/hd V3532)))
                        (shen/and (shen/cons? (nthcdr 1 V3532))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3532))))))
    (shen/let W3533 (shen/gensym 'P)
              (shen/let W3534 (list (nthcdr 1 V3532) W3533)
                        (shen/let W3535
                                  (list (shen/shen.coll-formulae V3531) W3533)
                                  (shen/let W3536
                                            (list V3530 (list W3535) W3534)
                                            (shen/let W3537
                                                      (list V3530 V3531 V3532)
                                                      (list W3537 W3536)))))))
   (shen/true (shen/simple-error "implementation error in shen.lr-rule"))))
(defun shen/shen.coll-formulae (V3540)
  (shen/cond ((shen/internal/predicate->shen (null V3540)) nil)
             ((shen/and (shen/cons? V3540)
                        (shen/and (shen/cons? (shen/hd V3540))
                                  (shen/and
                                   (shen/internal/predicate->shen
                                    (null (shen/hd (shen/hd V3540))))
                                   (shen/and
                                    (shen/cons? (nthcdr 1 (shen/hd V3540)))
                                    (shen/internal/predicate->shen
                                     (null (nthcdr 2 (shen/hd V3540))))))))
              (append (list (shen/hd (nthcdr 1 (shen/hd V3540))))
                      (shen/shen.coll-formulae (nthcdr 1 V3540))))
             (shen/true
              (shen/simple-error "implementation error in shen.coll-formulae"))))
(defun shen/shen.<expr> (V3541)
  (shen/let W3542
            (shen/if (shen/cons? V3541)
                     (shen/let W3543 (shen/head V3541)
                               (shen/let W3544 (shen/tail V3541)
                                         (shen/if
                                          (shen/not
                                           (shen/shen.key-in-sequent-calculus?
                                            W3543))
                                          (shen/shen.comb W3544
                                                          (shen/macroexpand
                                                           W3543))
                                          (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3542) (shen/shen.parse-failure)
                     W3542)))
(defun shen/shen.key-in-sequent-calculus? (V3545)
  (shen/or
   (shen/element? V3545
                  (list '>> (shen/intern ";") (shen/intern ",")
                        (shen/intern ":") '<--))
   (shen/or (shen/shen.sng? V3545) (shen/shen.dbl? V3545))))
(defun shen/shen.<type> (V3546)
  (shen/let W3547
            (shen/let W3548 (shen/shen.<expr> V3546)
                      (shen/if (shen/shen.parse-failure? W3548)
                               (shen/shen.parse-failure)
                               (shen/let W3549 (shen/shen.<-out W3548)
                                         (shen/let W3550 (shen/shen.in-> W3548)
                                                   (shen/shen.comb W3550 W3549)))))
            (shen/if (shen/shen.parse-failure? W3547) (shen/shen.parse-failure)
                     W3547)))
(defun shen/shen.<dbl> (V3551)
  (shen/let W3552
            (shen/if (shen/cons? V3551)
                     (shen/let W3553 (shen/head V3551)
                               (shen/let W3554 (shen/tail V3551)
                                         (shen/if (shen/shen.dbl? W3553)
                                                  (shen/shen.comb W3554 W3553)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3552) (shen/shen.parse-failure)
                     W3552)))
(defun shen/shen.<sng> (V3555)
  (shen/let W3556
            (shen/if (shen/cons? V3555)
                     (shen/let W3557 (shen/head V3555)
                               (shen/let W3558 (shen/tail V3555)
                                         (shen/if (shen/shen.sng? W3557)
                                                  (shen/shen.comb W3558 W3557)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W3556) (shen/shen.parse-failure)
                     W3556)))
(defun shen/shen.sng? (V3559)
  (shen/and (shen/symbol? V3559) (shen/shen.sng-h? (shen/str V3559))))
(defun shen/shen.sng-h? (V3562)
  (cl-flet
      ((tail-trampoline (V3562)
         (shen/cond ((shen/= "___" V3562) 'true)
                    ((shen/and (shen/shen.+string? V3562)
                               (shen/= "_" (shen/hdstr V3562)))
                     (vector (list (shen/tlstr V3562))))
                    (shen/true 'false))))
    (let ((result (funcall #'tail-trampoline V3562)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.dbl? (V3563)
  (shen/and (shen/symbol? V3563) (shen/shen.dbl-h? (shen/str V3563))))
(defun shen/shen.dbl-h? (V3566)
  (cl-flet
      ((tail-trampoline (V3566)
         (shen/cond ((shen/= "===" V3566) 'true)
                    ((shen/and (shen/shen.+string? V3566)
                               (shen/= "=" (shen/hdstr V3566)))
                     (vector (list (shen/tlstr V3566))))
                    (shen/true 'false))))
    (let ((result (funcall #'tail-trampoline V3566)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.remember-datatype (V3567 V3568)
  (shen/do
   (shen/set 'shen.*datatypes*
             (shen/shen.assoc-> V3567 V3568 (shen/value 'shen.*datatypes*)))
   (shen/do
    (shen/set 'shen.*alldatatypes*
              (shen/shen.assoc-> V3567 V3568 (shen/value 'shen.*alldatatypes*)))
    V3567)))
(defun shen/shen.rules->prolog (V3569 V3570)
  (shen/let W3571
            (shen/mapcan (shen/lambda Z3572 (shen/shen.rule->clause Z3572))
                         V3570)
            (shen/eval (append (list 'defprolog V3569) W3571))))
(defun shen/shen.rule->clause (V3575)
  (shen/cond
   ((shen/and (shen/cons? V3575)
              (shen/and (shen/cons? (nthcdr 1 V3575))
                        (shen/and (shen/cons? (nthcdr 2 V3575))
                                  (shen/and
                                   (shen/cons? (shen/hd (nthcdr 2 V3575)))
                                   (shen/and
                                    (shen/cons?
                                     (nthcdr 1 (shen/hd (nthcdr 2 V3575))))
                                    (shen/and
                                     (shen/internal/predicate->shen
                                      (null
                                       (nthcdr 2 (shen/hd (nthcdr 2 V3575)))))
                                     (shen/internal/predicate->shen
                                      (null (nthcdr 3 V3575)))))))))
    (shen/let W3576 (shen/shen.extract-vars V3575)
              (shen/let W3577
                        (shen/append
                         (shen/shen.nvars
                          (shen/length (shen/hd (shen/hd (nthcdr 2 V3575)))))
                         (list 'Delta))
                        (shen/let W3578
                                  (shen/shen.extract-vars
                                   (shen/hd
                                    (nthcdr 1 (shen/hd (nthcdr 2 V3575)))))
                                  (shen/let W3579
                                            (shen/shen.compile-consequent
                                             (shen/hd
                                              (nthcdr 1
                                                      (shen/hd (nthcdr 2 V3575))))
                                             W3577)
                                            (shen/let W3580
                                                      (shen/shen.goals W3576
                                                                       (shen/hd
                                                                        (shen/hd
                                                                         (nthcdr
                                                                          2
                                                                          V3575)))
                                                                       (shen/hd
                                                                        V3575)
                                                                       (shen/hd
                                                                        (nthcdr
                                                                         1 V3575))
                                                                       W3577
                                                                       W3578)
                                                      (shen/append W3579
                                                                   (shen/append
                                                                    (list '<--)
                                                                    (shen/append
                                                                     W3580
                                                                     (list
                                                                      (shen/intern
                                                                       ";")))))))))))
   (shen/true (shen/simple-error "implementation error in shen.rule->clause"))))
(defun shen/shen.compile-consequent (V3587 V3588)
  (shen/cond
   ((shen/cons? V3588) (list (shen/shen.optimise-typing V3587) (shen/hd V3588)))
   (shen/true
    (shen/simple-error "implementation error in shen.compile-consequent"))))
(defun shen/shen.nvars (V3589)
  (shen/cond ((shen/= 0 V3589) nil)
             (shen/true
              (append (list (shen/gensym 'V)) (shen/shen.nvars (shen/- V3589 1))))))
(defun shen/shen.optimise-typing (V3590)
  (shen/cond
   ((shen/and (shen/cons? V3590)
              (shen/and (shen/cons? (nthcdr 1 V3590))
                        (shen/and (shen/cons? (nthcdr 2 V3590))
                                  (shen/and
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 3 V3590)))
                                   (shen/= (shen/hd (nthcdr 1 V3590))
                                           (shen/intern ":"))))))
    (shen/let W3591
              (shen/shen.expand-mode-forms
               (list '-
                     (list (shen/hd V3590) (shen/hd (nthcdr 1 V3590))
                           (append (list '+) (nthcdr 2 V3590)))))
              (shen/shen.cons-form-with-modes W3591)))
   (shen/true
    (shen/let W3592 (shen/shen.expand-mode-forms (list '+ V3590))
              (shen/shen.cons-form-with-modes W3592)))))
(defun shen/shen.expand-mode-forms (V3593)
  (shen/cond
   ((shen/and (shen/cons? V3593)
              (shen/and (shen/= '+ (shen/hd V3593))
                        (shen/and (shen/cons? (nthcdr 1 V3593))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3593))))))
    (list 'mode (shen/shen.expand-mode-forms (shen/hd (nthcdr 1 V3593))) '+))
   ((shen/and (shen/cons? V3593)
              (shen/and (shen/= '- (shen/hd V3593))
                        (shen/and (shen/cons? (nthcdr 1 V3593))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3593))))))
    (list 'mode (shen/shen.expand-mode-forms (shen/hd (nthcdr 1 V3593))) '-))
   ((shen/cons? V3593)
    (shen/map (shen/lambda Z3594 (shen/shen.expand-mode-forms Z3594)) V3593))
   (shen/true V3593)))
(defun shen/shen.cons-form-with-modes (V3595)
  (shen/cond
   ((shen/and (shen/cons? V3595)
              (shen/and (shen/= 'mode (shen/hd V3595))
                        (shen/and (shen/cons? (nthcdr 1 V3595))
                                  (shen/and (shen/cons? (nthcdr 2 V3595))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V3595)))))))
    (list (shen/hd (nthcdr 2 V3595))
          (shen/shen.cons-form-with-modes (shen/hd (nthcdr 1 V3595)))))
   ((shen/and (shen/cons? V3595)
              (shen/and (shen/= 'bar! (shen/hd V3595))
                        (shen/and (shen/cons? (nthcdr 1 V3595))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3595))))))
    (shen/hd (nthcdr 1 V3595)))
   ((shen/cons? V3595)
    (list 'cons (shen/shen.cons-form-with-modes (shen/hd V3595))
          (shen/shen.cons-form-with-modes (nthcdr 1 V3595))))
   (shen/true V3595)))
(defun shen/shen.goals (V3596 V3597 V3598 V3599 V3600 V3601)
  (shen/let W3602 (shen/shen.compile-assumptions V3597 V3596 V3600 V3601)
            (shen/let W3603 (shen/shen.compile-side-conditions V3598)
                      (shen/let W3604 (shen/shen.compile-premises V3599 V3600)
                                (shen/append W3602 (shen/append W3603 W3604))))))
(defun shen/shen.compile-assumptions (V3619 V3620 V3621 V3622)
  (shen/cond ((shen/internal/predicate->shen (null V3619)) nil)
             ((shen/and (shen/cons? V3619)
                        (shen/and (shen/cons? V3621)
                                  (shen/cons? (nthcdr 1 V3621))))
              (shen/let W3623
                        (shen/append (shen/shen.extract-vars (shen/hd V3619))
                                     V3622)
                        (append
                         (list
                          (shen/shen.compile-assumption (shen/hd V3619)
                                                        (shen/hd V3621)
                                                        (shen/hd
                                                         (nthcdr 1 V3621))
                                                        V3620 V3622))
                         (shen/shen.compile-assumptions (nthcdr 1 V3619) V3620
                                                        (nthcdr 1 V3621) W3623))))
             (shen/true
              (shen/simple-error
               "implementation error in shen.compile-assumptions"))))
(defun shen/shen.compile-assumption (V3624 V3625 V3626 V3627 V3628)
  (shen/let W3629 (shen/gensym 'shen.search)
            (shen/let W3630
                      (shen/shen.compile-search-procedure W3629 V3624 V3625
                                                          V3626 V3627 V3628)
                      (append (list W3629 V3625 nil V3626) V3627))))
(defun shen/shen.compile-search-procedure (V3631 V3632 V3633 V3634 V3635 V3636)
  (shen/let W3637 (shen/gensym 'Previous)
            (shen/let W3638
                      (shen/shen.foundit! V3632 V3633 W3637 V3634 V3635 V3636)
                      (shen/let W3639
                                (shen/shen.keep-looking V3631 V3633 W3637 V3634
                                                        V3635)
                                (shen/eval
                                 (append (list 'defprolog V3631)
                                         (shen/append W3638 W3639)))))))
(defun shen/shen.foundit! (V3640 V3641 V3642 V3643 V3644 V3645)
  (shen/let W3646 (shen/shen.passive V3640 V3645)
            (shen/let W3647 (shen/shen.tabulate-passive W3646)
                      (shen/let W3648
                                (shen/shen.head-foundit! V3640 V3641 V3642 V3643
                                                         V3644 W3647)
                                (shen/let W3649
                                          (shen/shen.body-foundit! V3641 V3642
                                                                   V3643 W3647)
                                          (shen/append W3648
                                                       (shen/append (list '<--)
                                                                    (shen/append
                                                                     W3649
                                                                     (list
                                                                      (shen/intern
                                                                       ";"))))))))))
(defun shen/shen.keep-looking (V3650 V3651 V3652 V3653 V3654)
  (shen/let W3655 (shen/gensym 'V)
            (shen/let W3656
                      (append
                       (list (list '- (list 'cons W3655 V3651)) V3652 V3653)
                       V3654)
                      (shen/let W3657
                                (list
                                 (append
                                  (list V3650 V3651 (list 'cons W3655 V3652)
                                        V3653)
                                  V3654))
                                (shen/append W3656
                                             (shen/append (list '<--)
                                                          (shen/append W3657
                                                                       (list
                                                                        (shen/intern
                                                                         ";")))))))))
(defun shen/shen.passive (V3662 V3663)
  (shen/cond
   ((shen/cons? V3662)
    (shen/union (shen/shen.passive (shen/hd V3662) V3663)
                (shen/shen.passive (nthcdr 1 V3662) V3663)))
   ((shen/shen.passive? V3662 V3663) (list V3662)) (shen/true nil)))
(defun shen/shen.passive? (V3664 V3665)
  (shen/and (shen/not (shen/element? V3664 V3665)) (shen/variable? V3664)))
(defun shen/shen.tabulate-passive (V3666)
  (shen/map (shen/lambda Z3667 (append (list Z3667) (shen/gensym 'V))) V3666))
(defun shen/shen.head-foundit! (V3668 V3669 V3670 V3671 V3672 V3673)
  (shen/let W3674 (shen/shen.optimise-passive V3672 V3673)
            (append
             (list
              (list '- (list 'cons (shen/shen.optimise-typing V3668) V3669))
              V3670 V3671)
             W3674)))
(defun shen/shen.optimise-passive (V3675 V3676)
  (shen/map (shen/lambda Z3677 (shen/shen.optimise-passive-h Z3677 V3676)) V3675))
(defun shen/shen.optimise-passive-h (V3678 V3679)
  (shen/let W3680 (shen/assoc V3678 V3679)
            (shen/if (shen/empty? W3680) V3678 (nthcdr 1 W3680))))
(defun shen/shen.body-foundit! (V3689 V3690 V3691 V3692)
  (shen/cond
   ((shen/internal/predicate->shen (null V3692))
    (list (list 'bind V3691 (list 'append (list 1 V3690) (list 1 V3689)))))
   ((shen/and (shen/cons? V3692) (shen/cons? (shen/hd V3692)))
    (append
     (list (list 'bind (nthcdr 1 (shen/hd V3692)) (shen/hd (shen/hd V3692))))
     (shen/shen.body-foundit! V3689 V3690 V3691 (nthcdr 1 V3692))))
   (shen/true (shen/simple-error "implementation error in shen.body-foundit!"))))
(defun shen/shen.compile-side-conditions (V3693)
  (shen/map (shen/lambda Z3694 (shen/shen.compile-side-condition Z3694)) V3693))
(defun shen/shen.compile-side-condition (V3697)
  (shen/cond
   ((shen/and (shen/cons? V3697)
              (shen/and (shen/= 'let (shen/hd V3697))
                        (shen/and (shen/cons? (nthcdr 1 V3697))
                                  (shen/and (shen/cons? (nthcdr 2 V3697))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V3697)))))))
    (append (list 'is) (nthcdr 1 V3697)))
   ((shen/and (shen/cons? V3697)
              (shen/and (shen/= 'shen.let! (shen/hd V3697))
                        (shen/and (shen/cons? (nthcdr 1 V3697))
                                  (shen/and (shen/cons? (nthcdr 2 V3697))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V3697)))))))
    (append (list 'is!) (nthcdr 1 V3697)))
   ((shen/and (shen/cons? V3697)
              (shen/and (shen/= 'if (shen/hd V3697))
                        (shen/and (shen/cons? (nthcdr 1 V3697))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3697))))))
    (append (list 'when) (nthcdr 1 V3697)))
   (shen/true
    (shen/simple-error "implementation error in shen.compile-side-condition"))))
(defun shen/shen.compile-premises (V3698 V3699)
  (shen/let W3700 (shen/hd (shen/reverse V3699))
            (shen/map
             (shen/lambda Z3701 (shen/shen.compile-premise Z3701 W3700)) V3698)))
(defun shen/shen.compile-premise (V3708 V3709)
  (shen/cond ((shen/= '! V3708) '!)
             ((shen/and (shen/cons? V3708)
                        (shen/and (shen/cons? (nthcdr 1 V3708))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3708)))))
              (shen/shen.compile-premise-h (shen/reverse (shen/hd V3708))
                                           (shen/hd (nthcdr 1 V3708)) V3709))
             (shen/true
              (shen/simple-error "implementation error in shen.premise"))))
(defun shen/shen.compile-premise-h (V3716 V3717 V3718)
  (cl-flet
      ((tail-trampoline (V3716 V3717 V3718)
         (shen/cond
          ((shen/internal/predicate->shen (null V3716))
           (list 'shen.system-S (shen/shen.cons-form-no-modes V3717) V3718))
          ((shen/cons? V3716)
           (vector
            (list (nthcdr 1 V3716) V3717
                  (list 'cons (shen/shen.cons-form-no-modes (shen/hd V3716))
                        V3718))))
          (shen/true
           (shen/simple-error "implementation error in shen.compile-premise-h")))))
    (let ((result (funcall #'tail-trampoline V3716 V3717 V3718)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.cons-form-no-modes (V3719)
  (shen/cond
   ((shen/and (shen/cons? V3719)
              (shen/and (shen/= 'bar! (shen/hd V3719))
                        (shen/and (shen/cons? (nthcdr 1 V3719))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V3719))))))
    (shen/hd (nthcdr 1 V3719)))
   ((shen/cons? V3719)
    (list 'cons (shen/shen.cons-form-no-modes (shen/hd V3719))
          (shen/shen.cons-form-no-modes (nthcdr 1 V3719))))
   (shen/true V3719)))
(defun shen/preclude (V3720)
  (shen/let W3721
            (shen/map (shen/lambda Z3722 (shen/shen.intern-type Z3722)) V3720)
            (shen/let W3723 (shen/value 'shen.*datatypes*)
                      (shen/let W3724 (shen/shen.remove-datatypes W3721 W3723)
                                (shen/let W3725
                                          (shen/set 'shen.*datatypes* W3724)
                                          (shen/shen.show-datatypes W3725))))))
(defun shen/shen.remove-datatypes (V3730 V3731)
  (cl-flet
      ((tail-trampoline (V3730 V3731)
         (shen/cond ((shen/internal/predicate->shen (null V3730)) V3731)
                    ((shen/cons? V3730)
                     (vector
                      (list (nthcdr 1 V3730)
                            (shen/shen.unassoc (shen/hd V3730) V3731))))
                    (shen/true
                     (shen/simple-error
                      "implementation error in shen.remove-datatypes")))))
    (let ((result (funcall #'tail-trampoline V3730 V3731)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.show-datatypes (V3732)
  (shen/map (shen/lambda Z3733 (shen/hd Z3733)) V3732))
(defun shen/include (V3734)
  (shen/let W3735
            (shen/map (shen/lambda Z3736 (shen/shen.intern-type Z3736)) V3734)
            (shen/let W3737
                      (shen/map
                       (shen/lambda Z3738
                                    (shen/shen.remember-datatype Z3738
                                                                 (shen/fn Z3738)))
                       W3735)
                      (shen/let W3739 (shen/value 'shen.*datatypes*)
                                (shen/shen.show-datatypes W3739)))))
(defun shen/preclude-all-but (V3740)
  (shen/let W3741 (shen/set 'shen.*datatypes* nil)
            (shen/let W3742
                      (shen/map
                       (shen/lambda Z3743 (shen/shen.intern-type Z3743)) V3740)
                      (shen/let W3744
                                (shen/map
                                 (shen/lambda Z3745
                                              (shen/shen.remember-datatype Z3745
                                                                           (shen/fn
                                                                            Z3745)))
                                 W3742)
                                (shen/shen.show-datatypes
                                 (shen/value 'shen.*datatypes*))))))
(defun shen/include-all-but (V3746)
  (shen/let W3747
            (shen/map (shen/lambda Z3748 (shen/shen.intern-type Z3748)) V3746)
            (shen/let W3749 (shen/value 'shen.*alldatatypes*)
                      (shen/let W3750
                                (shen/set 'shen.*datatypes*
                                          (shen/shen.remove-datatypes W3747
                                                                      W3749))
                                (shen/shen.show-datatypes W3750)))))
(defun shen/shen.f-error (V5821)
  (shen/do
   (shen/pr (shen/cn "partial function " (shen/shen.app V5821 ";\n" 'shen.a))
            (shen/stoutput))
   (shen/do
    (shen/if
     (shen/and (shen/not (shen/shen.tracked? V5821))
               (shen/y-or-n?
                (shen/cn "track " (shen/shen.app V5821 "? " 'shen.a))))
     (shen/shen.track-function (shen/ps V5821)) 'shen.ok)
    (shen/simple-error "aborted"))))
(defun shen/shen.tracked? (V5822)
  (shen/element? V5822 (shen/value 'shen.*tracking*)))
(defun shen/track (V5823)
  (shen/let W5824 (shen/ps V5823) (shen/shen.track-function W5824)))
(defun shen/shen.track-function (V5827)
  (shen/cond
   ((shen/and (shen/cons? V5827)
              (shen/and (shen/= 'defun (shen/hd V5827))
                        (shen/and (shen/cons? (nthcdr 1 V5827))
                                  (shen/and (shen/cons? (nthcdr 2 V5827))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V5827))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 4 V5827))))))))
    (shen/let W5828
              (list 'defun (shen/hd (nthcdr 1 V5827)) (shen/hd (nthcdr 2 V5827))
                    (shen/shen.insert-tracking-code (shen/hd (nthcdr 1 V5827))
                                                    (shen/hd (nthcdr 2 V5827))
                                                    (shen/hd (nthcdr 3 V5827))))
              (shen/let W5829 (shen/eval-kl W5828)
                        (shen/let W5830
                                  (shen/set 'shen.*tracking*
                                            (append (list W5829)
                                                    (shen/value 'shen.*tracking*)))
                                  W5829))))
   (shen/true (shen/simple-error "implementation error in shen.track-function"))))
(defun shen/shen.insert-tracking-code (V5831 V5832 V5833)
  (list 'do (list 'set 'shen.*call* (list '+ (list 'value 'shen.*call*) 1))
        (list 'do
              (list 'shen.input-track (list 'value 'shen.*call*) V5831
                    (shen/shen.cons-form (shen/shen.prolog-track V5833 V5832)))
              (list 'do (list 'shen.terpri-or-read-char)
                    (list 'let 'Result V5833
                          (list 'do
                                (list 'shen.output-track
                                      (list 'value 'shen.*call*) V5831 'Result)
                                (list 'do
                                      (list 'set 'shen.*call*
                                            (list '- (list 'value 'shen.*call*)
                                                  1))
                                      (list 'do (list 'shen.terpri-or-read-char)
                                            'Result))))))))
(defun shen/shen.prolog-track (V5834 V5835)
  (shen/cond ((shen/= (shen/occurrences 'shen.incinfs V5834) 0) V5835)
             (shen/true
              (shen/shen.vector-dereference V5835
                                            (shen/shen.vector-parameter V5835)))))
(defun shen/shen.vector-parameter (V5838)
  (cl-flet
      ((tail-trampoline (V5838)
         (shen/cond ((shen/internal/predicate->shen (null V5838)) nil)
                    ((shen/and (shen/cons? V5838)
                               (shen/and (shen/cons? (nthcdr 1 V5838))
                                         (shen/and (shen/cons? (nthcdr 2 V5838))
                                                   (shen/and
                                                    (shen/cons? (nthcdr 3 V5838))
                                                    (shen/internal/predicate->shen
                                                     (null (nthcdr 4 V5838)))))))
                     (shen/hd V5838))
                    ((shen/cons? V5838) (vector (list (nthcdr 1 V5838))))
                    (shen/true (shen/shen.f-error 'shen.vector-parameter)))))
    (let ((result (funcall #'tail-trampoline V5838)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.vector-dereference (V5841 V5842)
  (shen/cond ((shen/internal/predicate->shen (null V5842)) V5841)
             ((shen/and (shen/cons? V5841)
                        (shen/and (shen/cons? (nthcdr 1 V5841))
                                  (shen/and (shen/cons? (nthcdr 2 V5841))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V5841))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 4 V5841)))))))
              V5841)
             ((shen/cons? V5841)
              (append (list (list 'shen.deref (shen/hd V5841) V5842))
                      (shen/shen.vector-dereference (nthcdr 1 V5841) V5842)))
             (shen/true (shen/shen.f-error 'shen.vector-dereference))))
(defun shen/step (V5845)
  (shen/cond ((shen/= '+ V5845) (shen/set 'shen.*step* 'true))
             ((shen/= '- V5845) (shen/set 'shen.*step* 'false))
             (shen/true (shen/simple-error "step expects a + or a -.\n"))))
(defun shen/spy (V5848)
  (shen/cond ((shen/= '+ V5848) (shen/set 'shen.*spy* 'true))
             ((shen/= '- V5848) (shen/set 'shen.*spy* 'false))
             (shen/true (shen/simple-error "spy expects a + or a -.\n"))))
(defun shen/shen.terpri-or-read-char nil
  (shen/if (shen/value 'shen.*step*)
           (shen/shen.check-byte (shen/read-byte (shen/value '*stinput*)))
           (shen/nl 1)))
(defun shen/shen.check-byte (V5851)
  (shen/cond ((shen/= 94 V5851) (shen/simple-error "aborted")) (shen/true 'true)))
(defun shen/shen.input-track (V5852 V5853 V5854)
  (shen/do
   (shen/pr
    (shen/cn "\n"
             (shen/shen.app (shen/shen.spaces V5852)
                            (shen/cn "<"
                                     (shen/shen.app V5852
                                                    (shen/cn "> Inputs to "
                                                             (shen/shen.app
                                                              V5853
                                                              (shen/cn " \n"
                                                                       (shen/shen.app
                                                                        (shen/shen.spaces
                                                                         V5852)
                                                                        ""
                                                                        'shen.a))
                                                              'shen.a))
                                                    'shen.a))
                            'shen.a))
    (shen/stoutput))
   (shen/shen.recursively-print V5854)))
(defun shen/shen.recursively-print (V5857)
  (cl-flet
      ((tail-trampoline (V5857)
         (shen/cond
          ((shen/internal/predicate->shen (null V5857))
           (shen/pr " ==>" (shen/stoutput)))
          ((shen/cons? V5857)
           (shen/do (shen/print (shen/hd V5857))
                    (shen/do (shen/pr ", " (shen/stoutput))
                             (vector (list (nthcdr 1 V5857))))))
          (shen/true
           (shen/simple-error "implementation error in shen.recursively-print")))))
    (let ((result (funcall #'tail-trampoline V5857)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.spaces (V5858)
  (shen/cond ((shen/= 0 V5858) "")
             (shen/true (shen/cn " " (shen/shen.spaces (shen/- V5858 1))))))
(defun shen/shen.output-track (V5859 V5860 V5861)
  (shen/pr
   (shen/cn "\n"
            (shen/shen.app (shen/shen.spaces V5859)
                           (shen/cn "<"
                                    (shen/shen.app V5859
                                                   (shen/cn "> Output from "
                                                            (shen/shen.app V5860
                                                                           (shen/cn
                                                                            " \n"
                                                                            (shen/shen.app
                                                                             (shen/shen.spaces
                                                                              V5859)
                                                                             (shen/cn
                                                                              "==> "
                                                                              (shen/shen.app
                                                                               V5861
                                                                               ""
                                                                               'shen.s))
                                                                             'shen.a))
                                                                           'shen.a))
                                                   'shen.a))
                           'shen.a))
   (shen/stoutput)))
(defun shen/untrack (F)
  (progn
    (shen/set shen.*tracking*
              (shen/internal/delete-first-eq F (shen/value shen.*tracking*)))
    (shen/eval (shen/ps F))))
(defun shen/remove (V5864 V5865) (shen/shen.remove-h V5864 V5865 nil))
(defun shen/shen.remove-h (V5875 V5876 V5877)
  (cl-flet
      ((tail-trampoline (V5875 V5876 V5877)
         (shen/cond
          ((shen/internal/predicate->shen (null V5876)) (shen/reverse V5877))
          ((shen/and (shen/cons? V5876) (shen/= V5875 (shen/hd V5876)))
           (vector (list (shen/hd V5876) (nthcdr 1 V5876) V5877)))
          ((shen/cons? V5876)
           (vector
            (list V5875 (nthcdr 1 V5876) (append (list (shen/hd V5876)) V5877))))
          (shen/true (shen/simple-error "implementation error in shen.remove-h")))))
    (let ((result (funcall #'tail-trampoline V5875 V5876 V5877)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/profile (V5878)
  (shen/do
   (shen/set 'shen.*profiled*
             (append (list V5878) (shen/value 'shen.*profiled*)))
   (shen/shen.profile-help (shen/ps V5878))))
(defun shen/shen.profile-help (V5881)
  (shen/cond
   ((shen/and (shen/cons? V5881)
              (shen/and (shen/= 'defun (shen/hd V5881))
                        (shen/and (shen/cons? (nthcdr 1 V5881))
                                  (shen/and (shen/cons? (nthcdr 2 V5881))
                                            (shen/and
                                             (shen/cons? (nthcdr 3 V5881))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 4 V5881))))))))
    (shen/let W5882 (shen/gensym 'shen.f)
              (shen/let W5883
                        (list 'defun (shen/hd (nthcdr 1 V5881))
                              (shen/hd (nthcdr 2 V5881))
                              (shen/shen.profile-func (shen/hd (nthcdr 1 V5881))
                                                      (shen/hd (nthcdr 2 V5881))
                                                      (append (list W5882)
                                                              (shen/hd
                                                               (nthcdr 2 V5881)))))
                        (shen/let W5884
                                  (list 'defun W5882 (shen/hd (nthcdr 2 V5881))
                                        (shen/subst W5882
                                                    (shen/hd (nthcdr 1 V5881))
                                                    (shen/hd (nthcdr 3 V5881))))
                                  (shen/let W5885 (shen/eval-kl W5883)
                                            (shen/let W5886 (shen/eval-kl W5884)
                                                      (shen/hd (nthcdr 1 V5881))))))))
   (shen/true (shen/simple-error "Cannot profile.\n"))))
(defun shen/unprofile (V5887)
  (shen/do
   (shen/set 'shen.*profiled* (shen/remove V5887 (shen/value 'shen.*profiled*)))
   (shen/trap-error (shen/eval (shen/ps V5887)) (shen/lambda Z5888 V5887))))
(defun shen/shen.profiled? (V5889)
  (shen/element? V5889 (shen/value 'shen.*profiled*)))
(defun shen/shen.profile-func (V5890 V5891 V5892)
  (list 'let 'Start (list 'get-time 'run)
        (list 'let 'Result V5892
              (list 'let 'Finish (list '- (list 'get-time 'run) 'Start)
                    (list 'let 'Record
                          (list 'shen.put-profile V5890
                                (list '+ (list 'shen.get-profile V5890) 'Finish))
                          'Result)))))
(defun shen/profile-results (V5893)
  (shen/let W5894 (shen/shen.get-profile V5893)
            (shen/let W5895 (shen/shen.put-profile V5893 0)
                      (shen/@p V5893 W5894))))
(defun shen/shen.get-profile (V5896)
  (shen/trap-error (shen/get V5896 'profile (shen/value '*property-vector*))
                   (shen/lambda Z5897 0)))
(defun shen/shen.put-profile (V5898 V5899)
  (shen/put V5898 'profile V5899 (shen/value '*property-vector*)))
(defun shen/shen.typecheck (V4887 V4888)
  (shen/let W4889 (shen/shen.extract-vars V4888)
            (shen/let W4890 (shen/shen.rectify-type V4888)
                      (shen/let W4891 (shen/shen.curry V4887)
                                (shen/internal/apply-function-expression
                                 (shen/internal/apply-function-expression
                                  (shen/internal/apply-function-expression
                                   (shen/internal/apply-function-expression
                                    (shen/lambda Z4892
                                                 (shen/lambda Z4893
                                                              (shen/lambda Z4894
                                                                           (shen/lambda
                                                                            Z4895
                                                                            (shen/let
                                                                             W4896
                                                                             (shen/shen.newpv
                                                                              Z4892)
                                                                             (shen/shen.gc
                                                                              Z4892
                                                                              (shen/do
                                                                               (shen/shen.incinfs)
                                                                               (shen/shen.insert-prolog-variables
                                                                                (shen/receive
                                                                                 (shen/shen.deref
                                                                                  W4889
                                                                                  Z4892))
                                                                                (shen/receive
                                                                                 (shen/shen.deref
                                                                                  W4890
                                                                                  Z4892))
                                                                                W4896
                                                                                Z4892
                                                                                Z4893
                                                                                Z4894
                                                                                (shen/freeze
                                                                                 (shen/shen.toplevel-forms
                                                                                  (shen/receive
                                                                                   (shen/shen.deref
                                                                                    W4891
                                                                                    Z4892))
                                                                                  W4896
                                                                                  Z4892
                                                                                  Z4893
                                                                                  Z4894
                                                                                  (shen/freeze
                                                                                   (shen/return
                                                                                    W4896
                                                                                    Z4892
                                                                                    Z4893
                                                                                    Z4894
                                                                                    Z4895))))))))))))
                                    (list (shen/shen.prolog-vector)))
                                   (list
                                    (shen/@v 'true (shen/@v 0 (shen/vector 0)))))
                                  (list 0))
                                 (list (shen/freeze 'true)))))))
(defun shen/shen.insert-prolog-variables
    (V4897 V4898 V4899 V4900 V4901 V4902 V4903)
  (cl-flet
      ((tail-trampoline (V4897 V4898 V4899 V4900 V4901 V4902 V4903)
         (shen/let W4904
                   (shen/if (shen/shen.unlocked? V4901)
                            (shen/let W4905 (shen/shen.lazyderef V4897 V4900)
                                      (shen/if
                                       (shen/internal/predicate->shen
                                        (null W4905))
                                       (shen/do (shen/shen.incinfs)
                                                (shen/is! V4898 V4899 V4900
                                                          V4901 V4902 V4903))
                                       'false))
                            'false)
                   (shen/if (shen/= W4904 'false)
                            (shen/if (shen/shen.unlocked? V4901)
                                     (shen/let W4906
                                               (shen/shen.lazyderef V4897 V4900)
                                               (shen/if (shen/cons? W4906)
                                                        (shen/let W4907
                                                                  (shen/hd W4906)
                                                                  (shen/let
                                                                   W4908
                                                                   (nthcdr 1
                                                                           W4906)
                                                                   (shen/let
                                                                    W4909
                                                                    (shen/shen.newpv
                                                                     V4900)
                                                                    (shen/shen.gc
                                                                     V4900
                                                                     (shen/do
                                                                      (shen/shen.incinfs)
                                                                      (vector
                                                                       (list
                                                                        W4908
                                                                        (shen/subst
                                                                         (shen/shen.deref
                                                                          W4909
                                                                          V4900)
                                                                         W4907
                                                                         V4898)
                                                                        V4899
                                                                        V4900
                                                                        V4901
                                                                        V4902
                                                                        V4903)))))))
                                                        'false))
                                     'false)
                            W4904))))
    (let
        ((result
          (funcall #'tail-trampoline V4897 V4898 V4899 V4900 V4901 V4902 V4903)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.toplevel-forms (V4910 V4911 V4912 V4913 V4914 V4915)
  (shen/let W4916 (1+ V4914)
            (shen/let W4917
                      (shen/if (shen/shen.unlocked? V4913)
                               (shen/let W4918 (shen/shen.lazyderef V4910 V4912)
                                         (shen/if (shen/cons? W4918)
                                                  (shen/let W4919
                                                            (shen/shen.lazyderef
                                                             (shen/hd W4918)
                                                             V4912)
                                                            (shen/if
                                                             (shen/= W4919
                                                                     'define)
                                                             (shen/let W4920
                                                                       (shen/shen.lazyderef
                                                                        (nthcdr
                                                                         1 W4918)
                                                                        V4912)
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         W4920)
                                                                        (shen/let
                                                                         W4921
                                                                         (shen/hd
                                                                          W4920)
                                                                         (shen/let
                                                                          W4922
                                                                          (nthcdr
                                                                           1
                                                                           W4920)
                                                                          (shen/do
                                                                           (shen/shen.incinfs)
                                                                           (shen/when
                                                                            (shen/shen.type-theory-enabled?)
                                                                            V4912
                                                                            V4913
                                                                            W4916
                                                                            (shen/freeze
                                                                             (shen/shen.cut
                                                                              V4912
                                                                              V4913
                                                                              W4916
                                                                              (shen/freeze
                                                                               (shen/shen.signal-def
                                                                                (shen/value
                                                                                 'shen.*spy*)
                                                                                W4921
                                                                                V4912
                                                                                V4913
                                                                                W4916
                                                                                (shen/freeze
                                                                                 (shen/shen.t*
                                                                                  (append
                                                                                   (list
                                                                                    'define
                                                                                    W4921)
                                                                                   W4922)
                                                                                  V4911
                                                                                  V4912
                                                                                  V4913
                                                                                  W4916
                                                                                  V4915))))))))))
                                                                        'false))
                                                             'false))
                                                  'false))
                               'false)
                      (shen/if (shen/= W4917 'false)
                               (shen/let W4923
                                         (shen/if (shen/shen.unlocked? V4913)
                                                  (shen/do (shen/shen.incinfs)
                                                           (shen/shen.system-S
                                                            (list V4910
                                                                  (shen/intern
                                                                   ":")
                                                                  V4911)
                                                            nil V4912 V4913
                                                            W4916 V4915))
                                                  'false)
                                         (shen/if (shen/= W4923 'false)
                                                  (shen/shen.unlock V4913 W4916)
                                                  W4923))
                               W4917))))
(defun shen/shen.signal-def (V4924 V4925 V4926 V4927 V4928 V4929)
  (shen/let W4930
            (shen/if (shen/shen.unlocked? V4927)
                     (shen/let W4931 (shen/shen.lazyderef V4924 V4926)
                               (shen/if (shen/= W4931 'false)
                                        (shen/do (shen/shen.incinfs)
                                                 (shen/thaw V4929))
                                        'false))
                     'false)
            (shen/if (shen/= W4930 'false)
                     (shen/if (shen/shen.unlocked? V4927)
                              (shen/let W4932 (shen/shen.lazyderef V4924 V4926)
                                        (shen/if (shen/= W4932 'true)
                                                 (shen/let W4933
                                                           (shen/shen.newpv
                                                            V4926)
                                                           (shen/shen.gc V4926
                                                                         (shen/do
                                                                          (shen/shen.incinfs)
                                                                          (shen/is
                                                                           W4933
                                                                           (shen/pr
                                                                            (shen/cn
                                                                             "\ntypechecking (fn "
                                                                             (shen/shen.app
                                                                              (shen/shen.deref
                                                                               V4925
                                                                               V4926)
                                                                              ")\n"
                                                                              'shen.a))
                                                                            (shen/stoutput))
                                                                           V4926
                                                                           V4927
                                                                           V4928
                                                                           V4929))))
                                                 'false))
                              'false)
                     W4930)))
(defun shen/shen.rectify-type (V4934)
  (shen/shen.demodulate (shen/shen.curry-type V4934)))
(defun shen/shen.demodulate (V4935)
  (cl-flet
      ((tail-trampoline (V4935)
         (shen/trap-error
          (shen/let W4936
                    (shen/shen.walk (shen/lambda Z4937 (shen/shen.demod Z4937))
                                    V4935)
                    (shen/if (shen/= W4936 V4935) V4935 (vector (list W4936))))
          (shen/lambda Z4938 V4935))))
    (let ((result (funcall #'tail-trampoline V4935)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.curry-type (V4939)
  (cl-flet
      ((tail-trampoline (V4939)
         (shen/cond
          ((shen/and (shen/cons? V4939)
                     (shen/and (shen/cons? (nthcdr 1 V4939))
                               (shen/and
                                (shen/= '--> (shen/hd (nthcdr 1 V4939)))
                                (shen/and (shen/cons? (nthcdr 2 V4939))
                                          (shen/and
                                           (shen/cons? (nthcdr 3 V4939))
                                           (shen/= '-->
                                                   (shen/hd (nthcdr 3 V4939))))))))
           (vector (list (list (shen/hd V4939) '--> (nthcdr 2 V4939)))))
          ((shen/and (shen/cons? V4939)
                     (shen/and (shen/cons? (shen/hd V4939))
                               (shen/and
                                (shen/= 'list (shen/hd (shen/hd V4939)))
                                (shen/and
                                 (shen/cons? (nthcdr 1 (shen/hd V4939)))
                                 (shen/and
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 (shen/hd V4939))))
                                  (shen/and (shen/cons? (nthcdr 1 V4939))
                                            (shen/and
                                             (shen/= '==>
                                                     (shen/hd (nthcdr 1 V4939)))
                                             (shen/and
                                              (shen/cons? (nthcdr 2 V4939))
                                              (shen/internal/predicate->shen
                                               (null (nthcdr 3 V4939)))))))))))
           (vector
            (list
             (list (shen/hd V4939) '-->
                   (append (list 'str (shen/hd V4939)) (nthcdr 2 V4939))))))
          ((shen/and (shen/cons? V4939)
                     (shen/and (shen/cons? (nthcdr 1 V4939))
                               (shen/and (shen/= '* (shen/hd (nthcdr 1 V4939)))
                                         (shen/and (shen/cons? (nthcdr 2 V4939))
                                                   (shen/and
                                                    (shen/cons? (nthcdr 3 V4939))
                                                    (shen/= '*
                                                            (shen/hd
                                                             (nthcdr 3 V4939))))))))
           (vector (list (list (shen/hd V4939) '* (nthcdr 2 V4939)))))
          ((shen/cons? V4939)
           (shen/map (shen/lambda Z4940 (shen/shen.curry-type Z4940)) V4939))
          (shen/true V4939))))
    (let ((result (funcall #'tail-trampoline V4939)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.curry (V4941)
  (cl-flet
      ((tail-trampoline (V4941)
         (shen/cond
          ((shen/and (shen/cons? V4941)
                     (shen/and (shen/= 'define (shen/hd V4941))
                               (shen/cons? (nthcdr 1 V4941))))
           V4941)
          ((shen/and (shen/cons? V4941)
                     (shen/and (shen/= 'type (shen/hd V4941))
                               (shen/and (shen/cons? (nthcdr 1 V4941))
                                         (shen/and (shen/cons? (nthcdr 2 V4941))
                                                   (shen/internal/predicate->shen
                                                    (null (nthcdr 3 V4941)))))))
           (append (list 'type (shen/shen.curry (shen/hd (nthcdr 1 V4941))))
                   (nthcdr 2 V4941)))
          ((shen/and (shen/cons? V4941)
                     (shen/and (shen/= 'input+ (shen/hd V4941))
                               (shen/and (shen/cons? (nthcdr 1 V4941))
                                         (shen/and (shen/cons? (nthcdr 2 V4941))
                                                   (shen/internal/predicate->shen
                                                    (null (nthcdr 3 V4941)))))))
           (list 'input+ (shen/hd (nthcdr 1 V4941))
                 (shen/shen.curry (shen/hd (nthcdr 2 V4941)))))
          ((shen/and (shen/cons? V4941) (shen/shen.special? (shen/hd V4941)))
           (append (list (shen/hd V4941))
                   (shen/map (shen/lambda Z4942 (shen/shen.curry Z4942))
                             (nthcdr 1 V4941))))
          ((shen/and (shen/cons? V4941)
                     (shen/shen.extraspecial? (shen/hd V4941)))
           V4941)
          ((shen/and (shen/cons? V4941)
                     (shen/and (shen/cons? (nthcdr 1 V4941))
                               (shen/cons? (nthcdr 2 V4941))))
           (vector
            (list
             (append (list (list (shen/hd V4941) (shen/hd (nthcdr 1 V4941))))
                     (nthcdr 2 V4941)))))
          ((shen/and (shen/cons? V4941)
                     (shen/and (shen/cons? (nthcdr 1 V4941))
                               (shen/internal/predicate->shen
                                (null (nthcdr 2 V4941)))))
           (list (shen/shen.curry (shen/hd V4941))
                 (shen/shen.curry (shen/hd (nthcdr 1 V4941)))))
          (shen/true V4941))))
    (let ((result (funcall #'tail-trampoline V4941)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.special? (V4943)
  (shen/element? V4943 (shen/value 'shen.*special*)))
(defun shen/shen.extraspecial? (V4944)
  (shen/element? V4944 (shen/value 'shen.*extraspecial*)))
(defun shen/shen.system-S (V4945 V4946 V4947 V4948 V4949 V4950)
  (shen/let W4951 (1+ V4949)
            (shen/let W4952
                      (shen/if (shen/shen.unlocked? V4948)
                               (shen/do (shen/shen.incinfs)
                                        (shen/when (shen/shen.maxinfexceeded?)
                                                   V4947 V4948 W4951 V4950))
                               'false)
                      (shen/if (shen/= W4952 'false)
                               (shen/let W4953
                                         (shen/if (shen/shen.unlocked? V4948)
                                                  (shen/let W4954
                                                            (shen/shen.lazyderef
                                                             V4945 V4947)
                                                            (shen/if
                                                             (shen/cons? W4954)
                                                             (shen/let W4955
                                                                       (shen/hd
                                                                        W4954)
                                                                       (shen/let
                                                                        W4956
                                                                        (shen/shen.lazyderef
                                                                         (nthcdr
                                                                          1
                                                                          W4954)
                                                                         V4947)
                                                                        (shen/if
                                                                         (shen/cons?
                                                                          W4956)
                                                                         (shen/let
                                                                          W4957
                                                                          (shen/hd
                                                                           W4956)
                                                                          (shen/let
                                                                           W4958
                                                                           (shen/shen.lazyderef
                                                                            (nthcdr
                                                                             1
                                                                             W4956)
                                                                            V4947)
                                                                           (shen/if
                                                                            (shen/cons?
                                                                             W4958)
                                                                            (shen/let
                                                                             W4959
                                                                             (shen/hd
                                                                              W4958)
                                                                             (shen/let
                                                                              W4960
                                                                              (shen/shen.lazyderef
                                                                               (nthcdr
                                                                                1
                                                                                W4958)
                                                                               V4947)
                                                                              (shen/if
                                                                               (shen/internal/predicate->shen
                                                                                (null
                                                                                 W4960))
                                                                               (shen/do
                                                                                (shen/shen.incinfs)
                                                                                (shen/when
                                                                                 (shen/=
                                                                                  (shen/shen.deref
                                                                                   W4957
                                                                                   V4947)
                                                                                  (shen/intern
                                                                                   ":"))
                                                                                 V4947
                                                                                 V4948
                                                                                 W4951
                                                                                 (shen/freeze
                                                                                  (shen/when
                                                                                   (shen/shen.type-theory-enabled?)
                                                                                   V4947
                                                                                   V4948
                                                                                   W4951
                                                                                   (shen/freeze
                                                                                    (shen/shen.cut
                                                                                     V4947
                                                                                     V4948
                                                                                     W4951
                                                                                     (shen/freeze
                                                                                      (shen/shen.system-S-h
                                                                                       W4955
                                                                                       W4959
                                                                                       V4946
                                                                                       V4947
                                                                                       V4948
                                                                                       W4951
                                                                                       V4950))))))))
                                                                               'false)))
                                                                            'false)))
                                                                         'false)))
                                                             'false))
                                                  'false)
                                         (shen/if (shen/= W4953 'false)
                                                  (shen/let W4961
                                                            (shen/if
                                                             (shen/shen.unlocked?
                                                              V4948)
                                                             (shen/do
                                                              (shen/shen.incinfs)
                                                              (shen/when
                                                               (shen/value
                                                                'shen.*spy*)
                                                               V4947 V4948 W4951
                                                               (shen/freeze
                                                                (shen/shen.show
                                                                 V4945 V4946
                                                                 V4947 V4948
                                                                 W4951 V4950))))
                                                             'false)
                                                            (shen/if
                                                             (shen/= W4961
                                                                     'false)
                                                             (shen/let W4962
                                                                       (shen/if
                                                                        (shen/shen.unlocked?
                                                                         V4948)
                                                                        (shen/do
                                                                         (shen/shen.incinfs)
                                                                         (shen/shen.search-user-datatypes
                                                                          V4945
                                                                          V4946
                                                                          (shen/value
                                                                           'shen.*datatypes*)
                                                                          V4947
                                                                          V4948
                                                                          W4951
                                                                          V4950))
                                                                        'false)
                                                                       (shen/if
                                                                        (shen/=
                                                                         W4962
                                                                         'false)
                                                                        (shen/shen.unlock
                                                                         V4948
                                                                         W4951)
                                                                        W4962))
                                                             W4961))
                                                  W4953))
                               W4952))))
(defun shen/shen.show (V4969 V4970 V4971 V4972 V4973 V4974)
  (shen/do (shen/shen.line)
           (shen/do (shen/shen.show-p (shen/shen.deref V4969 V4971))
                    (shen/do (shen/nl 2)
                             (shen/do
                              (shen/shen.show-assumptions
                               (shen/shen.deref V4970 V4971) 1)
                              (shen/do (shen/shen.pause-for-user) 'false))))))
(defun shen/shen.line nil
  (shen/let W4975 (shen/inferences)
            (shen/pr
             (shen/cn
              "____________________________________________________________ "
              (shen/shen.app W4975
                             (shen/cn " inference"
                                      (shen/shen.app
                                       (shen/if (shen/= 1 W4975) "" "s")
                                       " \n?- " 'shen.a))
                             'shen.a))
             (shen/stoutput))))
(defun shen/shen.show-p (V4976)
  (shen/cond
   ((shen/and (shen/cons? V4976)
              (shen/and (shen/cons? (nthcdr 1 V4976))
                        (shen/and (shen/cons? (nthcdr 2 V4976))
                                  (shen/and
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 3 V4976)))
                                   (shen/= (shen/hd (nthcdr 1 V4976))
                                           (shen/intern ":"))))))
    (shen/do (shen/shen.prterm (shen/hd V4976))
             (shen/do (shen/pr " : " (shen/stoutput))
                      (shen/pr
                       (shen/shen.app (shen/hd (nthcdr 2 V4976)) "" 'shen.r)
                       (shen/stoutput)))))
   (shen/true (shen/shen.prterm V4976))))
(defun shen/shen.prterm (V4977)
  (shen/cond
   ((shen/and (shen/cons? V4977)
              (shen/and (shen/= 'cons (shen/hd V4977))
                        (shen/and (shen/cons? (nthcdr 1 V4977))
                                  (shen/and (shen/cons? (nthcdr 2 V4977))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V4977)))))))
    (shen/do (shen/pr "[" (shen/stoutput))
             (shen/do (shen/shen.prterm (shen/hd (nthcdr 1 V4977)))
                      (shen/do (shen/shen.prtl (shen/hd (nthcdr 2 V4977)))
                               (shen/pr "]" (shen/stoutput))))))
   ((shen/cons? V4977)
    (shen/do (shen/pr "(" (shen/stoutput))
             (shen/do (shen/shen.prterm (shen/hd V4977))
                      (shen/do
                       (shen/map
                        (shen/lambda Z4978
                                     (shen/do (shen/pr " " (shen/stoutput))
                                              (shen/shen.prterm Z4978)))
                        (nthcdr 1 V4977))
                       (shen/pr ")" (shen/stoutput))))))
   (shen/true (shen/print V4977))))
(defun shen/shen.prtl (V4979)
  (cl-flet
      ((tail-trampoline (V4979)
         (shen/cond ((shen/internal/predicate->shen (null V4979)) "")
                    ((shen/and (shen/cons? V4979)
                               (shen/and (shen/= 'cons (shen/hd V4979))
                                         (shen/and (shen/cons? (nthcdr 1 V4979))
                                                   (shen/and
                                                    (shen/cons? (nthcdr 2 V4979))
                                                    (shen/internal/predicate->shen
                                                     (null (nthcdr 3 V4979)))))))
                     (shen/do (shen/pr " " (shen/stoutput))
                              (shen/do
                               (shen/shen.prterm (shen/hd (nthcdr 1 V4979)))
                               (vector (list (shen/hd (nthcdr 2 V4979)))))))
                    (shen/true
                     (shen/do (shen/pr " | " (shen/stoutput))
                              (shen/shen.prterm V4979))))))
    (let ((result (funcall #'tail-trampoline V4979)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.show-assumptions (V4986 V4987)
  (cl-flet
      ((tail-trampoline (V4986 V4987)
         (shen/cond
          ((shen/internal/predicate->shen (null V4986))
           (shen/pr "\n> " (shen/stoutput)))
          ((shen/cons? V4986)
           (shen/do (shen/pr (shen/shen.app V4987 ". " 'shen.a) (shen/stoutput))
                    (shen/do (shen/shen.show-p (shen/hd V4986))
                             (shen/do (shen/nl 1)
                                      (vector (list (nthcdr 1 V4986) (1+ V4987)))))))
          (shen/true
           (shen/simple-error "implementation error in shen.show-assumptions")))))
    (let ((result (funcall #'tail-trampoline V4986 V4987)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.pause-for-user nil
  (shen/let W4988 (shen/read-byte (shen/stinput))
            (shen/if (shen/= W4988 94) (shen/simple-error "input aborted\n")
                     (shen/nl 1))))
(defun shen/shen.type-theory-enabled? nil
  (shen/value 'shen.*shen-type-theory-enabled?*))
(defun shen/shen.maxinfexceeded? nil
  (shen/if (shen/> (shen/inferences) (shen/value 'shen.*maxinferences*))
           (shen/simple-error "maximum inferences exceeded") 'false))
(defun shen/shen.system-S-h (V4989 V4990 V4991 V4992 V4993 V4994 V4995)
  (shen/let W4996 (1+ V4994)
            (shen/let W4997
                      (shen/if (shen/shen.unlocked? V4993)
                               (shen/do (shen/shen.incinfs)
                                        (shen/when (shen/value 'shen.*spy*)
                                                   V4992 V4993 W4996
                                                   (shen/freeze
                                                    (shen/shen.show
                                                     (list V4989
                                                           (shen/intern ":")
                                                           V4990)
                                                     V4991 V4992 V4993 W4996
                                                     V4995))))
                               'false)
                      (shen/if (shen/= W4997 'false)
                               (shen/let W4998
                                         (shen/if (shen/shen.unlocked? V4993)
                                                  (shen/do (shen/shen.incinfs)
                                                           (shen/when
                                                            (shen/not
                                                             (shen/cons?
                                                              (shen/shen.lazyderef
                                                               V4989 V4992)))
                                                            V4992 V4993 W4996
                                                            (shen/freeze
                                                             (shen/shen.primitive
                                                              V4989 V4990 V4992
                                                              V4993 W4996 V4995))))
                                                  'false)
                                         (shen/if (shen/= W4998 'false)
                                                  (shen/let W4999
                                                            (shen/if
                                                             (shen/shen.unlocked?
                                                              V4993)
                                                             (shen/do
                                                              (shen/shen.incinfs)
                                                              (shen/shen.by-hypothesis
                                                               V4989 V4990 V4991
                                                               V4992 V4993 W4996
                                                               V4995))
                                                             'false)
                                                            (shen/if
                                                             (shen/= W4999
                                                                     'false)
                                                             (shen/let W5000
                                                                       (shen/if
                                                                        (shen/shen.unlocked?
                                                                         V4993)
                                                                        (shen/let
                                                                         W5001
                                                                         (shen/shen.lazyderef
                                                                          V4989
                                                                          V4992)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5001)
                                                                          (shen/let
                                                                           W5002
                                                                           (shen/hd
                                                                            W5001)
                                                                           (shen/let
                                                                            W5003
                                                                            (shen/shen.lazyderef
                                                                             (nthcdr
                                                                              1
                                                                              W5001)
                                                                             V4992)
                                                                            (shen/if
                                                                             (shen/internal/predicate->shen
                                                                              (null
                                                                               W5003))
                                                                             (shen/do
                                                                              (shen/shen.incinfs)
                                                                              (shen/shen.lookupsig
                                                                               W5002
                                                                               (list
                                                                                '-->
                                                                                V4990)
                                                                               V4992
                                                                               V4993
                                                                               W4996
                                                                               V4995))
                                                                             'false)))
                                                                          'false))
                                                                        'false)
                                                                       (shen/if
                                                                        (shen/=
                                                                         W5000
                                                                         'false)
                                                                        (shen/let
                                                                         W5004
                                                                         (shen/if
                                                                          (shen/shen.unlocked?
                                                                           V4993)
                                                                          (shen/let
                                                                           W5005
                                                                           (shen/shen.lazyderef
                                                                            V4989
                                                                            V4992)
                                                                           (shen/if
                                                                            (shen/cons?
                                                                             W5005)
                                                                            (shen/let
                                                                             W5006
                                                                             (shen/shen.lazyderef
                                                                              (shen/hd
                                                                               W5005)
                                                                              V4992)
                                                                             (shen/if
                                                                              (shen/=
                                                                               W5006
                                                                               'fn)
                                                                              (shen/let
                                                                               W5007
                                                                               (shen/shen.lazyderef
                                                                                (nthcdr
                                                                                 1
                                                                                 W5005)
                                                                                V4992)
                                                                               (shen/if
                                                                                (shen/cons?
                                                                                 W5007)
                                                                                (shen/let
                                                                                 W5008
                                                                                 (shen/hd
                                                                                  W5007)
                                                                                 (shen/let
                                                                                  W5009
                                                                                  (shen/shen.lazyderef
                                                                                   (nthcdr
                                                                                    1
                                                                                    W5007)
                                                                                   V4992)
                                                                                  (shen/if
                                                                                   (shen/internal/predicate->shen
                                                                                    (null
                                                                                     W5009))
                                                                                   (shen/do
                                                                                    (shen/shen.incinfs)
                                                                                    (shen/shen.lookupsig
                                                                                     W5008
                                                                                     V4990
                                                                                     V4992
                                                                                     V4993
                                                                                     W4996
                                                                                     V4995))
                                                                                   'false)))
                                                                                'false))
                                                                              'false))
                                                                            'false))
                                                                          'false)
                                                                         (shen/if
                                                                          (shen/=
                                                                           W5004
                                                                           'false)
                                                                          (shen/let
                                                                           W5010
                                                                           (shen/if
                                                                            (shen/shen.unlocked?
                                                                             V4993)
                                                                            (shen/let
                                                                             W5011
                                                                             (shen/shen.lazyderef
                                                                              V4989
                                                                              V4992)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5011)
                                                                              (shen/let
                                                                               W5012
                                                                               (shen/hd
                                                                                W5011)
                                                                               (shen/let
                                                                                W5013
                                                                                (shen/shen.lazyderef
                                                                                 (nthcdr
                                                                                  1
                                                                                  W5011)
                                                                                 V4992)
                                                                                (shen/if
                                                                                 (shen/cons?
                                                                                  W5013)
                                                                                 (shen/let
                                                                                  W5014
                                                                                  (shen/hd
                                                                                   W5013)
                                                                                  (shen/let
                                                                                   W5015
                                                                                   (shen/shen.lazyderef
                                                                                    (nthcdr
                                                                                     1
                                                                                     W5013)
                                                                                    V4992)
                                                                                   (shen/if
                                                                                    (shen/internal/predicate->shen
                                                                                     (null
                                                                                      W5015))
                                                                                    (shen/let
                                                                                     W5016
                                                                                     (shen/shen.newpv
                                                                                      V4992)
                                                                                     (shen/shen.gc
                                                                                      V4992
                                                                                      (shen/do
                                                                                       (shen/shen.incinfs)
                                                                                       (shen/when
                                                                                        (shen/not
                                                                                         (shen/cons?
                                                                                          (shen/shen.lazyderef
                                                                                           W5012
                                                                                           V4992)))
                                                                                        V4992
                                                                                        V4993
                                                                                        W4996
                                                                                        (shen/freeze
                                                                                         (shen/shen.lookupsig
                                                                                          W5012
                                                                                          (list
                                                                                           W5016
                                                                                           '-->
                                                                                           V4990)
                                                                                          V4992
                                                                                          V4993
                                                                                          W4996
                                                                                          (shen/freeze
                                                                                           (shen/shen.system-S-h
                                                                                            W5014
                                                                                            W5016
                                                                                            V4991
                                                                                            V4992
                                                                                            V4993
                                                                                            W4996
                                                                                            V4995))))))))
                                                                                    'false)))
                                                                                 'false)))
                                                                              'false))
                                                                            'false)
                                                                           (shen/if
                                                                            (shen/=
                                                                             W5010
                                                                             'false)
                                                                            (shen/let
                                                                             W5017
                                                                             (shen/if
                                                                              (shen/shen.unlocked?
                                                                               V4993)
                                                                              (shen/let
                                                                               W5018
                                                                               (shen/shen.lazyderef
                                                                                V4989
                                                                                V4992)
                                                                               (shen/if
                                                                                (shen/cons?
                                                                                 W5018)
                                                                                (shen/let
                                                                                 W5019
                                                                                 (shen/hd
                                                                                  W5018)
                                                                                 (shen/let
                                                                                  W5020
                                                                                  (shen/shen.lazyderef
                                                                                   (nthcdr
                                                                                    1
                                                                                    W5018)
                                                                                   V4992)
                                                                                  (shen/if
                                                                                   (shen/cons?
                                                                                    W5020)
                                                                                   (shen/let
                                                                                    W5021
                                                                                    (shen/hd
                                                                                     W5020)
                                                                                    (shen/let
                                                                                     W5022
                                                                                     (shen/shen.lazyderef
                                                                                      (nthcdr
                                                                                       1
                                                                                       W5020)
                                                                                      V4992)
                                                                                     (shen/if
                                                                                      (shen/internal/predicate->shen
                                                                                       (null
                                                                                        W5022))
                                                                                      (shen/let
                                                                                       W5023
                                                                                       (shen/shen.newpv
                                                                                        V4992)
                                                                                       (shen/shen.gc
                                                                                        V4992
                                                                                        (shen/do
                                                                                         (shen/shen.incinfs)
                                                                                         (shen/shen.system-S-h
                                                                                          W5019
                                                                                          (list
                                                                                           W5023
                                                                                           '-->
                                                                                           V4990)
                                                                                          V4991
                                                                                          V4992
                                                                                          V4993
                                                                                          W4996
                                                                                          (shen/freeze
                                                                                           (shen/shen.system-S-h
                                                                                            W5021
                                                                                            W5023
                                                                                            V4991
                                                                                            V4992
                                                                                            V4993
                                                                                            W4996
                                                                                            V4995))))))
                                                                                      'false)))
                                                                                   'false)))
                                                                                'false))
                                                                              'false)
                                                                             (shen/if
                                                                              (shen/=
                                                                               W5017
                                                                               'false)
                                                                              (shen/let
                                                                               W5024
                                                                               (shen/if
                                                                                (shen/shen.unlocked?
                                                                                 V4993)
                                                                                (shen/let
                                                                                 W5025
                                                                                 (shen/shen.lazyderef
                                                                                  V4989
                                                                                  V4992)
                                                                                 (shen/if
                                                                                  (shen/cons?
                                                                                   W5025)
                                                                                  (shen/let
                                                                                   W5026
                                                                                   (shen/shen.lazyderef
                                                                                    (shen/hd
                                                                                     W5025)
                                                                                    V4992)
                                                                                   (shen/if
                                                                                    (shen/=
                                                                                     W5026
                                                                                     'cons)
                                                                                    (shen/let
                                                                                     W5027
                                                                                     (shen/shen.lazyderef
                                                                                      (nthcdr
                                                                                       1
                                                                                       W5025)
                                                                                      V4992)
                                                                                     (shen/if
                                                                                      (shen/cons?
                                                                                       W5027)
                                                                                      (shen/let
                                                                                       W5028
                                                                                       (shen/hd
                                                                                        W5027)
                                                                                       (shen/let
                                                                                        W5029
                                                                                        (shen/shen.lazyderef
                                                                                         (nthcdr
                                                                                          1
                                                                                          W5027)
                                                                                         V4992)
                                                                                        (shen/if
                                                                                         (shen/cons?
                                                                                          W5029)
                                                                                         (shen/let
                                                                                          W5030
                                                                                          (shen/hd
                                                                                           W5029)
                                                                                          (shen/let
                                                                                           W5031
                                                                                           (shen/shen.lazyderef
                                                                                            (nthcdr
                                                                                             1
                                                                                             W5029)
                                                                                            V4992)
                                                                                           (shen/if
                                                                                            (shen/internal/predicate->shen
                                                                                             (null
                                                                                              W5031))
                                                                                            (shen/let
                                                                                             W5032
                                                                                             (shen/shen.lazyderef
                                                                                              V4990
                                                                                              V4992)
                                                                                             (shen/let
                                                                                              W5033
                                                                                              (shen/lambda
                                                                                               Z5034
                                                                                               (shen/do
                                                                                                (shen/shen.incinfs)
                                                                                                (shen/shen.system-S-h
                                                                                                 W5028
                                                                                                 Z5034
                                                                                                 V4991
                                                                                                 V4992
                                                                                                 V4993
                                                                                                 W4996
                                                                                                 (shen/freeze
                                                                                                  (shen/shen.system-S-h
                                                                                                   W5030
                                                                                                   (list
                                                                                                    'list
                                                                                                    Z5034)
                                                                                                   V4991
                                                                                                   V4992
                                                                                                   V4993
                                                                                                   W4996
                                                                                                   V4995)))))
                                                                                              (shen/if
                                                                                               (shen/cons?
                                                                                                W5032)
                                                                                               (shen/let
                                                                                                W5035
                                                                                                (shen/shen.lazyderef
                                                                                                 (shen/hd
                                                                                                  W5032)
                                                                                                 V4992)
                                                                                                (shen/let
                                                                                                 W5036
                                                                                                 (shen/freeze
                                                                                                  (shen/let
                                                                                                   W5037
                                                                                                   (shen/shen.lazyderef
                                                                                                    (nthcdr
                                                                                                     1
                                                                                                     W5032)
                                                                                                    V4992)
                                                                                                   (shen/let
                                                                                                    W5038
                                                                                                    (shen/lambda
                                                                                                     Z5039
                                                                                                     (shen/internal/apply-higher-order-function
                                                                                                      W5033
                                                                                                      (list
                                                                                                       Z5039)))
                                                                                                    (shen/if
                                                                                                     (shen/cons?
                                                                                                      W5037)
                                                                                                     (shen/let
                                                                                                      W5040
                                                                                                      (shen/hd
                                                                                                       W5037)
                                                                                                      (shen/let
                                                                                                       W5041
                                                                                                       (shen/shen.lazyderef
                                                                                                        (nthcdr
                                                                                                         1
                                                                                                         W5037)
                                                                                                        V4992)
                                                                                                       (shen/let
                                                                                                        W5042
                                                                                                        (shen/freeze
                                                                                                         (shen/internal/apply-higher-order-function
                                                                                                          W5038
                                                                                                          (list
                                                                                                           W5040)))
                                                                                                        (shen/if
                                                                                                         (shen/internal/predicate->shen
                                                                                                          (null
                                                                                                           W5041))
                                                                                                         (shen/thaw
                                                                                                          W5042)
                                                                                                         (shen/if
                                                                                                          (shen/shen.pvar?
                                                                                                           W5041)
                                                                                                          (shen/shen.bind!
                                                                                                           W5041
                                                                                                           nil
                                                                                                           V4992
                                                                                                           W5042)
                                                                                                          'false)))))
                                                                                                     (shen/if
                                                                                                      (shen/shen.pvar?
                                                                                                       W5037)
                                                                                                      (shen/let
                                                                                                       W5043
                                                                                                       (shen/shen.newpv
                                                                                                        V4992)
                                                                                                       (shen/shen.gc
                                                                                                        V4992
                                                                                                        (shen/shen.bind!
                                                                                                         W5037
                                                                                                         (list
                                                                                                          W5043)
                                                                                                         V4992
                                                                                                         (shen/freeze
                                                                                                          (shen/internal/apply-higher-order-function
                                                                                                           W5038
                                                                                                           (list
                                                                                                            W5043))))))
                                                                                                      'false)))))
                                                                                                 (shen/if
                                                                                                  (shen/=
                                                                                                   W5035
                                                                                                   'list)
                                                                                                  (shen/thaw
                                                                                                   W5036)
                                                                                                  (shen/if
                                                                                                   (shen/shen.pvar?
                                                                                                    W5035)
                                                                                                   (shen/shen.bind!
                                                                                                    W5035
                                                                                                    'list
                                                                                                    V4992
                                                                                                    W5036)
                                                                                                   'false))))
                                                                                               (shen/if
                                                                                                (shen/shen.pvar?
                                                                                                 W5032)
                                                                                                (shen/let
                                                                                                 W5044
                                                                                                 (shen/shen.newpv
                                                                                                  V4992)
                                                                                                 (shen/shen.gc
                                                                                                  V4992
                                                                                                  (shen/shen.bind!
                                                                                                   W5032
                                                                                                   (list
                                                                                                    'list
                                                                                                    W5044)
                                                                                                   V4992
                                                                                                   (shen/freeze
                                                                                                    (shen/internal/apply-higher-order-function
                                                                                                     W5033
                                                                                                     (list
                                                                                                      W5044))))))
                                                                                                'false))))
                                                                                            'false)))
                                                                                         'false)))
                                                                                      'false))
                                                                                    'false))
                                                                                  'false))
                                                                                'false)
                                                                               (shen/if
                                                                                (shen/=
                                                                                 W5024
                                                                                 'false)
                                                                                (shen/let
                                                                                 W5045
                                                                                 (shen/if
                                                                                  (shen/shen.unlocked?
                                                                                   V4993)
                                                                                  (shen/let
                                                                                   W5046
                                                                                   (shen/shen.lazyderef
                                                                                    V4989
                                                                                    V4992)
                                                                                   (shen/if
                                                                                    (shen/cons?
                                                                                     W5046)
                                                                                    (shen/let
                                                                                     W5047
                                                                                     (shen/shen.lazyderef
                                                                                      (shen/hd
                                                                                       W5046)
                                                                                      V4992)
                                                                                     (shen/if
                                                                                      (shen/=
                                                                                       W5047
                                                                                       '@p)
                                                                                      (shen/let
                                                                                       W5048
                                                                                       (shen/shen.lazyderef
                                                                                        (nthcdr
                                                                                         1
                                                                                         W5046)
                                                                                        V4992)
                                                                                       (shen/if
                                                                                        (shen/cons?
                                                                                         W5048)
                                                                                        (shen/let
                                                                                         W5049
                                                                                         (shen/hd
                                                                                          W5048)
                                                                                         (shen/let
                                                                                          W5050
                                                                                          (shen/shen.lazyderef
                                                                                           (nthcdr
                                                                                            1
                                                                                            W5048)
                                                                                           V4992)
                                                                                          (shen/if
                                                                                           (shen/cons?
                                                                                            W5050)
                                                                                           (shen/let
                                                                                            W5051
                                                                                            (shen/hd
                                                                                             W5050)
                                                                                            (shen/let
                                                                                             W5052
                                                                                             (shen/shen.lazyderef
                                                                                              (nthcdr
                                                                                               1
                                                                                               W5050)
                                                                                              V4992)
                                                                                             (shen/if
                                                                                              (shen/internal/predicate->shen
                                                                                               (null
                                                                                                W5052))
                                                                                              (shen/let
                                                                                               W5053
                                                                                               (shen/shen.lazyderef
                                                                                                V4990
                                                                                                V4992)
                                                                                               (shen/let
                                                                                                W5054
                                                                                                (shen/lambda
                                                                                                 Z5055
                                                                                                 (shen/lambda
                                                                                                  Z5056
                                                                                                  (shen/do
                                                                                                   (shen/shen.incinfs)
                                                                                                   (shen/shen.system-S-h
                                                                                                    W5049
                                                                                                    Z5055
                                                                                                    V4991
                                                                                                    V4992
                                                                                                    V4993
                                                                                                    W4996
                                                                                                    (shen/freeze
                                                                                                     (shen/shen.system-S-h
                                                                                                      W5051
                                                                                                      Z5056
                                                                                                      V4991
                                                                                                      V4992
                                                                                                      V4993
                                                                                                      W4996
                                                                                                      V4995))))))
                                                                                                (shen/if
                                                                                                 (shen/cons?
                                                                                                  W5053)
                                                                                                 (shen/let
                                                                                                  W5057
                                                                                                  (shen/hd
                                                                                                   W5053)
                                                                                                  (shen/let
                                                                                                   W5058
                                                                                                   (shen/shen.lazyderef
                                                                                                    (nthcdr
                                                                                                     1
                                                                                                     W5053)
                                                                                                    V4992)
                                                                                                   (shen/let
                                                                                                    W5059
                                                                                                    (shen/lambda
                                                                                                     Z5060
                                                                                                     (shen/internal/apply-function-expression
                                                                                                      (shen/internal/apply-higher-order-function
                                                                                                       W5054
                                                                                                       (list
                                                                                                        W5057))
                                                                                                      (list
                                                                                                       Z5060)))
                                                                                                    (shen/if
                                                                                                     (shen/cons?
                                                                                                      W5058)
                                                                                                     (shen/let
                                                                                                      W5061
                                                                                                      (shen/shen.lazyderef
                                                                                                       (shen/hd
                                                                                                        W5058)
                                                                                                       V4992)
                                                                                                      (shen/let
                                                                                                       W5062
                                                                                                       (shen/freeze
                                                                                                        (shen/let
                                                                                                         W5063
                                                                                                         (shen/shen.lazyderef
                                                                                                          (nthcdr
                                                                                                           1
                                                                                                           W5058)
                                                                                                          V4992)
                                                                                                         (shen/let
                                                                                                          W5064
                                                                                                          (shen/lambda
                                                                                                           Z5065
                                                                                                           (shen/internal/apply-higher-order-function
                                                                                                            W5059
                                                                                                            (list
                                                                                                             Z5065)))
                                                                                                          (shen/if
                                                                                                           (shen/cons?
                                                                                                            W5063)
                                                                                                           (shen/let
                                                                                                            W5066
                                                                                                            (shen/hd
                                                                                                             W5063)
                                                                                                            (shen/let
                                                                                                             W5067
                                                                                                             (shen/shen.lazyderef
                                                                                                              (nthcdr
                                                                                                               1
                                                                                                               W5063)
                                                                                                              V4992)
                                                                                                             (shen/let
                                                                                                              W5068
                                                                                                              (shen/freeze
                                                                                                               (shen/internal/apply-higher-order-function
                                                                                                                W5064
                                                                                                                (list
                                                                                                                 W5066)))
                                                                                                              (shen/if
                                                                                                               (shen/internal/predicate->shen
                                                                                                                (null
                                                                                                                 W5067))
                                                                                                               (shen/thaw
                                                                                                                W5068)
                                                                                                               (shen/if
                                                                                                                (shen/shen.pvar?
                                                                                                                 W5067)
                                                                                                                (shen/shen.bind!
                                                                                                                 W5067
                                                                                                                 nil
                                                                                                                 V4992
                                                                                                                 W5068)
                                                                                                                'false)))))
                                                                                                           (shen/if
                                                                                                            (shen/shen.pvar?
                                                                                                             W5063)
                                                                                                            (shen/let
                                                                                                             W5069
                                                                                                             (shen/shen.newpv
                                                                                                              V4992)
                                                                                                             (shen/shen.gc
                                                                                                              V4992
                                                                                                              (shen/shen.bind!
                                                                                                               W5063
                                                                                                               (list
                                                                                                                W5069)
                                                                                                               V4992
                                                                                                               (shen/freeze
                                                                                                                (shen/internal/apply-higher-order-function
                                                                                                                 W5064
                                                                                                                 (list
                                                                                                                  W5069))))))
                                                                                                            'false)))))
                                                                                                       (shen/if
                                                                                                        (shen/=
                                                                                                         W5061
                                                                                                         '*)
                                                                                                        (shen/thaw
                                                                                                         W5062)
                                                                                                        (shen/if
                                                                                                         (shen/shen.pvar?
                                                                                                          W5061)
                                                                                                         (shen/shen.bind!
                                                                                                          W5061
                                                                                                          '*
                                                                                                          V4992
                                                                                                          W5062)
                                                                                                         'false))))
                                                                                                     (shen/if
                                                                                                      (shen/shen.pvar?
                                                                                                       W5058)
                                                                                                      (shen/let
                                                                                                       W5070
                                                                                                       (shen/shen.newpv
                                                                                                        V4992)
                                                                                                       (shen/shen.gc
                                                                                                        V4992
                                                                                                        (shen/shen.bind!
                                                                                                         W5058
                                                                                                         (list
                                                                                                          '*
                                                                                                          W5070)
                                                                                                         V4992
                                                                                                         (shen/freeze
                                                                                                          (shen/internal/apply-higher-order-function
                                                                                                           W5059
                                                                                                           (list
                                                                                                            W5070))))))
                                                                                                      'false)))))
                                                                                                 (shen/if
                                                                                                  (shen/shen.pvar?
                                                                                                   W5053)
                                                                                                  (shen/let
                                                                                                   W5071
                                                                                                   (shen/shen.newpv
                                                                                                    V4992)
                                                                                                   (shen/shen.gc
                                                                                                    V4992
                                                                                                    (shen/let
                                                                                                     W5072
                                                                                                     (shen/shen.newpv
                                                                                                      V4992)
                                                                                                     (shen/shen.gc
                                                                                                      V4992
                                                                                                      (shen/shen.bind!
                                                                                                       W5053
                                                                                                       (list
                                                                                                        W5071
                                                                                                        '*
                                                                                                        W5072)
                                                                                                       V4992
                                                                                                       (shen/freeze
                                                                                                        (shen/internal/apply-function-expression
                                                                                                         (shen/internal/apply-higher-order-function
                                                                                                          W5054
                                                                                                          (list
                                                                                                           W5071))
                                                                                                         (list
                                                                                                          W5072))))))))
                                                                                                  'false))))
                                                                                              'false)))
                                                                                           'false)))
                                                                                        'false))
                                                                                      'false))
                                                                                    'false))
                                                                                  'false)
                                                                                 (shen/if
                                                                                  (shen/=
                                                                                   W5045
                                                                                   'false)
                                                                                  (shen/let
                                                                                   W5073
                                                                                   (shen/if
                                                                                    (shen/shen.unlocked?
                                                                                     V4993)
                                                                                    (shen/let
                                                                                     W5074
                                                                                     (shen/shen.lazyderef
                                                                                      V4989
                                                                                      V4992)
                                                                                     (shen/if
                                                                                      (shen/cons?
                                                                                       W5074)
                                                                                      (shen/let
                                                                                       W5075
                                                                                       (shen/shen.lazyderef
                                                                                        (shen/hd
                                                                                         W5074)
                                                                                        V4992)
                                                                                       (shen/if
                                                                                        (shen/=
                                                                                         W5075
                                                                                         '@v)
                                                                                        (shen/let
                                                                                         W5076
                                                                                         (shen/shen.lazyderef
                                                                                          (nthcdr
                                                                                           1
                                                                                           W5074)
                                                                                          V4992)
                                                                                         (shen/if
                                                                                          (shen/cons?
                                                                                           W5076)
                                                                                          (shen/let
                                                                                           W5077
                                                                                           (shen/hd
                                                                                            W5076)
                                                                                           (shen/let
                                                                                            W5078
                                                                                            (shen/shen.lazyderef
                                                                                             (nthcdr
                                                                                              1
                                                                                              W5076)
                                                                                             V4992)
                                                                                            (shen/if
                                                                                             (shen/cons?
                                                                                              W5078)
                                                                                             (shen/let
                                                                                              W5079
                                                                                              (shen/hd
                                                                                               W5078)
                                                                                              (shen/let
                                                                                               W5080
                                                                                               (shen/shen.lazyderef
                                                                                                (nthcdr
                                                                                                 1
                                                                                                 W5078)
                                                                                                V4992)
                                                                                               (shen/if
                                                                                                (shen/internal/predicate->shen
                                                                                                 (null
                                                                                                  W5080))
                                                                                                (shen/let
                                                                                                 W5081
                                                                                                 (shen/shen.lazyderef
                                                                                                  V4990
                                                                                                  V4992)
                                                                                                 (shen/let
                                                                                                  W5082
                                                                                                  (shen/lambda
                                                                                                   Z5083
                                                                                                   (shen/do
                                                                                                    (shen/shen.incinfs)
                                                                                                    (shen/shen.system-S-h
                                                                                                     W5077
                                                                                                     Z5083
                                                                                                     V4991
                                                                                                     V4992
                                                                                                     V4993
                                                                                                     W4996
                                                                                                     (shen/freeze
                                                                                                      (shen/shen.system-S-h
                                                                                                       W5079
                                                                                                       (list
                                                                                                        'vector
                                                                                                        Z5083)
                                                                                                       V4991
                                                                                                       V4992
                                                                                                       V4993
                                                                                                       W4996
                                                                                                       V4995)))))
                                                                                                  (shen/if
                                                                                                   (shen/cons?
                                                                                                    W5081)
                                                                                                   (shen/let
                                                                                                    W5084
                                                                                                    (shen/shen.lazyderef
                                                                                                     (shen/hd
                                                                                                      W5081)
                                                                                                     V4992)
                                                                                                    (shen/let
                                                                                                     W5085
                                                                                                     (shen/freeze
                                                                                                      (shen/let
                                                                                                       W5086
                                                                                                       (shen/shen.lazyderef
                                                                                                        (nthcdr
                                                                                                         1
                                                                                                         W5081)
                                                                                                        V4992)
                                                                                                       (shen/let
                                                                                                        W5087
                                                                                                        (shen/lambda
                                                                                                         Z5088
                                                                                                         (shen/internal/apply-higher-order-function
                                                                                                          W5082
                                                                                                          (list
                                                                                                           Z5088)))
                                                                                                        (shen/if
                                                                                                         (shen/cons?
                                                                                                          W5086)
                                                                                                         (shen/let
                                                                                                          W5089
                                                                                                          (shen/hd
                                                                                                           W5086)
                                                                                                          (shen/let
                                                                                                           W5090
                                                                                                           (shen/shen.lazyderef
                                                                                                            (nthcdr
                                                                                                             1
                                                                                                             W5086)
                                                                                                            V4992)
                                                                                                           (shen/let
                                                                                                            W5091
                                                                                                            (shen/freeze
                                                                                                             (shen/internal/apply-higher-order-function
                                                                                                              W5087
                                                                                                              (list
                                                                                                               W5089)))
                                                                                                            (shen/if
                                                                                                             (shen/internal/predicate->shen
                                                                                                              (null
                                                                                                               W5090))
                                                                                                             (shen/thaw
                                                                                                              W5091)
                                                                                                             (shen/if
                                                                                                              (shen/shen.pvar?
                                                                                                               W5090)
                                                                                                              (shen/shen.bind!
                                                                                                               W5090
                                                                                                               nil
                                                                                                               V4992
                                                                                                               W5091)
                                                                                                              'false)))))
                                                                                                         (shen/if
                                                                                                          (shen/shen.pvar?
                                                                                                           W5086)
                                                                                                          (shen/let
                                                                                                           W5092
                                                                                                           (shen/shen.newpv
                                                                                                            V4992)
                                                                                                           (shen/shen.gc
                                                                                                            V4992
                                                                                                            (shen/shen.bind!
                                                                                                             W5086
                                                                                                             (list
                                                                                                              W5092)
                                                                                                             V4992
                                                                                                             (shen/freeze
                                                                                                              (shen/internal/apply-higher-order-function
                                                                                                               W5087
                                                                                                               (list
                                                                                                                W5092))))))
                                                                                                          'false)))))
                                                                                                     (shen/if
                                                                                                      (shen/=
                                                                                                       W5084
                                                                                                       'vector)
                                                                                                      (shen/thaw
                                                                                                       W5085)
                                                                                                      (shen/if
                                                                                                       (shen/shen.pvar?
                                                                                                        W5084)
                                                                                                       (shen/shen.bind!
                                                                                                        W5084
                                                                                                        'vector
                                                                                                        V4992
                                                                                                        W5085)
                                                                                                       'false))))
                                                                                                   (shen/if
                                                                                                    (shen/shen.pvar?
                                                                                                     W5081)
                                                                                                    (shen/let
                                                                                                     W5093
                                                                                                     (shen/shen.newpv
                                                                                                      V4992)
                                                                                                     (shen/shen.gc
                                                                                                      V4992
                                                                                                      (shen/shen.bind!
                                                                                                       W5081
                                                                                                       (list
                                                                                                        'vector
                                                                                                        W5093)
                                                                                                       V4992
                                                                                                       (shen/freeze
                                                                                                        (shen/internal/apply-higher-order-function
                                                                                                         W5082
                                                                                                         (list
                                                                                                          W5093))))))
                                                                                                    'false))))
                                                                                                'false)))
                                                                                             'false)))
                                                                                          'false))
                                                                                        'false))
                                                                                      'false))
                                                                                    'false)
                                                                                   (shen/if
                                                                                    (shen/=
                                                                                     W5073
                                                                                     'false)
                                                                                    (shen/let
                                                                                     W5094
                                                                                     (shen/if
                                                                                      (shen/shen.unlocked?
                                                                                       V4993)
                                                                                      (shen/let
                                                                                       W5095
                                                                                       (shen/shen.lazyderef
                                                                                        V4989
                                                                                        V4992)
                                                                                       (shen/if
                                                                                        (shen/cons?
                                                                                         W5095)
                                                                                        (shen/let
                                                                                         W5096
                                                                                         (shen/shen.lazyderef
                                                                                          (shen/hd
                                                                                           W5095)
                                                                                          V4992)
                                                                                         (shen/if
                                                                                          (shen/=
                                                                                           W5096
                                                                                           '@s)
                                                                                          (shen/let
                                                                                           W5097
                                                                                           (shen/shen.lazyderef
                                                                                            (nthcdr
                                                                                             1
                                                                                             W5095)
                                                                                            V4992)
                                                                                           (shen/if
                                                                                            (shen/cons?
                                                                                             W5097)
                                                                                            (shen/let
                                                                                             W5098
                                                                                             (shen/hd
                                                                                              W5097)
                                                                                             (shen/let
                                                                                              W5099
                                                                                              (shen/shen.lazyderef
                                                                                               (nthcdr
                                                                                                1
                                                                                                W5097)
                                                                                               V4992)
                                                                                              (shen/if
                                                                                               (shen/cons?
                                                                                                W5099)
                                                                                               (shen/let
                                                                                                W5100
                                                                                                (shen/hd
                                                                                                 W5099)
                                                                                                (shen/let
                                                                                                 W5101
                                                                                                 (shen/shen.lazyderef
                                                                                                  (nthcdr
                                                                                                   1
                                                                                                   W5099)
                                                                                                  V4992)
                                                                                                 (shen/if
                                                                                                  (shen/internal/predicate->shen
                                                                                                   (null
                                                                                                    W5101))
                                                                                                  (shen/let
                                                                                                   W5102
                                                                                                   (shen/shen.lazyderef
                                                                                                    V4990
                                                                                                    V4992)
                                                                                                   (shen/let
                                                                                                    W5103
                                                                                                    (shen/freeze
                                                                                                     (shen/do
                                                                                                      (shen/shen.incinfs)
                                                                                                      (shen/shen.system-S-h
                                                                                                       W5098
                                                                                                       'string
                                                                                                       V4991
                                                                                                       V4992
                                                                                                       V4993
                                                                                                       W4996
                                                                                                       (shen/freeze
                                                                                                        (shen/shen.system-S-h
                                                                                                         W5100
                                                                                                         'string
                                                                                                         V4991
                                                                                                         V4992
                                                                                                         V4993
                                                                                                         W4996
                                                                                                         V4995)))))
                                                                                                    (shen/if
                                                                                                     (shen/=
                                                                                                      W5102
                                                                                                      'string)
                                                                                                     (shen/thaw
                                                                                                      W5103)
                                                                                                     (shen/if
                                                                                                      (shen/shen.pvar?
                                                                                                       W5102)
                                                                                                      (shen/shen.bind!
                                                                                                       W5102
                                                                                                       'string
                                                                                                       V4992
                                                                                                       W5103)
                                                                                                      'false))))
                                                                                                  'false)))
                                                                                               'false)))
                                                                                            'false))
                                                                                          'false))
                                                                                        'false))
                                                                                      'false)
                                                                                     (shen/if
                                                                                      (shen/=
                                                                                       W5094
                                                                                       'false)
                                                                                      (shen/let
                                                                                       W5104
                                                                                       (shen/if
                                                                                        (shen/shen.unlocked?
                                                                                         V4993)
                                                                                        (shen/let
                                                                                         W5105
                                                                                         (shen/shen.lazyderef
                                                                                          V4989
                                                                                          V4992)
                                                                                         (shen/if
                                                                                          (shen/cons?
                                                                                           W5105)
                                                                                          (shen/let
                                                                                           W5106
                                                                                           (shen/shen.lazyderef
                                                                                            (shen/hd
                                                                                             W5105)
                                                                                            V4992)
                                                                                           (shen/if
                                                                                            (shen/=
                                                                                             W5106
                                                                                             'lambda)
                                                                                            (shen/let
                                                                                             W5107
                                                                                             (shen/shen.lazyderef
                                                                                              (nthcdr
                                                                                               1
                                                                                               W5105)
                                                                                              V4992)
                                                                                             (shen/if
                                                                                              (shen/cons?
                                                                                               W5107)
                                                                                              (shen/let
                                                                                               W5108
                                                                                               (shen/hd
                                                                                                W5107)
                                                                                               (shen/let
                                                                                                W5109
                                                                                                (shen/shen.lazyderef
                                                                                                 (nthcdr
                                                                                                  1
                                                                                                  W5107)
                                                                                                 V4992)
                                                                                                (shen/if
                                                                                                 (shen/cons?
                                                                                                  W5109)
                                                                                                 (shen/let
                                                                                                  W5110
                                                                                                  (shen/hd
                                                                                                   W5109)
                                                                                                  (shen/let
                                                                                                   W5111
                                                                                                   (shen/shen.lazyderef
                                                                                                    (nthcdr
                                                                                                     1
                                                                                                     W5109)
                                                                                                    V4992)
                                                                                                   (shen/if
                                                                                                    (shen/internal/predicate->shen
                                                                                                     (null
                                                                                                      W5111))
                                                                                                    (shen/let
                                                                                                     W5112
                                                                                                     (shen/shen.lazyderef
                                                                                                      V4990
                                                                                                      V4992)
                                                                                                     (shen/let
                                                                                                      W5113
                                                                                                      (shen/lambda
                                                                                                       Z5114
                                                                                                       (shen/lambda
                                                                                                        Z5115
                                                                                                        (shen/let
                                                                                                         W5116
                                                                                                         (shen/shen.newpv
                                                                                                          V4992)
                                                                                                         (shen/shen.gc
                                                                                                          V4992
                                                                                                          (shen/let
                                                                                                           W5117
                                                                                                           (shen/shen.newpv
                                                                                                            V4992)
                                                                                                           (shen/shen.gc
                                                                                                            V4992
                                                                                                            (shen/do
                                                                                                             (shen/shen.incinfs)
                                                                                                             (shen/bind
                                                                                                              W5117
                                                                                                              (shen/shen.freshterm
                                                                                                               (shen/shen.lazyderef
                                                                                                                W5108
                                                                                                                V4992))
                                                                                                              V4992
                                                                                                              V4993
                                                                                                              W4996
                                                                                                              (shen/freeze
                                                                                                               (shen/bind
                                                                                                                W5116
                                                                                                                (shen/shen.beta
                                                                                                                 (shen/shen.lazyderef
                                                                                                                  W5108
                                                                                                                  V4992)
                                                                                                                 (shen/shen.deref
                                                                                                                  W5117
                                                                                                                  V4992)
                                                                                                                 (shen/shen.deref
                                                                                                                  W5110
                                                                                                                  V4992))
                                                                                                                V4992
                                                                                                                V4993
                                                                                                                W4996
                                                                                                                (shen/freeze
                                                                                                                 (shen/shen.system-S-h
                                                                                                                  W5116
                                                                                                                  Z5115
                                                                                                                  (append
                                                                                                                   (list
                                                                                                                    (list
                                                                                                                     W5117
                                                                                                                     (shen/intern
                                                                                                                      ":")
                                                                                                                     Z5114))
                                                                                                                   V4991)
                                                                                                                  V4992
                                                                                                                  V4993
                                                                                                                  W4996
                                                                                                                  V4995))))))))))))
                                                                                                      (shen/if
                                                                                                       (shen/cons?
                                                                                                        W5112)
                                                                                                       (shen/let
                                                                                                        W5118
                                                                                                        (shen/hd
                                                                                                         W5112)
                                                                                                        (shen/let
                                                                                                         W5119
                                                                                                         (shen/shen.lazyderef
                                                                                                          (nthcdr
                                                                                                           1
                                                                                                           W5112)
                                                                                                          V4992)
                                                                                                         (shen/let
                                                                                                          W5120
                                                                                                          (shen/lambda
                                                                                                           Z5121
                                                                                                           (shen/internal/apply-function-expression
                                                                                                            (shen/internal/apply-higher-order-function
                                                                                                             W5113
                                                                                                             (list
                                                                                                              W5118))
                                                                                                            (list
                                                                                                             Z5121)))
                                                                                                          (shen/if
                                                                                                           (shen/cons?
                                                                                                            W5119)
                                                                                                           (shen/let
                                                                                                            W5122
                                                                                                            (shen/shen.lazyderef
                                                                                                             (shen/hd
                                                                                                              W5119)
                                                                                                             V4992)
                                                                                                            (shen/let
                                                                                                             W5123
                                                                                                             (shen/freeze
                                                                                                              (shen/let
                                                                                                               W5124
                                                                                                               (shen/shen.lazyderef
                                                                                                                (nthcdr
                                                                                                                 1
                                                                                                                 W5119)
                                                                                                                V4992)
                                                                                                               (shen/let
                                                                                                                W5125
                                                                                                                (shen/lambda
                                                                                                                 Z5126
                                                                                                                 (shen/internal/apply-higher-order-function
                                                                                                                  W5120
                                                                                                                  (list
                                                                                                                   Z5126)))
                                                                                                                (shen/if
                                                                                                                 (shen/cons?
                                                                                                                  W5124)
                                                                                                                 (shen/let
                                                                                                                  W5127
                                                                                                                  (shen/hd
                                                                                                                   W5124)
                                                                                                                  (shen/let
                                                                                                                   W5128
                                                                                                                   (shen/shen.lazyderef
                                                                                                                    (nthcdr
                                                                                                                     1
                                                                                                                     W5124)
                                                                                                                    V4992)
                                                                                                                   (shen/let
                                                                                                                    W5129
                                                                                                                    (shen/freeze
                                                                                                                     (shen/internal/apply-higher-order-function
                                                                                                                      W5125
                                                                                                                      (list
                                                                                                                       W5127)))
                                                                                                                    (shen/if
                                                                                                                     (shen/internal/predicate->shen
                                                                                                                      (null
                                                                                                                       W5128))
                                                                                                                     (shen/thaw
                                                                                                                      W5129)
                                                                                                                     (shen/if
                                                                                                                      (shen/shen.pvar?
                                                                                                                       W5128)
                                                                                                                      (shen/shen.bind!
                                                                                                                       W5128
                                                                                                                       nil
                                                                                                                       V4992
                                                                                                                       W5129)
                                                                                                                      'false)))))
                                                                                                                 (shen/if
                                                                                                                  (shen/shen.pvar?
                                                                                                                   W5124)
                                                                                                                  (shen/let
                                                                                                                   W5130
                                                                                                                   (shen/shen.newpv
                                                                                                                    V4992)
                                                                                                                   (shen/shen.gc
                                                                                                                    V4992
                                                                                                                    (shen/shen.bind!
                                                                                                                     W5124
                                                                                                                     (list
                                                                                                                      W5130)
                                                                                                                     V4992
                                                                                                                     (shen/freeze
                                                                                                                      (shen/internal/apply-higher-order-function
                                                                                                                       W5125
                                                                                                                       (list
                                                                                                                        W5130))))))
                                                                                                                  'false)))))
                                                                                                             (shen/if
                                                                                                              (shen/=
                                                                                                               W5122
                                                                                                               '-->)
                                                                                                              (shen/thaw
                                                                                                               W5123)
                                                                                                              (shen/if
                                                                                                               (shen/shen.pvar?
                                                                                                                W5122)
                                                                                                               (shen/shen.bind!
                                                                                                                W5122
                                                                                                                '-->
                                                                                                                V4992
                                                                                                                W5123)
                                                                                                               'false))))
                                                                                                           (shen/if
                                                                                                            (shen/shen.pvar?
                                                                                                             W5119)
                                                                                                            (shen/let
                                                                                                             W5131
                                                                                                             (shen/shen.newpv
                                                                                                              V4992)
                                                                                                             (shen/shen.gc
                                                                                                              V4992
                                                                                                              (shen/shen.bind!
                                                                                                               W5119
                                                                                                               (list
                                                                                                                '-->
                                                                                                                W5131)
                                                                                                               V4992
                                                                                                               (shen/freeze
                                                                                                                (shen/internal/apply-higher-order-function
                                                                                                                 W5120
                                                                                                                 (list
                                                                                                                  W5131))))))
                                                                                                            'false)))))
                                                                                                       (shen/if
                                                                                                        (shen/shen.pvar?
                                                                                                         W5112)
                                                                                                        (shen/let
                                                                                                         W5132
                                                                                                         (shen/shen.newpv
                                                                                                          V4992)
                                                                                                         (shen/shen.gc
                                                                                                          V4992
                                                                                                          (shen/let
                                                                                                           W5133
                                                                                                           (shen/shen.newpv
                                                                                                            V4992)
                                                                                                           (shen/shen.gc
                                                                                                            V4992
                                                                                                            (shen/shen.bind!
                                                                                                             W5112
                                                                                                             (list
                                                                                                              W5132
                                                                                                              '-->
                                                                                                              W5133)
                                                                                                             V4992
                                                                                                             (shen/freeze
                                                                                                              (shen/internal/apply-function-expression
                                                                                                               (shen/internal/apply-higher-order-function
                                                                                                                W5113
                                                                                                                (list
                                                                                                                 W5132))
                                                                                                               (list
                                                                                                                W5133))))))))
                                                                                                        'false))))
                                                                                                    'false)))
                                                                                                 'false)))
                                                                                              'false))
                                                                                            'false))
                                                                                          'false))
                                                                                        'false)
                                                                                       (shen/if
                                                                                        (shen/=
                                                                                         W5104
                                                                                         'false)
                                                                                        (shen/let
                                                                                         W5134
                                                                                         (shen/if
                                                                                          (shen/shen.unlocked?
                                                                                           V4993)
                                                                                          (shen/let
                                                                                           W5135
                                                                                           (shen/shen.lazyderef
                                                                                            V4989
                                                                                            V4992)
                                                                                           (shen/if
                                                                                            (shen/cons?
                                                                                             W5135)
                                                                                            (shen/let
                                                                                             W5136
                                                                                             (shen/shen.lazyderef
                                                                                              (shen/hd
                                                                                               W5135)
                                                                                              V4992)
                                                                                             (shen/if
                                                                                              (shen/=
                                                                                               W5136
                                                                                               'let)
                                                                                              (shen/let
                                                                                               W5137
                                                                                               (shen/shen.lazyderef
                                                                                                (nthcdr
                                                                                                 1
                                                                                                 W5135)
                                                                                                V4992)
                                                                                               (shen/if
                                                                                                (shen/cons?
                                                                                                 W5137)
                                                                                                (shen/let
                                                                                                 W5138
                                                                                                 (shen/hd
                                                                                                  W5137)
                                                                                                 (shen/let
                                                                                                  W5139
                                                                                                  (shen/shen.lazyderef
                                                                                                   (nthcdr
                                                                                                    1
                                                                                                    W5137)
                                                                                                   V4992)
                                                                                                  (shen/if
                                                                                                   (shen/cons?
                                                                                                    W5139)
                                                                                                   (shen/let
                                                                                                    W5140
                                                                                                    (shen/hd
                                                                                                     W5139)
                                                                                                    (shen/let
                                                                                                     W5141
                                                                                                     (shen/shen.lazyderef
                                                                                                      (nthcdr
                                                                                                       1
                                                                                                       W5139)
                                                                                                      V4992)
                                                                                                     (shen/if
                                                                                                      (shen/cons?
                                                                                                       W5141)
                                                                                                      (shen/let
                                                                                                       W5142
                                                                                                       (shen/hd
                                                                                                        W5141)
                                                                                                       (shen/let
                                                                                                        W5143
                                                                                                        (shen/shen.lazyderef
                                                                                                         (nthcdr
                                                                                                          1
                                                                                                          W5141)
                                                                                                         V4992)
                                                                                                        (shen/if
                                                                                                         (shen/internal/predicate->shen
                                                                                                          (null
                                                                                                           W5143))
                                                                                                         (shen/let
                                                                                                          W5144
                                                                                                          (shen/shen.newpv
                                                                                                           V4992)
                                                                                                          (shen/shen.gc
                                                                                                           V4992
                                                                                                           (shen/let
                                                                                                            W5145
                                                                                                            (shen/shen.newpv
                                                                                                             V4992)
                                                                                                            (shen/shen.gc
                                                                                                             V4992
                                                                                                             (shen/let
                                                                                                              W5146
                                                                                                              (shen/shen.newpv
                                                                                                               V4992)
                                                                                                              (shen/shen.gc
                                                                                                               V4992
                                                                                                               (shen/do
                                                                                                                (shen/shen.incinfs)
                                                                                                                (shen/shen.system-S-h
                                                                                                                 W5140
                                                                                                                 W5146
                                                                                                                 V4991
                                                                                                                 V4992
                                                                                                                 V4993
                                                                                                                 W4996
                                                                                                                 (shen/freeze
                                                                                                                  (shen/bind
                                                                                                                   W5145
                                                                                                                   (shen/shen.freshterm
                                                                                                                    (shen/shen.lazyderef
                                                                                                                     W5138
                                                                                                                     V4992))
                                                                                                                   V4992
                                                                                                                   V4993
                                                                                                                   W4996
                                                                                                                   (shen/freeze
                                                                                                                    (shen/bind
                                                                                                                     W5144
                                                                                                                     (shen/shen.beta
                                                                                                                      (shen/shen.lazyderef
                                                                                                                       W5138
                                                                                                                       V4992)
                                                                                                                      (shen/shen.lazyderef
                                                                                                                       W5145
                                                                                                                       V4992)
                                                                                                                      (shen/shen.lazyderef
                                                                                                                       W5142
                                                                                                                       V4992))
                                                                                                                     V4992
                                                                                                                     V4993
                                                                                                                     W4996
                                                                                                                     (shen/freeze
                                                                                                                      (shen/shen.system-S-h
                                                                                                                       W5144
                                                                                                                       V4990
                                                                                                                       (append
                                                                                                                        (list
                                                                                                                         (list
                                                                                                                          W5145
                                                                                                                          (shen/intern
                                                                                                                           ":")
                                                                                                                          W5146))
                                                                                                                        V4991)
                                                                                                                       V4992
                                                                                                                       V4993
                                                                                                                       W4996
                                                                                                                       V4995))))))))))))))
                                                                                                         'false)))
                                                                                                      'false)))
                                                                                                   'false)))
                                                                                                'false))
                                                                                              'false))
                                                                                            'false))
                                                                                          'false)
                                                                                         (shen/if
                                                                                          (shen/=
                                                                                           W5134
                                                                                           'false)
                                                                                          (shen/let
                                                                                           W5147
                                                                                           (shen/if
                                                                                            (shen/shen.unlocked?
                                                                                             V4993)
                                                                                            (shen/let
                                                                                             W5148
                                                                                             (shen/shen.lazyderef
                                                                                              V4989
                                                                                              V4992)
                                                                                             (shen/if
                                                                                              (shen/cons?
                                                                                               W5148)
                                                                                              (shen/let
                                                                                               W5149
                                                                                               (shen/shen.lazyderef
                                                                                                (shen/hd
                                                                                                 W5148)
                                                                                                V4992)
                                                                                               (shen/if
                                                                                                (shen/=
                                                                                                 W5149
                                                                                                 'open)
                                                                                                (shen/let
                                                                                                 W5150
                                                                                                 (shen/shen.lazyderef
                                                                                                  (nthcdr
                                                                                                   1
                                                                                                   W5148)
                                                                                                  V4992)
                                                                                                 (shen/if
                                                                                                  (shen/cons?
                                                                                                   W5150)
                                                                                                  (shen/let
                                                                                                   W5151
                                                                                                   (shen/hd
                                                                                                    W5150)
                                                                                                   (shen/let
                                                                                                    W5152
                                                                                                    (shen/shen.lazyderef
                                                                                                     (nthcdr
                                                                                                      1
                                                                                                      W5150)
                                                                                                     V4992)
                                                                                                    (shen/if
                                                                                                     (shen/cons?
                                                                                                      W5152)
                                                                                                     (shen/let
                                                                                                      W5153
                                                                                                      (shen/hd
                                                                                                       W5152)
                                                                                                      (shen/let
                                                                                                       W5154
                                                                                                       (shen/shen.lazyderef
                                                                                                        (nthcdr
                                                                                                         1
                                                                                                         W5152)
                                                                                                        V4992)
                                                                                                       (shen/if
                                                                                                        (shen/internal/predicate->shen
                                                                                                         (null
                                                                                                          W5154))
                                                                                                        (shen/let
                                                                                                         W5155
                                                                                                         (shen/shen.lazyderef
                                                                                                          V4990
                                                                                                          V4992)
                                                                                                         (shen/let
                                                                                                          W5156
                                                                                                          (shen/lambda
                                                                                                           Z5157
                                                                                                           (shen/do
                                                                                                            (shen/shen.incinfs)
                                                                                                            (shen/is!
                                                                                                             W5153
                                                                                                             Z5157
                                                                                                             V4992
                                                                                                             V4993
                                                                                                             W4996
                                                                                                             (shen/freeze
                                                                                                              (shen/when
                                                                                                               (shen/element?
                                                                                                                (shen/shen.lazyderef
                                                                                                                 Z5157
                                                                                                                 V4992)
                                                                                                                (list
                                                                                                                 'in
                                                                                                                 'out))
                                                                                                               V4992
                                                                                                               V4993
                                                                                                               W4996
                                                                                                               (shen/freeze
                                                                                                                (shen/shen.system-S-h
                                                                                                                 W5151
                                                                                                                 'string
                                                                                                                 V4991
                                                                                                                 V4992
                                                                                                                 V4993
                                                                                                                 W4996
                                                                                                                 V4995)))))))
                                                                                                          (shen/if
                                                                                                           (shen/cons?
                                                                                                            W5155)
                                                                                                           (shen/let
                                                                                                            W5158
                                                                                                            (shen/shen.lazyderef
                                                                                                             (shen/hd
                                                                                                              W5155)
                                                                                                             V4992)
                                                                                                            (shen/let
                                                                                                             W5159
                                                                                                             (shen/freeze
                                                                                                              (shen/let
                                                                                                               W5160
                                                                                                               (shen/shen.lazyderef
                                                                                                                (nthcdr
                                                                                                                 1
                                                                                                                 W5155)
                                                                                                                V4992)
                                                                                                               (shen/let
                                                                                                                W5161
                                                                                                                (shen/lambda
                                                                                                                 Z5162
                                                                                                                 (shen/internal/apply-higher-order-function
                                                                                                                  W5156
                                                                                                                  (list
                                                                                                                   Z5162)))
                                                                                                                (shen/if
                                                                                                                 (shen/cons?
                                                                                                                  W5160)
                                                                                                                 (shen/let
                                                                                                                  W5163
                                                                                                                  (shen/hd
                                                                                                                   W5160)
                                                                                                                  (shen/let
                                                                                                                   W5164
                                                                                                                   (shen/shen.lazyderef
                                                                                                                    (nthcdr
                                                                                                                     1
                                                                                                                     W5160)
                                                                                                                    V4992)
                                                                                                                   (shen/let
                                                                                                                    W5165
                                                                                                                    (shen/freeze
                                                                                                                     (shen/internal/apply-higher-order-function
                                                                                                                      W5161
                                                                                                                      (list
                                                                                                                       W5163)))
                                                                                                                    (shen/if
                                                                                                                     (shen/internal/predicate->shen
                                                                                                                      (null
                                                                                                                       W5164))
                                                                                                                     (shen/thaw
                                                                                                                      W5165)
                                                                                                                     (shen/if
                                                                                                                      (shen/shen.pvar?
                                                                                                                       W5164)
                                                                                                                      (shen/shen.bind!
                                                                                                                       W5164
                                                                                                                       nil
                                                                                                                       V4992
                                                                                                                       W5165)
                                                                                                                      'false)))))
                                                                                                                 (shen/if
                                                                                                                  (shen/shen.pvar?
                                                                                                                   W5160)
                                                                                                                  (shen/let
                                                                                                                   W5166
                                                                                                                   (shen/shen.newpv
                                                                                                                    V4992)
                                                                                                                   (shen/shen.gc
                                                                                                                    V4992
                                                                                                                    (shen/shen.bind!
                                                                                                                     W5160
                                                                                                                     (list
                                                                                                                      W5166)
                                                                                                                     V4992
                                                                                                                     (shen/freeze
                                                                                                                      (shen/internal/apply-higher-order-function
                                                                                                                       W5161
                                                                                                                       (list
                                                                                                                        W5166))))))
                                                                                                                  'false)))))
                                                                                                             (shen/if
                                                                                                              (shen/=
                                                                                                               W5158
                                                                                                               'stream)
                                                                                                              (shen/thaw
                                                                                                               W5159)
                                                                                                              (shen/if
                                                                                                               (shen/shen.pvar?
                                                                                                                W5158)
                                                                                                               (shen/shen.bind!
                                                                                                                W5158
                                                                                                                'stream
                                                                                                                V4992
                                                                                                                W5159)
                                                                                                               'false))))
                                                                                                           (shen/if
                                                                                                            (shen/shen.pvar?
                                                                                                             W5155)
                                                                                                            (shen/let
                                                                                                             W5167
                                                                                                             (shen/shen.newpv
                                                                                                              V4992)
                                                                                                             (shen/shen.gc
                                                                                                              V4992
                                                                                                              (shen/shen.bind!
                                                                                                               W5155
                                                                                                               (list
                                                                                                                'stream
                                                                                                                W5167)
                                                                                                               V4992
                                                                                                               (shen/freeze
                                                                                                                (shen/internal/apply-higher-order-function
                                                                                                                 W5156
                                                                                                                 (list
                                                                                                                  W5167))))))
                                                                                                            'false))))
                                                                                                        'false)))
                                                                                                     'false)))
                                                                                                  'false))
                                                                                                'false))
                                                                                              'false))
                                                                                            'false)
                                                                                           (shen/if
                                                                                            (shen/=
                                                                                             W5147
                                                                                             'false)
                                                                                            (shen/let
                                                                                             W5168
                                                                                             (shen/if
                                                                                              (shen/shen.unlocked?
                                                                                               V4993)
                                                                                              (shen/let
                                                                                               W5169
                                                                                               (shen/shen.lazyderef
                                                                                                V4989
                                                                                                V4992)
                                                                                               (shen/if
                                                                                                (shen/cons?
                                                                                                 W5169)
                                                                                                (shen/let
                                                                                                 W5170
                                                                                                 (shen/shen.lazyderef
                                                                                                  (shen/hd
                                                                                                   W5169)
                                                                                                  V4992)
                                                                                                 (shen/if
                                                                                                  (shen/=
                                                                                                   W5170
                                                                                                   'type)
                                                                                                  (shen/let
                                                                                                   W5171
                                                                                                   (shen/shen.lazyderef
                                                                                                    (nthcdr
                                                                                                     1
                                                                                                     W5169)
                                                                                                    V4992)
                                                                                                   (shen/if
                                                                                                    (shen/cons?
                                                                                                     W5171)
                                                                                                    (shen/let
                                                                                                     W5172
                                                                                                     (shen/hd
                                                                                                      W5171)
                                                                                                     (shen/let
                                                                                                      W5173
                                                                                                      (shen/shen.lazyderef
                                                                                                       (nthcdr
                                                                                                        1
                                                                                                        W5171)
                                                                                                       V4992)
                                                                                                      (shen/if
                                                                                                       (shen/cons?
                                                                                                        W5173)
                                                                                                       (shen/let
                                                                                                        W5174
                                                                                                        (shen/hd
                                                                                                         W5173)
                                                                                                        (shen/let
                                                                                                         W5175
                                                                                                         (shen/shen.lazyderef
                                                                                                          (nthcdr
                                                                                                           1
                                                                                                           W5173)
                                                                                                          V4992)
                                                                                                         (shen/if
                                                                                                          (shen/internal/predicate->shen
                                                                                                           (null
                                                                                                            W5175))
                                                                                                          (shen/do
                                                                                                           (shen/shen.incinfs)
                                                                                                           (shen/shen.cut
                                                                                                            V4992
                                                                                                            V4993
                                                                                                            W4996
                                                                                                            (shen/freeze
                                                                                                             (shen/is!
                                                                                                              (shen/shen.rectify-type
                                                                                                               (shen/shen.deref
                                                                                                                W5174
                                                                                                                V4992))
                                                                                                              V4990
                                                                                                              V4992
                                                                                                              V4993
                                                                                                              W4996
                                                                                                              (shen/freeze
                                                                                                               (shen/shen.system-S-h
                                                                                                                W5172
                                                                                                                V4990
                                                                                                                V4991
                                                                                                                V4992
                                                                                                                V4993
                                                                                                                W4996
                                                                                                                V4995))))))
                                                                                                          'false)))
                                                                                                       'false)))
                                                                                                    'false))
                                                                                                  'false))
                                                                                                'false))
                                                                                              'false)
                                                                                             (shen/if
                                                                                              (shen/=
                                                                                               W5168
                                                                                               'false)
                                                                                              (shen/let
                                                                                               W5176
                                                                                               (shen/if
                                                                                                (shen/shen.unlocked?
                                                                                                 V4993)
                                                                                                (shen/let
                                                                                                 W5177
                                                                                                 (shen/shen.lazyderef
                                                                                                  V4989
                                                                                                  V4992)
                                                                                                 (shen/if
                                                                                                  (shen/cons?
                                                                                                   W5177)
                                                                                                  (shen/let
                                                                                                   W5178
                                                                                                   (shen/shen.lazyderef
                                                                                                    (shen/hd
                                                                                                     W5177)
                                                                                                    V4992)
                                                                                                   (shen/if
                                                                                                    (shen/=
                                                                                                     W5178
                                                                                                     'input+)
                                                                                                    (shen/let
                                                                                                     W5179
                                                                                                     (shen/shen.lazyderef
                                                                                                      (nthcdr
                                                                                                       1
                                                                                                       W5177)
                                                                                                      V4992)
                                                                                                     (shen/if
                                                                                                      (shen/cons?
                                                                                                       W5179)
                                                                                                      (shen/let
                                                                                                       W5180
                                                                                                       (shen/hd
                                                                                                        W5179)
                                                                                                       (shen/let
                                                                                                        W5181
                                                                                                        (shen/shen.lazyderef
                                                                                                         (nthcdr
                                                                                                          1
                                                                                                          W5179)
                                                                                                         V4992)
                                                                                                        (shen/if
                                                                                                         (shen/cons?
                                                                                                          W5181)
                                                                                                         (shen/let
                                                                                                          W5182
                                                                                                          (shen/hd
                                                                                                           W5181)
                                                                                                          (shen/let
                                                                                                           W5183
                                                                                                           (shen/shen.lazyderef
                                                                                                            (nthcdr
                                                                                                             1
                                                                                                             W5181)
                                                                                                            V4992)
                                                                                                           (shen/if
                                                                                                            (shen/internal/predicate->shen
                                                                                                             (null
                                                                                                              W5183))
                                                                                                            (shen/do
                                                                                                             (shen/shen.incinfs)
                                                                                                             (shen/is!
                                                                                                              V4990
                                                                                                              (shen/shen.rectify-type
                                                                                                               (shen/shen.deref
                                                                                                                W5180
                                                                                                                V4992))
                                                                                                              V4992
                                                                                                              V4993
                                                                                                              W4996
                                                                                                              (shen/freeze
                                                                                                               (shen/shen.system-S-h
                                                                                                                W5182
                                                                                                                (list
                                                                                                                 'stream
                                                                                                                 'in)
                                                                                                                V4991
                                                                                                                V4992
                                                                                                                V4993
                                                                                                                W4996
                                                                                                                V4995))))
                                                                                                            'false)))
                                                                                                         'false)))
                                                                                                      'false))
                                                                                                    'false))
                                                                                                  'false))
                                                                                                'false)
                                                                                               (shen/if
                                                                                                (shen/=
                                                                                                 W5176
                                                                                                 'false)
                                                                                                (shen/let
                                                                                                 W5184
                                                                                                 (shen/if
                                                                                                  (shen/shen.unlocked?
                                                                                                   V4993)
                                                                                                  (shen/let
                                                                                                   W5185
                                                                                                   (shen/shen.lazyderef
                                                                                                    V4989
                                                                                                    V4992)
                                                                                                   (shen/if
                                                                                                    (shen/cons?
                                                                                                     W5185)
                                                                                                    (shen/let
                                                                                                     W5186
                                                                                                     (shen/shen.lazyderef
                                                                                                      (shen/hd
                                                                                                       W5185)
                                                                                                      V4992)
                                                                                                     (shen/if
                                                                                                      (shen/=
                                                                                                       W5186
                                                                                                       'set)
                                                                                                      (shen/let
                                                                                                       W5187
                                                                                                       (shen/shen.lazyderef
                                                                                                        (nthcdr
                                                                                                         1
                                                                                                         W5185)
                                                                                                        V4992)
                                                                                                       (shen/if
                                                                                                        (shen/cons?
                                                                                                         W5187)
                                                                                                        (shen/let
                                                                                                         W5188
                                                                                                         (shen/hd
                                                                                                          W5187)
                                                                                                         (shen/let
                                                                                                          W5189
                                                                                                          (shen/shen.lazyderef
                                                                                                           (nthcdr
                                                                                                            1
                                                                                                            W5187)
                                                                                                           V4992)
                                                                                                          (shen/if
                                                                                                           (shen/cons?
                                                                                                            W5189)
                                                                                                           (shen/let
                                                                                                            W5190
                                                                                                            (shen/hd
                                                                                                             W5189)
                                                                                                            (shen/let
                                                                                                             W5191
                                                                                                             (shen/shen.lazyderef
                                                                                                              (nthcdr
                                                                                                               1
                                                                                                               W5189)
                                                                                                              V4992)
                                                                                                             (shen/if
                                                                                                              (shen/internal/predicate->shen
                                                                                                               (null
                                                                                                                W5191))
                                                                                                              (shen/do
                                                                                                               (shen/shen.incinfs)
                                                                                                               (shen/shen.system-S-h
                                                                                                                W5188
                                                                                                                'symbol
                                                                                                                V4991
                                                                                                                V4992
                                                                                                                V4993
                                                                                                                W4996
                                                                                                                (shen/freeze
                                                                                                                 (shen/shen.system-S-h
                                                                                                                  (list
                                                                                                                   'value
                                                                                                                   W5188)
                                                                                                                  V4990
                                                                                                                  V4991
                                                                                                                  V4992
                                                                                                                  V4993
                                                                                                                  W4996
                                                                                                                  (shen/freeze
                                                                                                                   (shen/shen.system-S-h
                                                                                                                    W5190
                                                                                                                    V4990
                                                                                                                    V4991
                                                                                                                    V4992
                                                                                                                    V4993
                                                                                                                    W4996
                                                                                                                    V4995))))))
                                                                                                              'false)))
                                                                                                           'false)))
                                                                                                        'false))
                                                                                                      'false))
                                                                                                    'false))
                                                                                                  'false)
                                                                                                 (shen/if
                                                                                                  (shen/=
                                                                                                   W5184
                                                                                                   'false)
                                                                                                  (shen/let
                                                                                                   W5192
                                                                                                   (shen/if
                                                                                                    (shen/shen.unlocked?
                                                                                                     V4993)
                                                                                                    (shen/let
                                                                                                     W5193
                                                                                                     (shen/shen.newpv
                                                                                                      V4992)
                                                                                                     (shen/shen.gc
                                                                                                      V4992
                                                                                                      (shen/do
                                                                                                       (shen/shen.incinfs)
                                                                                                       (shen/shen.l-rules
                                                                                                        V4991
                                                                                                        W5193
                                                                                                        'false
                                                                                                        V4992
                                                                                                        V4993
                                                                                                        W4996
                                                                                                        (shen/freeze
                                                                                                         (shen/shen.cut
                                                                                                          V4992
                                                                                                          V4993
                                                                                                          W4996
                                                                                                          (shen/freeze
                                                                                                           (shen/shen.system-S-h
                                                                                                            V4989
                                                                                                            V4990
                                                                                                            W5193
                                                                                                            V4992
                                                                                                            V4993
                                                                                                            W4996
                                                                                                            V4995))))))))
                                                                                                    'false)
                                                                                                   (shen/if
                                                                                                    (shen/=
                                                                                                     W5192
                                                                                                     'false)
                                                                                                    (shen/let
                                                                                                     W5194
                                                                                                     (shen/if
                                                                                                      (shen/shen.unlocked?
                                                                                                       V4993)
                                                                                                      (shen/do
                                                                                                       (shen/shen.incinfs)
                                                                                                       (shen/shen.search-user-datatypes
                                                                                                        (list
                                                                                                         V4989
                                                                                                         (shen/intern
                                                                                                          ":")
                                                                                                         V4990)
                                                                                                        V4991
                                                                                                        (shen/value
                                                                                                         'shen.*datatypes*)
                                                                                                        V4992
                                                                                                        V4993
                                                                                                        W4996
                                                                                                        V4995))
                                                                                                      'false)
                                                                                                     (shen/if
                                                                                                      (shen/=
                                                                                                       W5194
                                                                                                       'false)
                                                                                                      (shen/shen.unlock
                                                                                                       V4993
                                                                                                       W4996)
                                                                                                      W5194))
                                                                                                    W5192))
                                                                                                  W5184))
                                                                                                W5176))
                                                                                              W5168))
                                                                                            W5147))
                                                                                          W5134))
                                                                                        W5104))
                                                                                      W5094))
                                                                                    W5073))
                                                                                  W5045))
                                                                                W5024))
                                                                              W5017))
                                                                            W5010))
                                                                          W5004))
                                                                        W5000))
                                                             W4999))
                                                  W4998))
                               W4997))))
(defun shen/shen.primitive (V5195 V5196 V5197 V5198 V5199 V5200)
  (shen/let W5201
            (shen/if (shen/shen.unlocked? V5198)
                     (shen/let W5202 (shen/shen.lazyderef V5196 V5197)
                               (shen/let W5203
                                         (shen/freeze
                                          (shen/do (shen/shen.incinfs)
                                                   (shen/when
                                                    (shen/number?
                                                     (shen/shen.lazyderef V5195
                                                                          V5197))
                                                    V5197 V5198 V5199 V5200)))
                                         (shen/if (shen/= W5202 'number)
                                                  (shen/thaw W5203)
                                                  (shen/if
                                                   (shen/shen.pvar? W5202)
                                                   (shen/shen.bind! W5202
                                                                    'number
                                                                    V5197 W5203)
                                                   'false))))
                     'false)
            (shen/if (shen/= W5201 'false)
                     (shen/let W5204
                               (shen/if (shen/shen.unlocked? V5198)
                                        (shen/let W5205
                                                  (shen/shen.lazyderef V5196
                                                                       V5197)
                                                  (shen/let W5206
                                                            (shen/freeze
                                                             (shen/do
                                                              (shen/shen.incinfs)
                                                              (shen/when
                                                               (shen/boolean?
                                                                (shen/shen.lazyderef
                                                                 V5195 V5197))
                                                               V5197 V5198 V5199
                                                               V5200)))
                                                            (shen/if
                                                             (shen/= W5205
                                                                     'boolean)
                                                             (shen/thaw W5206)
                                                             (shen/if
                                                              (shen/shen.pvar?
                                                               W5205)
                                                              (shen/shen.bind!
                                                               W5205 'boolean
                                                               V5197 W5206)
                                                              'false))))
                                        'false)
                               (shen/if (shen/= W5204 'false)
                                        (shen/let W5207
                                                  (shen/if
                                                   (shen/shen.unlocked? V5198)
                                                   (shen/let W5208
                                                             (shen/shen.lazyderef
                                                              V5196 V5197)
                                                             (shen/let W5209
                                                                       (shen/freeze
                                                                        (shen/do
                                                                         (shen/shen.incinfs)
                                                                         (shen/when
                                                                          (shen/string?
                                                                           (shen/shen.lazyderef
                                                                            V5195
                                                                            V5197))
                                                                          V5197
                                                                          V5198
                                                                          V5199
                                                                          V5200)))
                                                                       (shen/if
                                                                        (shen/=
                                                                         W5208
                                                                         'string)
                                                                        (shen/thaw
                                                                         W5209)
                                                                        (shen/if
                                                                         (shen/shen.pvar?
                                                                          W5208)
                                                                         (shen/shen.bind!
                                                                          W5208
                                                                          'string
                                                                          V5197
                                                                          W5209)
                                                                         'false))))
                                                   'false)
                                                  (shen/if (shen/= W5207 'false)
                                                           (shen/let W5210
                                                                     (shen/if
                                                                      (shen/shen.unlocked?
                                                                       V5198)
                                                                      (shen/let
                                                                       W5211
                                                                       (shen/shen.lazyderef
                                                                        V5196
                                                                        V5197)
                                                                       (shen/let
                                                                        W5212
                                                                        (shen/freeze
                                                                         (shen/do
                                                                          (shen/shen.incinfs)
                                                                          (shen/when
                                                                           (shen/symbol?
                                                                            (shen/shen.lazyderef
                                                                             V5195
                                                                             V5197))
                                                                           V5197
                                                                           V5198
                                                                           V5199
                                                                           V5200)))
                                                                        (shen/if
                                                                         (shen/=
                                                                          W5211
                                                                          'symbol)
                                                                         (shen/thaw
                                                                          W5212)
                                                                         (shen/if
                                                                          (shen/shen.pvar?
                                                                           W5211)
                                                                          (shen/shen.bind!
                                                                           W5211
                                                                           'symbol
                                                                           V5197
                                                                           W5212)
                                                                          'false))))
                                                                      'false)
                                                                     (shen/if
                                                                      (shen/=
                                                                       W5210
                                                                       'false)
                                                                      (shen/if
                                                                       (shen/shen.unlocked?
                                                                        V5198)
                                                                       (shen/let
                                                                        W5213
                                                                        (shen/shen.lazyderef
                                                                         V5195
                                                                         V5197)
                                                                        (shen/if
                                                                         (shen/internal/predicate->shen
                                                                          (null
                                                                           W5213))
                                                                         (shen/let
                                                                          W5214
                                                                          (shen/shen.lazyderef
                                                                           V5196
                                                                           V5197)
                                                                          (shen/let
                                                                           W5215
                                                                           (shen/lambda
                                                                            Z5216
                                                                            (shen/do
                                                                             (shen/shen.incinfs)
                                                                             (shen/thaw
                                                                              V5200)))
                                                                           (shen/if
                                                                            (shen/cons?
                                                                             W5214)
                                                                            (shen/let
                                                                             W5217
                                                                             (shen/shen.lazyderef
                                                                              (shen/hd
                                                                               W5214)
                                                                              V5197)
                                                                             (shen/let
                                                                              W5218
                                                                              (shen/freeze
                                                                               (shen/let
                                                                                W5219
                                                                                (shen/shen.lazyderef
                                                                                 (nthcdr
                                                                                  1
                                                                                  W5214)
                                                                                 V5197)
                                                                                (shen/let
                                                                                 W5220
                                                                                 (shen/lambda
                                                                                  Z5221
                                                                                  (shen/internal/apply-higher-order-function
                                                                                   W5215
                                                                                   (list
                                                                                    Z5221)))
                                                                                 (shen/if
                                                                                  (shen/cons?
                                                                                   W5219)
                                                                                  (shen/let
                                                                                   W5222
                                                                                   (shen/hd
                                                                                    W5219)
                                                                                   (shen/let
                                                                                    W5223
                                                                                    (shen/shen.lazyderef
                                                                                     (nthcdr
                                                                                      1
                                                                                      W5219)
                                                                                     V5197)
                                                                                    (shen/let
                                                                                     W5224
                                                                                     (shen/freeze
                                                                                      (shen/internal/apply-higher-order-function
                                                                                       W5220
                                                                                       (list
                                                                                        W5222)))
                                                                                     (shen/if
                                                                                      (shen/internal/predicate->shen
                                                                                       (null
                                                                                        W5223))
                                                                                      (shen/thaw
                                                                                       W5224)
                                                                                      (shen/if
                                                                                       (shen/shen.pvar?
                                                                                        W5223)
                                                                                       (shen/shen.bind!
                                                                                        W5223
                                                                                        nil
                                                                                        V5197
                                                                                        W5224)
                                                                                       'false)))))
                                                                                  (shen/if
                                                                                   (shen/shen.pvar?
                                                                                    W5219)
                                                                                   (shen/let
                                                                                    W5225
                                                                                    (shen/shen.newpv
                                                                                     V5197)
                                                                                    (shen/shen.gc
                                                                                     V5197
                                                                                     (shen/shen.bind!
                                                                                      W5219
                                                                                      (list
                                                                                       W5225)
                                                                                      V5197
                                                                                      (shen/freeze
                                                                                       (shen/internal/apply-higher-order-function
                                                                                        W5220
                                                                                        (list
                                                                                         W5225))))))
                                                                                   'false)))))
                                                                              (shen/if
                                                                               (shen/=
                                                                                W5217
                                                                                'list)
                                                                               (shen/thaw
                                                                                W5218)
                                                                               (shen/if
                                                                                (shen/shen.pvar?
                                                                                 W5217)
                                                                                (shen/shen.bind!
                                                                                 W5217
                                                                                 'list
                                                                                 V5197
                                                                                 W5218)
                                                                                'false))))
                                                                            (shen/if
                                                                             (shen/shen.pvar?
                                                                              W5214)
                                                                             (shen/let
                                                                              W5226
                                                                              (shen/shen.newpv
                                                                               V5197)
                                                                              (shen/shen.gc
                                                                               V5197
                                                                               (shen/shen.bind!
                                                                                W5214
                                                                                (list
                                                                                 'list
                                                                                 W5226)
                                                                                V5197
                                                                                (shen/freeze
                                                                                 (shen/internal/apply-higher-order-function
                                                                                  W5215
                                                                                  (list
                                                                                   W5226))))))
                                                                             'false))))
                                                                         'false))
                                                                       'false)
                                                                      W5210))
                                                           W5207))
                                        W5204))
                     W5201)))
(defun shen/shen.by-hypothesis (V5227 V5228 V5229 V5230 V5231 V5232 V5233)
  (cl-flet
      ((tail-trampoline (V5227 V5228 V5229 V5230 V5231 V5232 V5233)
         (shen/let W5234
                   (shen/if (shen/shen.unlocked? V5231)
                            (shen/let W5235 (shen/shen.lazyderef V5229 V5230)
                                      (shen/if (shen/cons? W5235)
                                               (shen/let W5236
                                                         (shen/shen.lazyderef
                                                          (shen/hd W5235) V5230)
                                                         (shen/if
                                                          (shen/cons? W5236)
                                                          (shen/let W5237
                                                                    (shen/hd
                                                                     W5236)
                                                                    (shen/let
                                                                     W5238
                                                                     (shen/shen.lazyderef
                                                                      (nthcdr 1
                                                                              W5236)
                                                                      V5230)
                                                                     (shen/if
                                                                      (shen/cons?
                                                                       W5238)
                                                                      (shen/let
                                                                       W5239
                                                                       (shen/hd
                                                                        W5238)
                                                                       (shen/let
                                                                        W5240
                                                                        (shen/shen.lazyderef
                                                                         (nthcdr
                                                                          1
                                                                          W5238)
                                                                         V5230)
                                                                        (shen/if
                                                                         (shen/cons?
                                                                          W5240)
                                                                         (shen/let
                                                                          W5241
                                                                          (shen/hd
                                                                           W5240)
                                                                          (shen/let
                                                                           W5242
                                                                           (shen/shen.lazyderef
                                                                            (nthcdr
                                                                             1
                                                                             W5240)
                                                                            V5230)
                                                                           (shen/if
                                                                            (shen/internal/predicate->shen
                                                                             (null
                                                                              W5242))
                                                                            (shen/do
                                                                             (shen/shen.incinfs)
                                                                             (shen/when
                                                                              (shen/=
                                                                               (shen/shen.deref
                                                                                W5239
                                                                                V5230)
                                                                               (shen/intern
                                                                                ":"))
                                                                              V5230
                                                                              V5231
                                                                              V5232
                                                                              (shen/freeze
                                                                               (shen/when
                                                                                (shen/=
                                                                                 (shen/shen.deref
                                                                                  V5227
                                                                                  V5230)
                                                                                 (shen/shen.deref
                                                                                  W5237
                                                                                  V5230))
                                                                                V5230
                                                                                V5231
                                                                                V5232
                                                                                (shen/freeze
                                                                                 (shen/is!
                                                                                  V5228
                                                                                  W5241
                                                                                  V5230
                                                                                  V5231
                                                                                  V5232
                                                                                  V5233))))))
                                                                            'false)))
                                                                         'false)))
                                                                      'false)))
                                                          'false))
                                               'false))
                            'false)
                   (shen/if (shen/= W5234 'false)
                            (shen/if (shen/shen.unlocked? V5231)
                                     (shen/let W5243
                                               (shen/shen.lazyderef V5229 V5230)
                                               (shen/if (shen/cons? W5243)
                                                        (shen/let W5244
                                                                  (nthcdr 1
                                                                          W5243)
                                                                  (shen/do
                                                                   (shen/shen.incinfs)
                                                                   (vector
                                                                    (list V5227
                                                                          V5228
                                                                          W5244
                                                                          V5230
                                                                          V5231
                                                                          V5232
                                                                          V5233))))
                                                        'false))
                                     'false)
                            W5234))))
    (let
        ((result
          (funcall #'tail-trampoline V5227 V5228 V5229 V5230 V5231 V5232 V5233)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.lookupsig (V5245 V5246 V5247 V5248 V5249 V5250)
  (shen/if (shen/shen.unlocked? V5248)
           (shen/do (shen/shen.incinfs)
                    (shen/shen.sigf (shen/assoc V5245 (shen/value 'shen.*sigf*))
                                    V5246 V5247 V5248 V5249 V5250))
           'false))
(defun shen/shen.sigf (V5265 V5266 V5267 V5268 V5269 V5270)
  (shen/cond
   ((shen/cons? V5265)
    (shen/internal/apply-function-expression
     (shen/internal/apply-function-expression
      (shen/internal/apply-function-expression
       (shen/internal/apply-function-expression
        (shen/internal/apply-function-expression (nthcdr 1 V5265) (list V5266))
        (list V5267))
       (list V5268))
      (list V5269))
     (list V5270)))
   (shen/true 'false)))
(defun shen/shen.freshterm (V5271)
  (shen/let W5272 (shen/absvector 3)
            (shen/let W5273 (shen/address-> W5272 0 'shen.print-freshterm)
                      (shen/let W5274 (shen/address-> W5273 1 V5271)
                                (shen/let W5275
                                          (shen/address-> W5274 2
                                                          (shen/set
                                                           'shen.*gensym*
                                                           (1+
                                                            (shen/value
                                                             'shen.*gensym*))))
                                          W5275)))))
(defun shen/shen.print-freshterm (V5276)
  (shen/cn "&&" (shen/str (shen/<-address V5276 1))))
(defun shen/shen.search-user-datatypes
    (V5277 V5278 V5279 V5280 V5281 V5282 V5283)
  (cl-flet
      ((tail-trampoline (V5277 V5278 V5279 V5280 V5281 V5282 V5283)
         (shen/let W5284
                   (shen/if (shen/shen.unlocked? V5281)
                            (shen/let W5285 (shen/shen.lazyderef V5279 V5280)
                                      (shen/if (shen/cons? W5285)
                                               (shen/let W5286
                                                         (shen/shen.lazyderef
                                                          (shen/hd W5285) V5280)
                                                         (shen/if
                                                          (shen/cons? W5286)
                                                          (shen/let W5287
                                                                    (nthcdr 1
                                                                            W5286)
                                                                    (shen/do
                                                                     (shen/shen.incinfs)
                                                                     (shen/call
                                                                      (shen/internal/apply-function-expression
                                                                       (shen/internal/apply-function-expression
                                                                        (shen/shen.deref
                                                                         W5287
                                                                         V5280)
                                                                        (list
                                                                         (shen/shen.deref
                                                                          V5277
                                                                          V5280)))
                                                                       (list
                                                                        (shen/shen.deref
                                                                         V5278
                                                                         V5280)))
                                                                      V5280
                                                                      V5281
                                                                      V5282
                                                                      V5283)))
                                                          'false))
                                               'false))
                            'false)
                   (shen/if (shen/= W5284 'false)
                            (shen/if (shen/shen.unlocked? V5281)
                                     (shen/let W5288
                                               (shen/shen.lazyderef V5279 V5280)
                                               (shen/if (shen/cons? W5288)
                                                        (shen/let W5289
                                                                  (nthcdr 1
                                                                          W5288)
                                                                  (shen/do
                                                                   (shen/shen.incinfs)
                                                                   (vector
                                                                    (list V5277
                                                                          V5278
                                                                          W5289
                                                                          V5280
                                                                          V5281
                                                                          V5282
                                                                          V5283))))
                                                        'false))
                                     'false)
                            W5284))))
    (let
        ((result
          (funcall #'tail-trampoline V5277 V5278 V5279 V5280 V5281 V5282 V5283)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.l-rules (V5290 V5291 V5292 V5293 V5294 V5295 V5296)
  (shen/let W5297 (1+ V5295)
            (shen/let W5298
                      (shen/if (shen/shen.unlocked? V5294)
                               (shen/let W5299 (shen/shen.lazyderef V5290 V5293)
                                         (shen/if
                                          (shen/internal/predicate->shen
                                           (null W5299))
                                          (shen/let W5300
                                                    (shen/shen.lazyderef V5292
                                                                         V5293)
                                                    (shen/if
                                                     (shen/= W5300 'true)
                                                     (shen/do
                                                      (shen/shen.incinfs)
                                                      (shen/shen.cut V5293 V5294
                                                                     W5297
                                                                     (shen/freeze
                                                                      (shen/bind
                                                                       V5291 nil
                                                                       V5293
                                                                       V5294
                                                                       W5297
                                                                       V5296))))
                                                     'false))
                                          'false))
                               'false)
                      (shen/if (shen/= W5298 'false)
                               (shen/let W5301
                                         (shen/if (shen/shen.unlocked? V5294)
                                                  (shen/let W5302
                                                            (shen/shen.lazyderef
                                                             V5290 V5293)
                                                            (shen/if
                                                             (shen/cons? W5302)
                                                             (shen/let W5303
                                                                       (shen/shen.lazyderef
                                                                        (shen/hd
                                                                         W5302)
                                                                        V5293)
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         W5303)
                                                                        (shen/let
                                                                         W5304
                                                                         (shen/shen.lazyderef
                                                                          (shen/hd
                                                                           W5303)
                                                                          V5293)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5304)
                                                                          (shen/let
                                                                           W5305
                                                                           (shen/shen.lazyderef
                                                                            (shen/hd
                                                                             W5304)
                                                                            V5293)
                                                                           (shen/if
                                                                            (shen/=
                                                                             W5305
                                                                             'cons)
                                                                            (shen/let
                                                                             W5306
                                                                             (shen/shen.lazyderef
                                                                              (nthcdr
                                                                               1
                                                                               W5304)
                                                                              V5293)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5306)
                                                                              (shen/let
                                                                               W5307
                                                                               (shen/hd
                                                                                W5306)
                                                                               (shen/let
                                                                                W5308
                                                                                (shen/shen.lazyderef
                                                                                 (nthcdr
                                                                                  1
                                                                                  W5306)
                                                                                 V5293)
                                                                                (shen/if
                                                                                 (shen/cons?
                                                                                  W5308)
                                                                                 (shen/let
                                                                                  W5309
                                                                                  (shen/hd
                                                                                   W5308)
                                                                                  (shen/let
                                                                                   W5310
                                                                                   (shen/shen.lazyderef
                                                                                    (nthcdr
                                                                                     1
                                                                                     W5308)
                                                                                    V5293)
                                                                                   (shen/if
                                                                                    (shen/internal/predicate->shen
                                                                                     (null
                                                                                      W5310))
                                                                                    (shen/let
                                                                                     W5311
                                                                                     (shen/shen.lazyderef
                                                                                      (nthcdr
                                                                                       1
                                                                                       W5303)
                                                                                      V5293)
                                                                                     (shen/if
                                                                                      (shen/cons?
                                                                                       W5311)
                                                                                      (shen/let
                                                                                       W5312
                                                                                       (shen/hd
                                                                                        W5311)
                                                                                       (shen/let
                                                                                        W5313
                                                                                        (shen/shen.lazyderef
                                                                                         (nthcdr
                                                                                          1
                                                                                          W5311)
                                                                                         V5293)
                                                                                        (shen/if
                                                                                         (shen/cons?
                                                                                          W5313)
                                                                                         (shen/let
                                                                                          W5314
                                                                                          (shen/shen.lazyderef
                                                                                           (shen/hd
                                                                                            W5313)
                                                                                           V5293)
                                                                                          (shen/if
                                                                                           (shen/cons?
                                                                                            W5314)
                                                                                           (shen/let
                                                                                            W5315
                                                                                            (shen/shen.lazyderef
                                                                                             (shen/hd
                                                                                              W5314)
                                                                                             V5293)
                                                                                            (shen/if
                                                                                             (shen/=
                                                                                              W5315
                                                                                              'list)
                                                                                             (shen/let
                                                                                              W5316
                                                                                              (shen/shen.lazyderef
                                                                                               (nthcdr
                                                                                                1
                                                                                                W5314)
                                                                                               V5293)
                                                                                              (shen/if
                                                                                               (shen/cons?
                                                                                                W5316)
                                                                                               (shen/let
                                                                                                W5317
                                                                                                (shen/hd
                                                                                                 W5316)
                                                                                                (shen/let
                                                                                                 W5318
                                                                                                 (shen/shen.lazyderef
                                                                                                  (nthcdr
                                                                                                   1
                                                                                                   W5316)
                                                                                                  V5293)
                                                                                                 (shen/if
                                                                                                  (shen/internal/predicate->shen
                                                                                                   (null
                                                                                                    W5318))
                                                                                                  (shen/let
                                                                                                   W5319
                                                                                                   (shen/shen.lazyderef
                                                                                                    (nthcdr
                                                                                                     1
                                                                                                     W5313)
                                                                                                    V5293)
                                                                                                   (shen/if
                                                                                                    (shen/internal/predicate->shen
                                                                                                     (null
                                                                                                      W5319))
                                                                                                    (shen/let
                                                                                                     W5320
                                                                                                     (nthcdr
                                                                                                      1
                                                                                                      W5302)
                                                                                                     (shen/do
                                                                                                      (shen/shen.incinfs)
                                                                                                      (shen/when
                                                                                                       (shen/=
                                                                                                        (shen/shen.deref
                                                                                                         W5312
                                                                                                         V5293)
                                                                                                        (shen/intern
                                                                                                         ":"))
                                                                                                       V5293
                                                                                                       V5294
                                                                                                       W5297
                                                                                                       (shen/freeze
                                                                                                        (shen/shen.cut
                                                                                                         V5293
                                                                                                         V5294
                                                                                                         W5297
                                                                                                         (shen/freeze
                                                                                                          (shen/shen.l-rules
                                                                                                           (append
                                                                                                            (list
                                                                                                             (list
                                                                                                              W5307
                                                                                                              W5312
                                                                                                              W5317)
                                                                                                             (list
                                                                                                              W5309
                                                                                                              W5312
                                                                                                              (list
                                                                                                               'list
                                                                                                               W5317)))
                                                                                                            W5320)
                                                                                                           V5291
                                                                                                           'true
                                                                                                           V5293
                                                                                                           V5294
                                                                                                           W5297
                                                                                                           V5296)))))))
                                                                                                    'false))
                                                                                                  'false)))
                                                                                               'false))
                                                                                             'false))
                                                                                           'false))
                                                                                         'false)))
                                                                                      'false))
                                                                                    'false)))
                                                                                 'false)))
                                                                              'false))
                                                                            'false))
                                                                          'false))
                                                                        'false))
                                                             'false))
                                                  'false)
                                         (shen/if (shen/= W5301 'false)
                                                  (shen/let W5321
                                                            (shen/if
                                                             (shen/shen.unlocked?
                                                              V5294)
                                                             (shen/let W5322
                                                                       (shen/shen.lazyderef
                                                                        V5290
                                                                        V5293)
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         W5322)
                                                                        (shen/let
                                                                         W5323
                                                                         (shen/shen.lazyderef
                                                                          (shen/hd
                                                                           W5322)
                                                                          V5293)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5323)
                                                                          (shen/let
                                                                           W5324
                                                                           (shen/shen.lazyderef
                                                                            (shen/hd
                                                                             W5323)
                                                                            V5293)
                                                                           (shen/if
                                                                            (shen/cons?
                                                                             W5324)
                                                                            (shen/let
                                                                             W5325
                                                                             (shen/shen.lazyderef
                                                                              (shen/hd
                                                                               W5324)
                                                                              V5293)
                                                                             (shen/if
                                                                              (shen/=
                                                                               W5325
                                                                               '@p)
                                                                              (shen/let
                                                                               W5326
                                                                               (shen/shen.lazyderef
                                                                                (nthcdr
                                                                                 1
                                                                                 W5324)
                                                                                V5293)
                                                                               (shen/if
                                                                                (shen/cons?
                                                                                 W5326)
                                                                                (shen/let
                                                                                 W5327
                                                                                 (shen/hd
                                                                                  W5326)
                                                                                 (shen/let
                                                                                  W5328
                                                                                  (shen/shen.lazyderef
                                                                                   (nthcdr
                                                                                    1
                                                                                    W5326)
                                                                                   V5293)
                                                                                  (shen/if
                                                                                   (shen/cons?
                                                                                    W5328)
                                                                                   (shen/let
                                                                                    W5329
                                                                                    (shen/hd
                                                                                     W5328)
                                                                                    (shen/let
                                                                                     W5330
                                                                                     (shen/shen.lazyderef
                                                                                      (nthcdr
                                                                                       1
                                                                                       W5328)
                                                                                      V5293)
                                                                                     (shen/if
                                                                                      (shen/internal/predicate->shen
                                                                                       (null
                                                                                        W5330))
                                                                                      (shen/let
                                                                                       W5331
                                                                                       (shen/shen.lazyderef
                                                                                        (nthcdr
                                                                                         1
                                                                                         W5323)
                                                                                        V5293)
                                                                                       (shen/if
                                                                                        (shen/cons?
                                                                                         W5331)
                                                                                        (shen/let
                                                                                         W5332
                                                                                         (shen/hd
                                                                                          W5331)
                                                                                         (shen/let
                                                                                          W5333
                                                                                          (shen/shen.lazyderef
                                                                                           (nthcdr
                                                                                            1
                                                                                            W5331)
                                                                                           V5293)
                                                                                          (shen/if
                                                                                           (shen/cons?
                                                                                            W5333)
                                                                                           (shen/let
                                                                                            W5334
                                                                                            (shen/shen.lazyderef
                                                                                             (shen/hd
                                                                                              W5333)
                                                                                             V5293)
                                                                                            (shen/if
                                                                                             (shen/cons?
                                                                                              W5334)
                                                                                             (shen/let
                                                                                              W5335
                                                                                              (shen/hd
                                                                                               W5334)
                                                                                              (shen/let
                                                                                               W5336
                                                                                               (shen/shen.lazyderef
                                                                                                (nthcdr
                                                                                                 1
                                                                                                 W5334)
                                                                                                V5293)
                                                                                               (shen/if
                                                                                                (shen/cons?
                                                                                                 W5336)
                                                                                                (shen/let
                                                                                                 W5337
                                                                                                 (shen/shen.lazyderef
                                                                                                  (shen/hd
                                                                                                   W5336)
                                                                                                  V5293)
                                                                                                 (shen/if
                                                                                                  (shen/=
                                                                                                   W5337
                                                                                                   '*)
                                                                                                  (shen/let
                                                                                                   W5338
                                                                                                   (shen/shen.lazyderef
                                                                                                    (nthcdr
                                                                                                     1
                                                                                                     W5336)
                                                                                                    V5293)
                                                                                                   (shen/if
                                                                                                    (shen/cons?
                                                                                                     W5338)
                                                                                                    (shen/let
                                                                                                     W5339
                                                                                                     (shen/hd
                                                                                                      W5338)
                                                                                                     (shen/let
                                                                                                      W5340
                                                                                                      (shen/shen.lazyderef
                                                                                                       (nthcdr
                                                                                                        1
                                                                                                        W5338)
                                                                                                       V5293)
                                                                                                      (shen/if
                                                                                                       (shen/internal/predicate->shen
                                                                                                        (null
                                                                                                         W5340))
                                                                                                       (shen/let
                                                                                                        W5341
                                                                                                        (shen/shen.lazyderef
                                                                                                         (nthcdr
                                                                                                          1
                                                                                                          W5333)
                                                                                                         V5293)
                                                                                                        (shen/if
                                                                                                         (shen/internal/predicate->shen
                                                                                                          (null
                                                                                                           W5341))
                                                                                                         (shen/let
                                                                                                          W5342
                                                                                                          (nthcdr
                                                                                                           1
                                                                                                           W5322)
                                                                                                          (shen/do
                                                                                                           (shen/shen.incinfs)
                                                                                                           (shen/when
                                                                                                            (shen/=
                                                                                                             (shen/shen.deref
                                                                                                              W5332
                                                                                                              V5293)
                                                                                                             (shen/intern
                                                                                                              ":"))
                                                                                                            V5293
                                                                                                            V5294
                                                                                                            W5297
                                                                                                            (shen/freeze
                                                                                                             (shen/shen.cut
                                                                                                              V5293
                                                                                                              V5294
                                                                                                              W5297
                                                                                                              (shen/freeze
                                                                                                               (shen/shen.l-rules
                                                                                                                (append
                                                                                                                 (list
                                                                                                                  (list
                                                                                                                   W5327
                                                                                                                   W5332
                                                                                                                   W5335)
                                                                                                                  (list
                                                                                                                   W5329
                                                                                                                   W5332
                                                                                                                   W5339))
                                                                                                                 W5342)
                                                                                                                V5291
                                                                                                                'true
                                                                                                                V5293
                                                                                                                V5294
                                                                                                                W5297
                                                                                                                V5296)))))))
                                                                                                         'false))
                                                                                                       'false)))
                                                                                                    'false))
                                                                                                  'false))
                                                                                                'false)))
                                                                                             'false))
                                                                                           'false)))
                                                                                        'false))
                                                                                      'false)))
                                                                                   'false)))
                                                                                'false))
                                                                              'false))
                                                                            'false))
                                                                          'false))
                                                                        'false))
                                                             'false)
                                                            (shen/if
                                                             (shen/= W5321
                                                                     'false)
                                                             (shen/let W5343
                                                                       (shen/if
                                                                        (shen/shen.unlocked?
                                                                         V5294)
                                                                        (shen/let
                                                                         W5344
                                                                         (shen/shen.lazyderef
                                                                          V5290
                                                                          V5293)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5344)
                                                                          (shen/let
                                                                           W5345
                                                                           (shen/shen.lazyderef
                                                                            (shen/hd
                                                                             W5344)
                                                                            V5293)
                                                                           (shen/if
                                                                            (shen/cons?
                                                                             W5345)
                                                                            (shen/let
                                                                             W5346
                                                                             (shen/shen.lazyderef
                                                                              (shen/hd
                                                                               W5345)
                                                                              V5293)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5346)
                                                                              (shen/let
                                                                               W5347
                                                                               (shen/shen.lazyderef
                                                                                (shen/hd
                                                                                 W5346)
                                                                                V5293)
                                                                               (shen/if
                                                                                (shen/=
                                                                                 W5347
                                                                                 '@s)
                                                                                (shen/let
                                                                                 W5348
                                                                                 (shen/shen.lazyderef
                                                                                  (nthcdr
                                                                                   1
                                                                                   W5346)
                                                                                  V5293)
                                                                                 (shen/if
                                                                                  (shen/cons?
                                                                                   W5348)
                                                                                  (shen/let
                                                                                   W5349
                                                                                   (shen/hd
                                                                                    W5348)
                                                                                   (shen/let
                                                                                    W5350
                                                                                    (shen/shen.lazyderef
                                                                                     (nthcdr
                                                                                      1
                                                                                      W5348)
                                                                                     V5293)
                                                                                    (shen/if
                                                                                     (shen/cons?
                                                                                      W5350)
                                                                                     (shen/let
                                                                                      W5351
                                                                                      (shen/hd
                                                                                       W5350)
                                                                                      (shen/let
                                                                                       W5352
                                                                                       (shen/shen.lazyderef
                                                                                        (nthcdr
                                                                                         1
                                                                                         W5350)
                                                                                        V5293)
                                                                                       (shen/if
                                                                                        (shen/internal/predicate->shen
                                                                                         (null
                                                                                          W5352))
                                                                                        (shen/let
                                                                                         W5353
                                                                                         (shen/shen.lazyderef
                                                                                          (nthcdr
                                                                                           1
                                                                                           W5345)
                                                                                          V5293)
                                                                                         (shen/if
                                                                                          (shen/cons?
                                                                                           W5353)
                                                                                          (shen/let
                                                                                           W5354
                                                                                           (shen/hd
                                                                                            W5353)
                                                                                           (shen/let
                                                                                            W5355
                                                                                            (shen/shen.lazyderef
                                                                                             (nthcdr
                                                                                              1
                                                                                              W5353)
                                                                                             V5293)
                                                                                            (shen/if
                                                                                             (shen/cons?
                                                                                              W5355)
                                                                                             (shen/let
                                                                                              W5356
                                                                                              (shen/shen.lazyderef
                                                                                               (shen/hd
                                                                                                W5355)
                                                                                               V5293)
                                                                                              (shen/if
                                                                                               (shen/=
                                                                                                W5356
                                                                                                'string)
                                                                                               (shen/let
                                                                                                W5357
                                                                                                (shen/shen.lazyderef
                                                                                                 (nthcdr
                                                                                                  1
                                                                                                  W5355)
                                                                                                 V5293)
                                                                                                (shen/if
                                                                                                 (shen/internal/predicate->shen
                                                                                                  (null
                                                                                                   W5357))
                                                                                                 (shen/let
                                                                                                  W5358
                                                                                                  (nthcdr
                                                                                                   1
                                                                                                   W5344)
                                                                                                  (shen/do
                                                                                                   (shen/shen.incinfs)
                                                                                                   (shen/when
                                                                                                    (shen/=
                                                                                                     (shen/shen.deref
                                                                                                      W5354
                                                                                                      V5293)
                                                                                                     (shen/intern
                                                                                                      ":"))
                                                                                                    V5293
                                                                                                    V5294
                                                                                                    W5297
                                                                                                    (shen/freeze
                                                                                                     (shen/shen.cut
                                                                                                      V5293
                                                                                                      V5294
                                                                                                      W5297
                                                                                                      (shen/freeze
                                                                                                       (shen/shen.l-rules
                                                                                                        (append
                                                                                                         (list
                                                                                                          (list
                                                                                                           W5349
                                                                                                           W5354
                                                                                                           'string)
                                                                                                          (list
                                                                                                           W5351
                                                                                                           W5354
                                                                                                           'string))
                                                                                                         W5358)
                                                                                                        V5291
                                                                                                        'true
                                                                                                        V5293
                                                                                                        V5294
                                                                                                        W5297
                                                                                                        V5296)))))))
                                                                                                 'false))
                                                                                               'false))
                                                                                             'false)))
                                                                                          'false))
                                                                                        'false)))
                                                                                     'false)))
                                                                                  'false))
                                                                                'false))
                                                                              'false))
                                                                            'false))
                                                                          'false))
                                                                        'false)
                                                                       (shen/if
                                                                        (shen/=
                                                                         W5343
                                                                         'false)
                                                                        (shen/let
                                                                         W5359
                                                                         (shen/if
                                                                          (shen/shen.unlocked?
                                                                           V5294)
                                                                          (shen/let
                                                                           W5360
                                                                           (shen/shen.lazyderef
                                                                            V5290
                                                                            V5293)
                                                                           (shen/if
                                                                            (shen/cons?
                                                                             W5360)
                                                                            (shen/let
                                                                             W5361
                                                                             (shen/shen.lazyderef
                                                                              (shen/hd
                                                                               W5360)
                                                                              V5293)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5361)
                                                                              (shen/let
                                                                               W5362
                                                                               (shen/shen.lazyderef
                                                                                (shen/hd
                                                                                 W5361)
                                                                                V5293)
                                                                               (shen/if
                                                                                (shen/cons?
                                                                                 W5362)
                                                                                (shen/let
                                                                                 W5363
                                                                                 (shen/shen.lazyderef
                                                                                  (shen/hd
                                                                                   W5362)
                                                                                  V5293)
                                                                                 (shen/if
                                                                                  (shen/=
                                                                                   W5363
                                                                                   '@v)
                                                                                  (shen/let
                                                                                   W5364
                                                                                   (shen/shen.lazyderef
                                                                                    (nthcdr
                                                                                     1
                                                                                     W5362)
                                                                                    V5293)
                                                                                   (shen/if
                                                                                    (shen/cons?
                                                                                     W5364)
                                                                                    (shen/let
                                                                                     W5365
                                                                                     (shen/hd
                                                                                      W5364)
                                                                                     (shen/let
                                                                                      W5366
                                                                                      (shen/shen.lazyderef
                                                                                       (nthcdr
                                                                                        1
                                                                                        W5364)
                                                                                       V5293)
                                                                                      (shen/if
                                                                                       (shen/cons?
                                                                                        W5366)
                                                                                       (shen/let
                                                                                        W5367
                                                                                        (shen/hd
                                                                                         W5366)
                                                                                        (shen/let
                                                                                         W5368
                                                                                         (shen/shen.lazyderef
                                                                                          (nthcdr
                                                                                           1
                                                                                           W5366)
                                                                                          V5293)
                                                                                         (shen/if
                                                                                          (shen/internal/predicate->shen
                                                                                           (null
                                                                                            W5368))
                                                                                          (shen/let
                                                                                           W5369
                                                                                           (shen/shen.lazyderef
                                                                                            (nthcdr
                                                                                             1
                                                                                             W5361)
                                                                                            V5293)
                                                                                           (shen/if
                                                                                            (shen/cons?
                                                                                             W5369)
                                                                                            (shen/let
                                                                                             W5370
                                                                                             (shen/hd
                                                                                              W5369)
                                                                                             (shen/let
                                                                                              W5371
                                                                                              (shen/shen.lazyderef
                                                                                               (nthcdr
                                                                                                1
                                                                                                W5369)
                                                                                               V5293)
                                                                                              (shen/if
                                                                                               (shen/cons?
                                                                                                W5371)
                                                                                               (shen/let
                                                                                                W5372
                                                                                                (shen/shen.lazyderef
                                                                                                 (shen/hd
                                                                                                  W5371)
                                                                                                 V5293)
                                                                                                (shen/if
                                                                                                 (shen/cons?
                                                                                                  W5372)
                                                                                                 (shen/let
                                                                                                  W5373
                                                                                                  (shen/shen.lazyderef
                                                                                                   (shen/hd
                                                                                                    W5372)
                                                                                                   V5293)
                                                                                                  (shen/if
                                                                                                   (shen/=
                                                                                                    W5373
                                                                                                    'vector)
                                                                                                   (shen/let
                                                                                                    W5374
                                                                                                    (shen/shen.lazyderef
                                                                                                     (nthcdr
                                                                                                      1
                                                                                                      W5372)
                                                                                                     V5293)
                                                                                                    (shen/if
                                                                                                     (shen/cons?
                                                                                                      W5374)
                                                                                                     (shen/let
                                                                                                      W5375
                                                                                                      (shen/hd
                                                                                                       W5374)
                                                                                                      (shen/let
                                                                                                       W5376
                                                                                                       (shen/shen.lazyderef
                                                                                                        (nthcdr
                                                                                                         1
                                                                                                         W5374)
                                                                                                        V5293)
                                                                                                       (shen/if
                                                                                                        (shen/internal/predicate->shen
                                                                                                         (null
                                                                                                          W5376))
                                                                                                        (shen/let
                                                                                                         W5377
                                                                                                         (shen/shen.lazyderef
                                                                                                          (nthcdr
                                                                                                           1
                                                                                                           W5371)
                                                                                                          V5293)
                                                                                                         (shen/if
                                                                                                          (shen/internal/predicate->shen
                                                                                                           (null
                                                                                                            W5377))
                                                                                                          (shen/let
                                                                                                           W5378
                                                                                                           (nthcdr
                                                                                                            1
                                                                                                            W5360)
                                                                                                           (shen/do
                                                                                                            (shen/shen.incinfs)
                                                                                                            (shen/when
                                                                                                             (shen/=
                                                                                                              (shen/shen.deref
                                                                                                               W5370
                                                                                                               V5293)
                                                                                                              (shen/intern
                                                                                                               ":"))
                                                                                                             V5293
                                                                                                             V5294
                                                                                                             W5297
                                                                                                             (shen/freeze
                                                                                                              (shen/shen.cut
                                                                                                               V5293
                                                                                                               V5294
                                                                                                               W5297
                                                                                                               (shen/freeze
                                                                                                                (shen/shen.l-rules
                                                                                                                 (append
                                                                                                                  (list
                                                                                                                   (list
                                                                                                                    W5365
                                                                                                                    W5370
                                                                                                                    W5375)
                                                                                                                   (list
                                                                                                                    W5367
                                                                                                                    W5370
                                                                                                                    (list
                                                                                                                     'vector
                                                                                                                     W5375)))
                                                                                                                  W5378)
                                                                                                                 V5291
                                                                                                                 'true
                                                                                                                 V5293
                                                                                                                 V5294
                                                                                                                 W5297
                                                                                                                 V5296)))))))
                                                                                                          'false))
                                                                                                        'false)))
                                                                                                     'false))
                                                                                                   'false))
                                                                                                 'false))
                                                                                               'false)))
                                                                                            'false))
                                                                                          'false)))
                                                                                       'false)))
                                                                                    'false))
                                                                                  'false))
                                                                                'false))
                                                                              'false))
                                                                            'false))
                                                                          'false)
                                                                         (shen/if
                                                                          (shen/=
                                                                           W5359
                                                                           'false)
                                                                          (shen/let
                                                                           W5379
                                                                           (shen/if
                                                                            (shen/shen.unlocked?
                                                                             V5294)
                                                                            (shen/let
                                                                             W5380
                                                                             (shen/shen.lazyderef
                                                                              V5290
                                                                              V5293)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5380)
                                                                              (shen/let
                                                                               W5381
                                                                               (shen/hd
                                                                                W5380)
                                                                               (shen/let
                                                                                W5382
                                                                                (nthcdr
                                                                                 1
                                                                                 W5380)
                                                                                (shen/let
                                                                                 W5383
                                                                                 (shen/shen.lazyderef
                                                                                  V5291
                                                                                  V5293)
                                                                                 (shen/let
                                                                                  W5384
                                                                                  (shen/lambda
                                                                                   Z5385
                                                                                   (shen/lambda
                                                                                    Z5386
                                                                                    (shen/do
                                                                                     (shen/shen.incinfs)
                                                                                     (shen/bind
                                                                                      Z5385
                                                                                      W5381
                                                                                      V5293
                                                                                      V5294
                                                                                      W5297
                                                                                      (shen/freeze
                                                                                       (shen/shen.l-rules
                                                                                        W5382
                                                                                        Z5386
                                                                                        V5292
                                                                                        V5293
                                                                                        V5294
                                                                                        W5297
                                                                                        V5296))))))
                                                                                  (shen/if
                                                                                   (shen/cons?
                                                                                    W5383)
                                                                                   (shen/let
                                                                                    W5387
                                                                                    (shen/hd
                                                                                     W5383)
                                                                                    (shen/let
                                                                                     W5388
                                                                                     (nthcdr
                                                                                      1
                                                                                      W5383)
                                                                                     (shen/internal/apply-function-expression
                                                                                      (shen/internal/apply-higher-order-function
                                                                                       W5384
                                                                                       (list
                                                                                        W5387))
                                                                                      (list
                                                                                       W5388))))
                                                                                   (shen/if
                                                                                    (shen/shen.pvar?
                                                                                     W5383)
                                                                                    (shen/let
                                                                                     W5389
                                                                                     (shen/shen.newpv
                                                                                      V5293)
                                                                                     (shen/shen.gc
                                                                                      V5293
                                                                                      (shen/let
                                                                                       W5390
                                                                                       (shen/shen.newpv
                                                                                        V5293)
                                                                                       (shen/shen.gc
                                                                                        V5293
                                                                                        (shen/shen.bind!
                                                                                         W5383
                                                                                         (append
                                                                                          (list
                                                                                           W5389)
                                                                                          W5390)
                                                                                         V5293
                                                                                         (shen/freeze
                                                                                          (shen/internal/apply-function-expression
                                                                                           (shen/internal/apply-higher-order-function
                                                                                            W5384
                                                                                            (list
                                                                                             W5389))
                                                                                           (list
                                                                                            W5390))))))))
                                                                                    'false))))))
                                                                              'false))
                                                                            'false)
                                                                           (shen/if
                                                                            (shen/=
                                                                             W5379
                                                                             'false)
                                                                            (shen/shen.unlock
                                                                             V5294
                                                                             W5297)
                                                                            W5379))
                                                                          W5359))
                                                                        W5343))
                                                             W5321))
                                                  W5301))
                               W5298))))
(defun shen/shen.t* (V5391 V5392 V5393 V5394 V5395 V5396)
  (shen/let W5397 (1+ V5395)
            (shen/let W5398
                      (shen/if (shen/shen.unlocked? V5394)
                               (shen/let W5399 (shen/shen.lazyderef V5391 V5393)
                                         (shen/if (shen/cons? W5399)
                                                  (shen/let W5400
                                                            (shen/shen.lazyderef
                                                             (shen/hd W5399)
                                                             V5393)
                                                            (shen/if
                                                             (shen/= W5400
                                                                     'define)
                                                             (shen/let W5401
                                                                       (shen/shen.lazyderef
                                                                        (nthcdr
                                                                         1 W5399)
                                                                        V5393)
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         W5401)
                                                                        (shen/let
                                                                         W5402
                                                                         (shen/hd
                                                                          W5401)
                                                                         (shen/let
                                                                          W5403
                                                                          (nthcdr
                                                                           1
                                                                           W5401)
                                                                          (shen/let
                                                                           W5404
                                                                           (shen/shen.newpv
                                                                            V5393)
                                                                           (shen/shen.gc
                                                                            V5393
                                                                            (shen/let
                                                                             W5405
                                                                             (shen/shen.newpv
                                                                              V5393)
                                                                             (shen/shen.gc
                                                                              V5393
                                                                              (shen/let
                                                                               W5406
                                                                               (shen/shen.newpv
                                                                                V5393)
                                                                               (shen/shen.gc
                                                                                V5393
                                                                                (shen/let
                                                                                 W5407
                                                                                 (shen/shen.newpv
                                                                                  V5393)
                                                                                 (shen/shen.gc
                                                                                  V5393
                                                                                  (shen/do
                                                                                   (shen/shen.incinfs)
                                                                                   (shen/shen.cut
                                                                                    V5393
                                                                                    V5394
                                                                                    W5397
                                                                                    (shen/freeze
                                                                                     (shen/bind
                                                                                      W5404
                                                                                      (shen/shen.sigxrules
                                                                                       (append
                                                                                        (list
                                                                                         W5402)
                                                                                        W5403))
                                                                                      V5393
                                                                                      V5394
                                                                                      W5397
                                                                                      (shen/freeze
                                                                                       (shen/bind
                                                                                        W5407
                                                                                        (shen/fst
                                                                                         (shen/shen.lazyderef
                                                                                          W5404
                                                                                          V5393))
                                                                                        V5393
                                                                                        V5394
                                                                                        W5397
                                                                                        (shen/freeze
                                                                                         (shen/bind
                                                                                          W5405
                                                                                          (shen/snd
                                                                                           (shen/shen.lazyderef
                                                                                            W5404
                                                                                            V5393))
                                                                                          V5393
                                                                                          V5394
                                                                                          W5397
                                                                                          (shen/freeze
                                                                                           (shen/bind
                                                                                            W5406
                                                                                            (shen/shen.freshen-sig
                                                                                             (shen/shen.deref
                                                                                              W5407
                                                                                              V5393))
                                                                                            V5393
                                                                                            V5394
                                                                                            W5397
                                                                                            (shen/freeze
                                                                                             (shen/shen.t*-rules
                                                                                              W5402
                                                                                              W5405
                                                                                              W5406
                                                                                              1
                                                                                              V5393
                                                                                              V5394
                                                                                              W5397
                                                                                              (shen/freeze
                                                                                               (shen/is
                                                                                                W5407
                                                                                                V5392
                                                                                                V5393
                                                                                                V5394
                                                                                                W5397
                                                                                                V5396))))))))))))))))))))))))
                                                                        'false))
                                                             'false))
                                                  'false))
                               'false)
                      (shen/if (shen/= W5398 'false)
                               (shen/shen.unlock V5394 W5397) W5398))))
(defun shen/shen.sigxrules (V5408)
  (shen/compile (shen/lambda Z5409 (shen/shen.<sig*rules> Z5409)) V5408))
(defun shen/shen.<sig*rules> (V5410)
  (shen/let W5411
            (shen/if (shen/cons? V5410)
                     (shen/let W5412 (shen/tail V5410)
                               (shen/if (shen/shen.hds=? W5412 '{)
                                        (shen/let W5413 (shen/tail W5412)
                                                  (shen/let W5414
                                                            (shen/shen.<signature>
                                                             W5413)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W5414)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W5415
                                                                       (shen/shen.<-out
                                                                        W5414)
                                                                       (shen/let
                                                                        W5416
                                                                        (shen/shen.in->
                                                                         W5414)
                                                                        (shen/if
                                                                         (shen/shen.hds=?
                                                                          W5416
                                                                          '})
                                                                         (shen/let
                                                                          W5417
                                                                          (shen/tail
                                                                           W5416)
                                                                          (shen/let
                                                                           W5418
                                                                           (shen/shen.<rules*>
                                                                            W5417)
                                                                           (shen/if
                                                                            (shen/shen.parse-failure?
                                                                             W5418)
                                                                            (shen/shen.parse-failure)
                                                                            (shen/let
                                                                             W5419
                                                                             (shen/shen.<-out
                                                                              W5418)
                                                                             (shen/let
                                                                              W5420
                                                                              (shen/shen.in->
                                                                               W5418)
                                                                              (shen/shen.comb
                                                                               W5420
                                                                               (shen/let
                                                                                W5421
                                                                                (shen/shen.rectify-type
                                                                                 W5415)
                                                                                (shen/@p
                                                                                 W5421
                                                                                 W5419))))))))
                                                                         (shen/shen.parse-failure)))))))
                                        (shen/shen.parse-failure)))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W5411) (shen/shen.parse-failure)
                     W5411)))
(defun shen/shen.freshen-sig (V5422)
  (shen/let W5423 (shen/shen.extract-vars V5422)
            (shen/let W5424
                      (shen/map
                       (shen/lambda Z5425
                                    (append (list Z5425)
                                            (shen/shen.freshterm
                                             (shen/concat '& Z5425))))
                       W5423)
                      (shen/shen.freshen-type W5424 V5422))))
(defun shen/shen.freshen-type (V5426 V5427)
  (cl-flet
      ((tail-trampoline (V5426 V5427)
         (shen/cond ((shen/internal/predicate->shen (null V5426)) V5427)
                    ((shen/and (shen/cons? V5426) (shen/cons? (shen/hd V5426)))
                     (vector
                      (list (nthcdr 1 V5426)
                            (shen/subst (nthcdr 1 (shen/hd V5426))
                                        (shen/hd (shen/hd V5426)) V5427))))
                    (shen/true (shen/shen.f-error 'shen.freshen-type)))))
    (let ((result (funcall #'tail-trampoline V5426 V5427)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.<rules*> (V5428)
  (shen/let W5429
            (shen/let W5430 (shen/shen.<rule*> V5428)
                      (shen/if (shen/shen.parse-failure? W5430)
                               (shen/shen.parse-failure)
                               (shen/let W5431 (shen/shen.<-out W5430)
                                         (shen/let W5432 (shen/shen.in-> W5430)
                                                   (shen/let W5433
                                                             (shen/shen.<rules*>
                                                              W5432)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W5433)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W5434
                                                                        (shen/shen.<-out
                                                                         W5433)
                                                                        (shen/let
                                                                         W5435
                                                                         (shen/shen.in->
                                                                          W5433)
                                                                         (shen/shen.comb
                                                                          W5435
                                                                          (append
                                                                           (list
                                                                            W5431)
                                                                           W5434))))))))))
            (shen/if (shen/shen.parse-failure? W5429)
                     (shen/let W5436
                               (shen/let W5437 (shen/shen.<rule*> V5428)
                                         (shen/if
                                          (shen/shen.parse-failure? W5437)
                                          (shen/shen.parse-failure)
                                          (shen/let W5438
                                                    (shen/shen.<-out W5437)
                                                    (shen/let W5439
                                                              (shen/shen.in->
                                                               W5437)
                                                              (shen/shen.comb
                                                               W5439
                                                               (list W5438))))))
                               (shen/if (shen/shen.parse-failure? W5436)
                                        (shen/shen.parse-failure) W5436))
                     W5429)))
(defun shen/shen.<rule*> (V5440)
  (shen/let W5441
            (shen/let W5442 (shen/shen.<patterns> V5440)
                      (shen/if (shen/shen.parse-failure? W5442)
                               (shen/shen.parse-failure)
                               (shen/let W5443 (shen/shen.<-out W5442)
                                         (shen/let W5444 (shen/shen.in-> W5442)
                                                   (shen/if
                                                    (shen/shen.hds=? W5444 '->)
                                                    (shen/let W5445
                                                              (shen/tail W5444)
                                                              (shen/if
                                                               (shen/cons? W5445)
                                                               (shen/let W5446
                                                                         (shen/head
                                                                          W5445)
                                                                         (shen/let
                                                                          W5447
                                                                          (shen/tail
                                                                           W5445)
                                                                          (shen/if
                                                                           (shen/shen.hds=?
                                                                            W5447
                                                                            'where)
                                                                           (shen/let
                                                                            W5448
                                                                            (shen/tail
                                                                             W5447)
                                                                            (shen/if
                                                                             (shen/cons?
                                                                              W5448)
                                                                             (shen/let
                                                                              W5449
                                                                              (shen/head
                                                                               W5448)
                                                                              (shen/let
                                                                               W5450
                                                                               (shen/tail
                                                                                W5448)
                                                                               (shen/shen.comb
                                                                                W5450
                                                                                (shen/@p
                                                                                 W5443
                                                                                 (list
                                                                                  'where
                                                                                  W5449
                                                                                  W5446)))))
                                                                             (shen/shen.parse-failure)))
                                                                           (shen/shen.parse-failure))))
                                                               (shen/shen.parse-failure)))
                                                    (shen/shen.parse-failure))))))
            (shen/if (shen/shen.parse-failure? W5441)
                     (shen/let W5451
                               (shen/let W5452 (shen/shen.<patterns> V5440)
                                         (shen/if
                                          (shen/shen.parse-failure? W5452)
                                          (shen/shen.parse-failure)
                                          (shen/let W5453
                                                    (shen/shen.<-out W5452)
                                                    (shen/let W5454
                                                              (shen/shen.in->
                                                               W5452)
                                                              (shen/if
                                                               (shen/shen.hds=?
                                                                W5454 '<-)
                                                               (shen/let W5455
                                                                         (shen/tail
                                                                          W5454)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5455)
                                                                          (shen/let
                                                                           W5456
                                                                           (shen/head
                                                                            W5455)
                                                                           (shen/let
                                                                            W5457
                                                                            (shen/tail
                                                                             W5455)
                                                                            (shen/if
                                                                             (shen/shen.hds=?
                                                                              W5457
                                                                              'where)
                                                                             (shen/let
                                                                              W5458
                                                                              (shen/tail
                                                                               W5457)
                                                                              (shen/if
                                                                               (shen/cons?
                                                                                W5458)
                                                                               (shen/let
                                                                                W5459
                                                                                (shen/head
                                                                                 W5458)
                                                                                (shen/let
                                                                                 W5460
                                                                                 (shen/tail
                                                                                  W5458)
                                                                                 (shen/shen.comb
                                                                                  W5460
                                                                                  (shen/@p
                                                                                   W5453
                                                                                   (shen/shen.correct
                                                                                    (list
                                                                                     'where
                                                                                     W5459
                                                                                     W5456))))))
                                                                               (shen/shen.parse-failure)))
                                                                             (shen/shen.parse-failure))))
                                                                          (shen/shen.parse-failure)))
                                                               (shen/shen.parse-failure))))))
                               (shen/if (shen/shen.parse-failure? W5451)
                                        (shen/let W5461
                                                  (shen/let W5462
                                                            (shen/shen.<patterns>
                                                             V5440)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W5462)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W5463
                                                                       (shen/shen.<-out
                                                                        W5462)
                                                                       (shen/let
                                                                        W5464
                                                                        (shen/shen.in->
                                                                         W5462)
                                                                        (shen/if
                                                                         (shen/shen.hds=?
                                                                          W5464
                                                                          '<-)
                                                                         (shen/let
                                                                          W5465
                                                                          (shen/tail
                                                                           W5464)
                                                                          (shen/if
                                                                           (shen/cons?
                                                                            W5465)
                                                                           (shen/let
                                                                            W5466
                                                                            (shen/head
                                                                             W5465)
                                                                            (shen/let
                                                                             W5467
                                                                             (shen/tail
                                                                              W5465)
                                                                             (shen/shen.comb
                                                                              W5467
                                                                              (shen/@p
                                                                               W5463
                                                                               (shen/shen.correct
                                                                                W5466)))))
                                                                           (shen/shen.parse-failure)))
                                                                         (shen/shen.parse-failure))))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W5461)
                                                   (shen/let W5468
                                                             (shen/let W5469
                                                                       (shen/shen.<patterns>
                                                                        V5440)
                                                                       (shen/if
                                                                        (shen/shen.parse-failure?
                                                                         W5469)
                                                                        (shen/shen.parse-failure)
                                                                        (shen/let
                                                                         W5470
                                                                         (shen/shen.<-out
                                                                          W5469)
                                                                         (shen/let
                                                                          W5471
                                                                          (shen/shen.in->
                                                                           W5469)
                                                                          (shen/if
                                                                           (shen/shen.hds=?
                                                                            W5471
                                                                            '->)
                                                                           (shen/let
                                                                            W5472
                                                                            (shen/tail
                                                                             W5471)
                                                                            (shen/if
                                                                             (shen/cons?
                                                                              W5472)
                                                                             (shen/let
                                                                              W5473
                                                                              (shen/head
                                                                               W5472)
                                                                              (shen/let
                                                                               W5474
                                                                               (shen/tail
                                                                                W5472)
                                                                               (shen/shen.comb
                                                                                W5474
                                                                                (shen/@p
                                                                                 W5470
                                                                                 W5473))))
                                                                             (shen/shen.parse-failure)))
                                                                           (shen/shen.parse-failure))))))
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W5468)
                                                              (shen/shen.parse-failure)
                                                              W5468))
                                                   W5461))
                                        W5451))
                     W5441)))
(defun shen/shen.correct (V5475)
  (shen/cond
   ((shen/and (shen/cons? V5475)
              (shen/and (shen/= 'where (shen/hd V5475))
                        (shen/and (shen/cons? (nthcdr 1 V5475))
                                  (shen/and (shen/cons? (nthcdr 2 V5475))
                                            (shen/and
                                             (shen/cons?
                                              (shen/hd (nthcdr 2 V5475)))
                                             (shen/and
                                              (shen/= 'fail-if
                                                      (shen/hd
                                                       (shen/hd (nthcdr 2 V5475))))
                                              (shen/and
                                               (shen/cons?
                                                (nthcdr 1
                                                        (shen/hd
                                                         (nthcdr 2 V5475))))
                                               (shen/and
                                                (shen/cons?
                                                 (nthcdr 2
                                                         (shen/hd
                                                          (nthcdr 2 V5475))))
                                                (shen/and
                                                 (shen/internal/predicate->shen
                                                  (null
                                                   (nthcdr 3
                                                           (shen/hd
                                                            (nthcdr 2 V5475)))))
                                                 (shen/internal/predicate->shen
                                                  (null (nthcdr 3 V5475))))))))))))
    (append
     (list 'where
           (list 'and (shen/hd (nthcdr 1 V5475))
                 (list 'not (nthcdr 1 (shen/hd (nthcdr 2 V5475))))))
     (nthcdr 2 (shen/hd (nthcdr 2 V5475)))))
   ((shen/and (shen/cons? V5475)
              (shen/and (shen/= 'where (shen/hd V5475))
                        (shen/and (shen/cons? (nthcdr 1 V5475))
                                  (shen/and (shen/cons? (nthcdr 2 V5475))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V5475)))))))
    (append
     (list 'where
           (list 'and (shen/hd (nthcdr 1 V5475))
                 (list 'not (list '= (shen/hd (nthcdr 2 V5475)) (list 'fail)))))
     (nthcdr 2 V5475)))
   ((shen/and (shen/cons? V5475)
              (shen/and (shen/= 'fail-if (shen/hd V5475))
                        (shen/and (shen/cons? (nthcdr 1 V5475))
                                  (shen/and (shen/cons? (nthcdr 2 V5475))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V5475)))))))
    (append (list 'where (list 'not (nthcdr 1 V5475))) (nthcdr 2 V5475)))
   (shen/true (list 'where (list 'not (list '= V5475 (list 'fail))) V5475))))
(defun shen/shen.t*-rules (V5476 V5477 V5478 V5479 V5480 V5481 V5482 V5483)
  (shen/let W5484 (1+ V5482)
            (shen/let W5485
                      (shen/if (shen/shen.unlocked? V5481)
                               (shen/let W5486 (shen/shen.lazyderef V5477 V5480)
                                         (shen/if
                                          (shen/internal/predicate->shen
                                           (null W5486))
                                          (shen/do (shen/shen.incinfs)
                                                   (shen/thaw V5483))
                                          'false))
                               'false)
                      (shen/if (shen/= W5485 'false)
                               (shen/let W5487
                                         (shen/if (shen/shen.unlocked? V5481)
                                                  (shen/let W5488
                                                            (shen/shen.lazyderef
                                                             V5477 V5480)
                                                            (shen/if
                                                             (shen/cons? W5488)
                                                             (shen/let W5489
                                                                       (shen/hd
                                                                        W5488)
                                                                       (shen/let
                                                                        W5490
                                                                        (nthcdr
                                                                         1 W5488)
                                                                        (shen/let
                                                                         W5491
                                                                         (shen/shen.newpv
                                                                          V5480)
                                                                         (shen/shen.gc
                                                                          V5480
                                                                          (shen/do
                                                                           (shen/shen.incinfs)
                                                                           (shen/bind
                                                                            W5491
                                                                            (shen/shen.freshen-rule
                                                                             (shen/shen.deref
                                                                              W5489
                                                                              V5480))
                                                                            V5480
                                                                            V5481
                                                                            W5484
                                                                            (shen/freeze
                                                                             (shen/shen.t*-rule
                                                                              V5476
                                                                              V5479
                                                                              (shen/fst
                                                                               (shen/shen.lazyderef
                                                                                W5491
                                                                                V5480))
                                                                              (shen/snd
                                                                               (shen/shen.lazyderef
                                                                                W5491
                                                                                V5480))
                                                                              V5478
                                                                              V5480
                                                                              V5481
                                                                              W5484
                                                                              (shen/freeze
                                                                               (shen/shen.cut
                                                                                V5480
                                                                                V5481
                                                                                W5484
                                                                                (shen/freeze
                                                                                 (shen/shen.t*-rules
                                                                                  V5476
                                                                                  W5490
                                                                                  V5478
                                                                                  (1+
                                                                                   V5479)
                                                                                  V5480
                                                                                  V5481
                                                                                  W5484
                                                                                  V5483))))))))))))
                                                             'false))
                                                  'false)
                                         (shen/if (shen/= W5487 'false)
                                                  (shen/shen.unlock V5481 W5484)
                                                  W5487))
                               W5485))))
(defun shen/shen.freshen-rule (V5492)
  (shen/cond
   ((shen/tuple? V5492)
    (shen/let W5493 (shen/shen.extract-vars (shen/fst V5492))
              (shen/let W5494
                        (shen/map
                         (shen/lambda Z5495
                                      (append (list Z5495)
                                              (shen/shen.freshterm Z5495)))
                         W5493)
                        (shen/@p (shen/shen.freshen W5494 (shen/fst V5492))
                                 (shen/shen.freshen W5494 (shen/snd V5492))))))
   (shen/true (shen/shen.f-error 'shen.freshen-rule))))
(defun shen/shen.freshen (V5496 V5497)
  (cl-flet
      ((tail-trampoline (V5496 V5497)
         (shen/cond ((shen/internal/predicate->shen (null V5496)) V5497)
                    ((shen/and (shen/cons? V5496) (shen/cons? (shen/hd V5496)))
                     (vector
                      (list (nthcdr 1 V5496)
                            (shen/shen.beta (shen/hd (shen/hd V5496))
                                            (nthcdr 1 (shen/hd V5496)) V5497))))
                    (shen/true (shen/shen.f-error 'shen.freshen)))))
    (let ((result (funcall #'tail-trampoline V5496 V5497)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.t*-rule (V5498 V5499 V5500 V5501 V5502 V5503 V5504 V5505 V5506)
  (shen/let W5507
            (shen/if (shen/shen.unlocked? V5504)
                     (shen/do (shen/shen.incinfs)
                              (shen/shen.t*-rule-h V5500 V5501 V5502 V5503 V5504
                                                   V5505 V5506))
                     'false)
            (shen/if (shen/= W5507 'false)
                     (shen/if (shen/shen.unlocked? V5504)
                              (shen/let W5508 (shen/shen.newpv V5503)
                                        (shen/shen.gc V5503
                                                      (shen/do
                                                       (shen/shen.incinfs)
                                                       (shen/bind W5508
                                                                  (shen/simple-error
                                                                   (shen/cn
                                                                    "type error in rule "
                                                                    (shen/shen.app
                                                                     V5499
                                                                     (shen/cn
                                                                      " of "
                                                                      (shen/shen.app
                                                                       V5498
                                                                       "\n"
                                                                       'shen.a))
                                                                     'shen.a)))
                                                                  V5503 V5504
                                                                  V5505 V5506))))
                              'false)
                     W5507)))
(defun shen/shen.t*-rule-h (V5509 V5510 V5511 V5512 V5513 V5514 V5515)
  (shen/let W5516 (1+ V5514)
            (shen/let W5517
                      (shen/if (shen/shen.unlocked? V5513)
                               (shen/let W5518 (shen/shen.lazyderef V5509 V5512)
                                         (shen/if
                                          (shen/internal/predicate->shen
                                           (null W5518))
                                          (shen/let W5519
                                                    (shen/shen.lazyderef V5511
                                                                         V5512)
                                                    (shen/if (shen/cons? W5519)
                                                             (shen/let W5520
                                                                       (shen/shen.lazyderef
                                                                        (shen/hd
                                                                         W5519)
                                                                        V5512)
                                                                       (shen/if
                                                                        (shen/=
                                                                         W5520
                                                                         '-->)
                                                                        (shen/let
                                                                         W5521
                                                                         (shen/shen.lazyderef
                                                                          (nthcdr
                                                                           1
                                                                           W5519)
                                                                          V5512)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5521)
                                                                          (shen/let
                                                                           W5522
                                                                           (shen/hd
                                                                            W5521)
                                                                           (shen/let
                                                                            W5523
                                                                            (shen/shen.lazyderef
                                                                             (nthcdr
                                                                              1
                                                                              W5521)
                                                                             V5512)
                                                                            (shen/if
                                                                             (shen/internal/predicate->shen
                                                                              (null
                                                                               W5523))
                                                                             (shen/do
                                                                              (shen/shen.incinfs)
                                                                              (shen/shen.cut
                                                                               V5512
                                                                               V5513
                                                                               W5516
                                                                               (shen/freeze
                                                                                (shen/shen.t*-correct
                                                                                 V5510
                                                                                 W5522
                                                                                 nil
                                                                                 V5512
                                                                                 V5513
                                                                                 W5516
                                                                                 V5515))))
                                                                             'false)))
                                                                          'false))
                                                                        'false))
                                                             'false))
                                          'false))
                               'false)
                      (shen/if (shen/= W5517 'false)
                               (shen/let W5524
                                         (shen/if (shen/shen.unlocked? V5513)
                                                  (shen/let W5525
                                                            (shen/shen.newpv
                                                             V5512)
                                                            (shen/shen.gc V5512
                                                                          (shen/let
                                                                           W5526
                                                                           (shen/shen.newpv
                                                                            V5512)
                                                                           (shen/shen.gc
                                                                            V5512
                                                                            (shen/let
                                                                             W5527
                                                                             (shen/shen.newpv
                                                                              V5512)
                                                                             (shen/shen.gc
                                                                              V5512
                                                                              (shen/do
                                                                               (shen/shen.incinfs)
                                                                               (shen/shen.p-hyps
                                                                                (shen/shen.freshterms
                                                                                 V5509)
                                                                                W5525
                                                                                V5512
                                                                                V5513
                                                                                W5516
                                                                                (shen/freeze
                                                                                 (shen/shen.t*-integrity
                                                                                  V5509
                                                                                  V5511
                                                                                  W5525
                                                                                  W5526
                                                                                  V5512
                                                                                  V5513
                                                                                  W5516
                                                                                  (shen/freeze
                                                                                   (shen/shen.cut
                                                                                    V5512
                                                                                    V5513
                                                                                    W5516
                                                                                    (shen/freeze
                                                                                     (shen/shen.myassume
                                                                                      V5509
                                                                                      V5511
                                                                                      W5527
                                                                                      V5512
                                                                                      V5513
                                                                                      W5516
                                                                                      (shen/freeze
                                                                                       (shen/shen.t*-correct
                                                                                        V5510
                                                                                        W5526
                                                                                        W5527
                                                                                        V5512
                                                                                        V5513
                                                                                        W5516
                                                                                        V5515))))))))))))))))
                                                  'false)
                                         (shen/if (shen/= W5524 'false)
                                                  (shen/shen.unlock V5513 W5516)
                                                  W5524))
                               W5517))))
(defun shen/shen.myassume (V5528 V5529 V5530 V5531 V5532 V5533 V5534)
  (shen/let W5535
            (shen/if (shen/shen.unlocked? V5532)
                     (shen/let W5536 (shen/shen.lazyderef V5528 V5531)
                               (shen/if
                                (shen/internal/predicate->shen (null W5536))
                                (shen/let W5537
                                          (shen/shen.lazyderef V5530 V5531)
                                          (shen/let W5538
                                                    (shen/freeze
                                                     (shen/do
                                                      (shen/shen.incinfs)
                                                      (shen/thaw V5534)))
                                                    (shen/if
                                                     (shen/internal/predicate->shen
                                                      (null W5537))
                                                     (shen/thaw W5538)
                                                     (shen/if
                                                      (shen/shen.pvar? W5537)
                                                      (shen/shen.bind! W5537 nil
                                                                       V5531
                                                                       W5538)
                                                      'false))))
                                'false))
                     'false)
            (shen/if (shen/= W5535 'false)
                     (shen/if (shen/shen.unlocked? V5532)
                              (shen/let W5539 (shen/shen.lazyderef V5528 V5531)
                                        (shen/if (shen/cons? W5539)
                                                 (shen/let W5540 (shen/hd W5539)
                                                           (shen/let W5541
                                                                     (nthcdr 1
                                                                             W5539)
                                                                     (shen/let
                                                                      W5542
                                                                      (shen/shen.lazyderef
                                                                       V5529
                                                                       V5531)
                                                                      (shen/if
                                                                       (shen/cons?
                                                                        W5542)
                                                                       (shen/let
                                                                        W5543
                                                                        (shen/hd
                                                                         W5542)
                                                                        (shen/let
                                                                         W5544
                                                                         (shen/shen.lazyderef
                                                                          (nthcdr
                                                                           1
                                                                           W5542)
                                                                          V5531)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5544)
                                                                          (shen/let
                                                                           W5545
                                                                           (shen/shen.lazyderef
                                                                            (shen/hd
                                                                             W5544)
                                                                            V5531)
                                                                           (shen/if
                                                                            (shen/=
                                                                             W5545
                                                                             '-->)
                                                                            (shen/let
                                                                             W5546
                                                                             (shen/shen.lazyderef
                                                                              (nthcdr
                                                                               1
                                                                               W5544)
                                                                              V5531)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5546)
                                                                              (shen/let
                                                                               W5547
                                                                               (shen/hd
                                                                                W5546)
                                                                               (shen/let
                                                                                W5548
                                                                                (shen/shen.lazyderef
                                                                                 (nthcdr
                                                                                  1
                                                                                  W5546)
                                                                                 V5531)
                                                                                (shen/if
                                                                                 (shen/internal/predicate->shen
                                                                                  (null
                                                                                   W5548))
                                                                                 (shen/let
                                                                                  W5549
                                                                                  (shen/shen.lazyderef
                                                                                   V5530
                                                                                   V5531)
                                                                                  (shen/let
                                                                                   W5550
                                                                                   (shen/lambda
                                                                                    Z5551
                                                                                    (shen/lambda
                                                                                     Z5552
                                                                                     (shen/lambda
                                                                                      Z5553
                                                                                      (shen/lambda
                                                                                       Z5554
                                                                                       (shen/do
                                                                                        (shen/shen.incinfs)
                                                                                        (shen/is!
                                                                                         W5543
                                                                                         Z5553
                                                                                         V5531
                                                                                         V5532
                                                                                         V5533
                                                                                         (shen/freeze
                                                                                          (shen/is!
                                                                                           W5540
                                                                                           Z5551
                                                                                           V5531
                                                                                           V5532
                                                                                           V5533
                                                                                           (shen/freeze
                                                                                            (shen/bind
                                                                                             Z5552
                                                                                             (shen/intern
                                                                                              ":")
                                                                                             V5531
                                                                                             V5532
                                                                                             V5533
                                                                                             (shen/freeze
                                                                                              (shen/shen.myassume
                                                                                               W5541
                                                                                               W5547
                                                                                               Z5554
                                                                                               V5531
                                                                                               V5532
                                                                                               V5533
                                                                                               V5534))))))))))))
                                                                                   (shen/if
                                                                                    (shen/cons?
                                                                                     W5549)
                                                                                    (shen/let
                                                                                     W5555
                                                                                     (shen/shen.lazyderef
                                                                                      (shen/hd
                                                                                       W5549)
                                                                                      V5531)
                                                                                     (shen/let
                                                                                      W5556
                                                                                      (shen/lambda
                                                                                       Z5557
                                                                                       (shen/lambda
                                                                                        Z5558
                                                                                        (shen/lambda
                                                                                         Z5559
                                                                                         (shen/let
                                                                                          W5560
                                                                                          (nthcdr
                                                                                           1
                                                                                           W5549)
                                                                                          (shen/internal/apply-function-expression
                                                                                           (shen/internal/apply-function-expression
                                                                                            (shen/internal/apply-function-expression
                                                                                             (shen/internal/apply-higher-order-function
                                                                                              W5550
                                                                                              (list
                                                                                               Z5557))
                                                                                             (list
                                                                                              Z5558))
                                                                                            (list
                                                                                             Z5559))
                                                                                           (list
                                                                                            W5560))))))
                                                                                      (shen/if
                                                                                       (shen/cons?
                                                                                        W5555)
                                                                                       (shen/let
                                                                                        W5561
                                                                                        (shen/hd
                                                                                         W5555)
                                                                                        (shen/let
                                                                                         W5562
                                                                                         (shen/shen.lazyderef
                                                                                          (nthcdr
                                                                                           1
                                                                                           W5555)
                                                                                          V5531)
                                                                                         (shen/let
                                                                                          W5563
                                                                                          (shen/lambda
                                                                                           Z5564
                                                                                           (shen/lambda
                                                                                            Z5565
                                                                                            (shen/internal/apply-function-expression
                                                                                             (shen/internal/apply-function-expression
                                                                                              (shen/internal/apply-higher-order-function
                                                                                               W5556
                                                                                               (list
                                                                                                W5561))
                                                                                              (list
                                                                                               Z5564))
                                                                                             (list
                                                                                              Z5565))))
                                                                                          (shen/if
                                                                                           (shen/cons?
                                                                                            W5562)
                                                                                           (shen/let
                                                                                            W5566
                                                                                            (shen/hd
                                                                                             W5562)
                                                                                            (shen/let
                                                                                             W5567
                                                                                             (shen/shen.lazyderef
                                                                                              (nthcdr
                                                                                               1
                                                                                               W5562)
                                                                                              V5531)
                                                                                             (shen/let
                                                                                              W5568
                                                                                              (shen/lambda
                                                                                               Z5569
                                                                                               (shen/internal/apply-function-expression
                                                                                                (shen/internal/apply-higher-order-function
                                                                                                 W5563
                                                                                                 (list
                                                                                                  W5566))
                                                                                                (list
                                                                                                 Z5569)))
                                                                                              (shen/if
                                                                                               (shen/cons?
                                                                                                W5567)
                                                                                               (shen/let
                                                                                                W5570
                                                                                                (shen/hd
                                                                                                 W5567)
                                                                                                (shen/let
                                                                                                 W5571
                                                                                                 (shen/shen.lazyderef
                                                                                                  (nthcdr
                                                                                                   1
                                                                                                   W5567)
                                                                                                  V5531)
                                                                                                 (shen/let
                                                                                                  W5572
                                                                                                  (shen/freeze
                                                                                                   (shen/internal/apply-higher-order-function
                                                                                                    W5568
                                                                                                    (list
                                                                                                     W5570)))
                                                                                                  (shen/if
                                                                                                   (shen/internal/predicate->shen
                                                                                                    (null
                                                                                                     W5571))
                                                                                                   (shen/thaw
                                                                                                    W5572)
                                                                                                   (shen/if
                                                                                                    (shen/shen.pvar?
                                                                                                     W5571)
                                                                                                    (shen/shen.bind!
                                                                                                     W5571
                                                                                                     nil
                                                                                                     V5531
                                                                                                     W5572)
                                                                                                    'false)))))
                                                                                               (shen/if
                                                                                                (shen/shen.pvar?
                                                                                                 W5567)
                                                                                                (shen/let
                                                                                                 W5573
                                                                                                 (shen/shen.newpv
                                                                                                  V5531)
                                                                                                 (shen/shen.gc
                                                                                                  V5531
                                                                                                  (shen/shen.bind!
                                                                                                   W5567
                                                                                                   (list
                                                                                                    W5573)
                                                                                                   V5531
                                                                                                   (shen/freeze
                                                                                                    (shen/internal/apply-higher-order-function
                                                                                                     W5568
                                                                                                     (list
                                                                                                      W5573))))))
                                                                                                'false)))))
                                                                                           (shen/if
                                                                                            (shen/shen.pvar?
                                                                                             W5562)
                                                                                            (shen/let
                                                                                             W5574
                                                                                             (shen/shen.newpv
                                                                                              V5531)
                                                                                             (shen/shen.gc
                                                                                              V5531
                                                                                              (shen/let
                                                                                               W5575
                                                                                               (shen/shen.newpv
                                                                                                V5531)
                                                                                               (shen/shen.gc
                                                                                                V5531
                                                                                                (shen/shen.bind!
                                                                                                 W5562
                                                                                                 (list
                                                                                                  W5574
                                                                                                  W5575)
                                                                                                 V5531
                                                                                                 (shen/freeze
                                                                                                  (shen/internal/apply-function-expression
                                                                                                   (shen/internal/apply-higher-order-function
                                                                                                    W5563
                                                                                                    (list
                                                                                                     W5574))
                                                                                                   (list
                                                                                                    W5575))))))))
                                                                                            'false)))))
                                                                                       (shen/if
                                                                                        (shen/shen.pvar?
                                                                                         W5555)
                                                                                        (shen/let
                                                                                         W5576
                                                                                         (shen/shen.newpv
                                                                                          V5531)
                                                                                         (shen/shen.gc
                                                                                          V5531
                                                                                          (shen/let
                                                                                           W5577
                                                                                           (shen/shen.newpv
                                                                                            V5531)
                                                                                           (shen/shen.gc
                                                                                            V5531
                                                                                            (shen/let
                                                                                             W5578
                                                                                             (shen/shen.newpv
                                                                                              V5531)
                                                                                             (shen/shen.gc
                                                                                              V5531
                                                                                              (shen/shen.bind!
                                                                                               W5555
                                                                                               (list
                                                                                                W5576
                                                                                                W5577
                                                                                                W5578)
                                                                                               V5531
                                                                                               (shen/freeze
                                                                                                (shen/internal/apply-function-expression
                                                                                                 (shen/internal/apply-function-expression
                                                                                                  (shen/internal/apply-higher-order-function
                                                                                                   W5556
                                                                                                   (list
                                                                                                    W5576))
                                                                                                  (list
                                                                                                   W5577))
                                                                                                 (list
                                                                                                  W5578))))))))))
                                                                                        'false))))
                                                                                    (shen/if
                                                                                     (shen/shen.pvar?
                                                                                      W5549)
                                                                                     (shen/let
                                                                                      W5579
                                                                                      (shen/shen.newpv
                                                                                       V5531)
                                                                                      (shen/shen.gc
                                                                                       V5531
                                                                                       (shen/let
                                                                                        W5580
                                                                                        (shen/shen.newpv
                                                                                         V5531)
                                                                                        (shen/shen.gc
                                                                                         V5531
                                                                                         (shen/let
                                                                                          W5581
                                                                                          (shen/shen.newpv
                                                                                           V5531)
                                                                                          (shen/shen.gc
                                                                                           V5531
                                                                                           (shen/let
                                                                                            W5582
                                                                                            (shen/shen.newpv
                                                                                             V5531)
                                                                                            (shen/shen.gc
                                                                                             V5531
                                                                                             (shen/shen.bind!
                                                                                              W5549
                                                                                              (append
                                                                                               (list
                                                                                                (list
                                                                                                 W5579
                                                                                                 W5580
                                                                                                 W5581))
                                                                                               W5582)
                                                                                              V5531
                                                                                              (shen/freeze
                                                                                               (shen/internal/apply-function-expression
                                                                                                (shen/internal/apply-function-expression
                                                                                                 (shen/internal/apply-function-expression
                                                                                                  (shen/internal/apply-higher-order-function
                                                                                                   W5550
                                                                                                   (list
                                                                                                    W5579))
                                                                                                  (list
                                                                                                   W5580))
                                                                                                 (list
                                                                                                  W5581))
                                                                                                (list
                                                                                                 W5582))))))))))))
                                                                                     'false))))
                                                                                 'false)))
                                                                              'false))
                                                                            'false))
                                                                          'false)))
                                                                       'false))))
                                                 'false))
                              'false)
                     W5535)))
(defun shen/shen.freshterms (V5585)
  (cl-flet
      ((tail-trampoline (V5585)
         (shen/cond ((shen/internal/predicate->shen (null V5585)) nil)
                    ((shen/and (shen/cons? V5585) (shen/cons? (shen/hd V5585)))
                     (vector
                      (list (shen/append (shen/hd V5585) (nthcdr 1 V5585)))))
                    ((shen/and (shen/cons? V5585)
                               (shen/shen.freshterm? (shen/hd V5585)))
                     (shen/adjoin (shen/hd V5585)
                                  (shen/shen.freshterms (nthcdr 1 V5585))))
                    ((shen/cons? V5585) (vector (list (nthcdr 1 V5585))))
                    (shen/true (shen/shen.f-error 'shen.freshterms)))))
    (let ((result (funcall #'tail-trampoline V5585)))
      (while (vectorp result)
        (setq result (apply #'tail-trampoline (aref result 0))))
      result)))
(defun shen/shen.p-hyps (V5586 V5587 V5588 V5589 V5590 V5591)
  (shen/let W5592
            (shen/if (shen/shen.unlocked? V5589)
                     (shen/let W5593 (shen/shen.lazyderef V5586 V5588)
                               (shen/if
                                (shen/internal/predicate->shen (null W5593))
                                (shen/let W5594
                                          (shen/shen.lazyderef V5587 V5588)
                                          (shen/let W5595
                                                    (shen/freeze
                                                     (shen/do
                                                      (shen/shen.incinfs)
                                                      (shen/thaw V5591)))
                                                    (shen/if
                                                     (shen/internal/predicate->shen
                                                      (null W5594))
                                                     (shen/thaw W5595)
                                                     (shen/if
                                                      (shen/shen.pvar? W5594)
                                                      (shen/shen.bind! W5594 nil
                                                                       V5588
                                                                       W5595)
                                                      'false))))
                                'false))
                     'false)
            (shen/if (shen/= W5592 'false)
                     (shen/if (shen/shen.unlocked? V5589)
                              (shen/let W5596 (shen/shen.lazyderef V5586 V5588)
                                        (shen/if (shen/cons? W5596)
                                                 (shen/let W5597 (shen/hd W5596)
                                                           (shen/let W5598
                                                                     (nthcdr 1
                                                                             W5596)
                                                                     (shen/let
                                                                      W5599
                                                                      (shen/shen.lazyderef
                                                                       V5587
                                                                       V5588)
                                                                      (shen/let
                                                                       W5600
                                                                       (shen/lambda
                                                                        Z5601
                                                                        (shen/lambda
                                                                         Z5602
                                                                         (shen/lambda
                                                                          Z5603
                                                                          (shen/lambda
                                                                           Z5604
                                                                           (shen/do
                                                                            (shen/shen.incinfs)
                                                                            (shen/bind
                                                                             Z5601
                                                                             W5597
                                                                             V5588
                                                                             V5589
                                                                             V5590
                                                                             (shen/freeze
                                                                              (shen/bind
                                                                               Z5602
                                                                               (shen/intern
                                                                                ":")
                                                                               V5588
                                                                               V5589
                                                                               V5590
                                                                               (shen/freeze
                                                                                (shen/shen.p-hyps
                                                                                 W5598
                                                                                 Z5604
                                                                                 V5588
                                                                                 V5589
                                                                                 V5590
                                                                                 V5591))))))))))
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         W5599)
                                                                        (shen/let
                                                                         W5605
                                                                         (shen/shen.lazyderef
                                                                          (shen/hd
                                                                           W5599)
                                                                          V5588)
                                                                         (shen/let
                                                                          W5606
                                                                          (shen/lambda
                                                                           Z5607
                                                                           (shen/lambda
                                                                            Z5608
                                                                            (shen/lambda
                                                                             Z5609
                                                                             (shen/let
                                                                              W5610
                                                                              (nthcdr
                                                                               1
                                                                               W5599)
                                                                              (shen/internal/apply-function-expression
                                                                               (shen/internal/apply-function-expression
                                                                                (shen/internal/apply-function-expression
                                                                                 (shen/internal/apply-higher-order-function
                                                                                  W5600
                                                                                  (list
                                                                                   Z5607))
                                                                                 (list
                                                                                  Z5608))
                                                                                (list
                                                                                 Z5609))
                                                                               (list
                                                                                W5610))))))
                                                                          (shen/if
                                                                           (shen/cons?
                                                                            W5605)
                                                                           (shen/let
                                                                            W5611
                                                                            (shen/hd
                                                                             W5605)
                                                                            (shen/let
                                                                             W5612
                                                                             (shen/shen.lazyderef
                                                                              (nthcdr
                                                                               1
                                                                               W5605)
                                                                              V5588)
                                                                             (shen/let
                                                                              W5613
                                                                              (shen/lambda
                                                                               Z5614
                                                                               (shen/lambda
                                                                                Z5615
                                                                                (shen/internal/apply-function-expression
                                                                                 (shen/internal/apply-function-expression
                                                                                  (shen/internal/apply-higher-order-function
                                                                                   W5606
                                                                                   (list
                                                                                    W5611))
                                                                                  (list
                                                                                   Z5614))
                                                                                 (list
                                                                                  Z5615))))
                                                                              (shen/if
                                                                               (shen/cons?
                                                                                W5612)
                                                                               (shen/let
                                                                                W5616
                                                                                (shen/hd
                                                                                 W5612)
                                                                                (shen/let
                                                                                 W5617
                                                                                 (shen/shen.lazyderef
                                                                                  (nthcdr
                                                                                   1
                                                                                   W5612)
                                                                                  V5588)
                                                                                 (shen/let
                                                                                  W5618
                                                                                  (shen/lambda
                                                                                   Z5619
                                                                                   (shen/internal/apply-function-expression
                                                                                    (shen/internal/apply-higher-order-function
                                                                                     W5613
                                                                                     (list
                                                                                      W5616))
                                                                                    (list
                                                                                     Z5619)))
                                                                                  (shen/if
                                                                                   (shen/cons?
                                                                                    W5617)
                                                                                   (shen/let
                                                                                    W5620
                                                                                    (shen/hd
                                                                                     W5617)
                                                                                    (shen/let
                                                                                     W5621
                                                                                     (shen/shen.lazyderef
                                                                                      (nthcdr
                                                                                       1
                                                                                       W5617)
                                                                                      V5588)
                                                                                     (shen/let
                                                                                      W5622
                                                                                      (shen/freeze
                                                                                       (shen/internal/apply-higher-order-function
                                                                                        W5618
                                                                                        (list
                                                                                         W5620)))
                                                                                      (shen/if
                                                                                       (shen/internal/predicate->shen
                                                                                        (null
                                                                                         W5621))
                                                                                       (shen/thaw
                                                                                        W5622)
                                                                                       (shen/if
                                                                                        (shen/shen.pvar?
                                                                                         W5621)
                                                                                        (shen/shen.bind!
                                                                                         W5621
                                                                                         nil
                                                                                         V5588
                                                                                         W5622)
                                                                                        'false)))))
                                                                                   (shen/if
                                                                                    (shen/shen.pvar?
                                                                                     W5617)
                                                                                    (shen/let
                                                                                     W5623
                                                                                     (shen/shen.newpv
                                                                                      V5588)
                                                                                     (shen/shen.gc
                                                                                      V5588
                                                                                      (shen/shen.bind!
                                                                                       W5617
                                                                                       (list
                                                                                        W5623)
                                                                                       V5588
                                                                                       (shen/freeze
                                                                                        (shen/internal/apply-higher-order-function
                                                                                         W5618
                                                                                         (list
                                                                                          W5623))))))
                                                                                    'false)))))
                                                                               (shen/if
                                                                                (shen/shen.pvar?
                                                                                 W5612)
                                                                                (shen/let
                                                                                 W5624
                                                                                 (shen/shen.newpv
                                                                                  V5588)
                                                                                 (shen/shen.gc
                                                                                  V5588
                                                                                  (shen/let
                                                                                   W5625
                                                                                   (shen/shen.newpv
                                                                                    V5588)
                                                                                   (shen/shen.gc
                                                                                    V5588
                                                                                    (shen/shen.bind!
                                                                                     W5612
                                                                                     (list
                                                                                      W5624
                                                                                      W5625)
                                                                                     V5588
                                                                                     (shen/freeze
                                                                                      (shen/internal/apply-function-expression
                                                                                       (shen/internal/apply-higher-order-function
                                                                                        W5613
                                                                                        (list
                                                                                         W5624))
                                                                                       (list
                                                                                        W5625))))))))
                                                                                'false)))))
                                                                           (shen/if
                                                                            (shen/shen.pvar?
                                                                             W5605)
                                                                            (shen/let
                                                                             W5626
                                                                             (shen/shen.newpv
                                                                              V5588)
                                                                             (shen/shen.gc
                                                                              V5588
                                                                              (shen/let
                                                                               W5627
                                                                               (shen/shen.newpv
                                                                                V5588)
                                                                               (shen/shen.gc
                                                                                V5588
                                                                                (shen/let
                                                                                 W5628
                                                                                 (shen/shen.newpv
                                                                                  V5588)
                                                                                 (shen/shen.gc
                                                                                  V5588
                                                                                  (shen/shen.bind!
                                                                                   W5605
                                                                                   (list
                                                                                    W5626
                                                                                    W5627
                                                                                    W5628)
                                                                                   V5588
                                                                                   (shen/freeze
                                                                                    (shen/internal/apply-function-expression
                                                                                     (shen/internal/apply-function-expression
                                                                                      (shen/internal/apply-higher-order-function
                                                                                       W5606
                                                                                       (list
                                                                                        W5626))
                                                                                      (list
                                                                                       W5627))
                                                                                     (list
                                                                                      W5628))))))))))
                                                                            'false))))
                                                                        (shen/if
                                                                         (shen/shen.pvar?
                                                                          W5599)
                                                                         (shen/let
                                                                          W5629
                                                                          (shen/shen.newpv
                                                                           V5588)
                                                                          (shen/shen.gc
                                                                           V5588
                                                                           (shen/let
                                                                            W5630
                                                                            (shen/shen.newpv
                                                                             V5588)
                                                                            (shen/shen.gc
                                                                             V5588
                                                                             (shen/let
                                                                              W5631
                                                                              (shen/shen.newpv
                                                                               V5588)
                                                                              (shen/shen.gc
                                                                               V5588
                                                                               (shen/let
                                                                                W5632
                                                                                (shen/shen.newpv
                                                                                 V5588)
                                                                                (shen/shen.gc
                                                                                 V5588
                                                                                 (shen/shen.bind!
                                                                                  W5599
                                                                                  (append
                                                                                   (list
                                                                                    (list
                                                                                     W5629
                                                                                     W5630
                                                                                     W5631))
                                                                                   W5632)
                                                                                  V5588
                                                                                  (shen/freeze
                                                                                   (shen/internal/apply-function-expression
                                                                                    (shen/internal/apply-function-expression
                                                                                     (shen/internal/apply-function-expression
                                                                                      (shen/internal/apply-higher-order-function
                                                                                       W5600
                                                                                       (list
                                                                                        W5629))
                                                                                      (list
                                                                                       W5630))
                                                                                     (list
                                                                                      W5631))
                                                                                    (list
                                                                                     W5632))))))))))))
                                                                         'false))))))
                                                 'false))
                              'false)
                     W5592)))
(defun shen/shen.t*-correct (V5633 V5634 V5635 V5636 V5637 V5638 V5639)
  (shen/let W5640 (1+ V5638)
            (shen/let W5641
                      (shen/if (shen/shen.unlocked? V5637)
                               (shen/let W5642 (shen/shen.lazyderef V5633 V5636)
                                         (shen/if (shen/cons? W5642)
                                                  (shen/let W5643
                                                            (shen/shen.lazyderef
                                                             (shen/hd W5642)
                                                             V5636)
                                                            (shen/if
                                                             (shen/= W5643
                                                                     'where)
                                                             (shen/let W5644
                                                                       (shen/shen.lazyderef
                                                                        (nthcdr
                                                                         1 W5642)
                                                                        V5636)
                                                                       (shen/if
                                                                        (shen/cons?
                                                                         W5644)
                                                                        (shen/let
                                                                         W5645
                                                                         (shen/hd
                                                                          W5644)
                                                                         (shen/let
                                                                          W5646
                                                                          (shen/shen.lazyderef
                                                                           (nthcdr
                                                                            1
                                                                            W5644)
                                                                           V5636)
                                                                          (shen/if
                                                                           (shen/cons?
                                                                            W5646)
                                                                           (shen/let
                                                                            W5647
                                                                            (shen/hd
                                                                             W5646)
                                                                            (shen/let
                                                                             W5648
                                                                             (shen/shen.lazyderef
                                                                              (nthcdr
                                                                               1
                                                                               W5646)
                                                                              V5636)
                                                                             (shen/if
                                                                              (shen/internal/predicate->shen
                                                                               (null
                                                                                W5648))
                                                                              (shen/let
                                                                               W5649
                                                                               (shen/shen.newpv
                                                                                V5636)
                                                                               (shen/shen.gc
                                                                                V5636
                                                                                (shen/do
                                                                                 (shen/shen.incinfs)
                                                                                 (shen/shen.cut
                                                                                  V5636
                                                                                  V5637
                                                                                  W5640
                                                                                  (shen/freeze
                                                                                   (shen/bind
                                                                                    W5649
                                                                                    (shen/shen.curry
                                                                                     W5645)
                                                                                    V5636
                                                                                    V5637
                                                                                    W5640
                                                                                    (shen/freeze
                                                                                     (shen/shen.system-S-h
                                                                                      W5649
                                                                                      'boolean
                                                                                      V5635
                                                                                      V5636
                                                                                      V5637
                                                                                      W5640
                                                                                      (shen/freeze
                                                                                       (shen/shen.cut
                                                                                        V5636
                                                                                        V5637
                                                                                        W5640
                                                                                        (shen/freeze
                                                                                         (shen/shen.t*-correct
                                                                                          W5647
                                                                                          V5634
                                                                                          (append
                                                                                           (list
                                                                                            (list
                                                                                             W5649
                                                                                             (shen/intern
                                                                                              ":")
                                                                                             'verified))
                                                                                           V5635)
                                                                                          V5636
                                                                                          V5637
                                                                                          W5640
                                                                                          V5639))))))))))))
                                                                              'false)))
                                                                           'false)))
                                                                        'false))
                                                             'false))
                                                  'false))
                               'false)
                      (shen/if (shen/= W5641 'false)
                               (shen/let W5650
                                         (shen/if (shen/shen.unlocked? V5637)
                                                  (shen/do (shen/shen.incinfs)
                                                           (shen/shen.system-S-h
                                                            (shen/shen.curry
                                                             V5633)
                                                            V5634 V5635 V5636
                                                            V5637 W5640 V5639))
                                                  'false)
                                         (shen/if (shen/= W5650 'false)
                                                  (shen/shen.unlock V5637 W5640)
                                                  W5650))
                               W5641))))
(defun shen/shen.t*-integrity (V5651 V5652 V5653 V5654 V5655 V5656 V5657 V5658)
  (shen/let W5659
            (shen/if (shen/shen.unlocked? V5656)
                     (shen/let W5660 (shen/shen.lazyderef V5651 V5655)
                               (shen/if
                                (shen/internal/predicate->shen (null W5660))
                                (shen/do (shen/shen.incinfs)
                                         (shen/is! V5652 V5654 V5655 V5656 V5657
                                                   V5658))
                                'false))
                     'false)
            (shen/if (shen/= W5659 'false)
                     (shen/if (shen/shen.unlocked? V5656)
                              (shen/let W5661 (shen/shen.lazyderef V5651 V5655)
                                        (shen/if (shen/cons? W5661)
                                                 (shen/let W5662 (shen/hd W5661)
                                                           (shen/let W5663
                                                                     (nthcdr 1
                                                                             W5661)
                                                                     (shen/let
                                                                      W5664
                                                                      (shen/shen.lazyderef
                                                                       V5652
                                                                       V5655)
                                                                      (shen/if
                                                                       (shen/cons?
                                                                        W5664)
                                                                       (shen/let
                                                                        W5665
                                                                        (shen/hd
                                                                         W5664)
                                                                        (shen/let
                                                                         W5666
                                                                         (shen/shen.lazyderef
                                                                          (nthcdr
                                                                           1
                                                                           W5664)
                                                                          V5655)
                                                                         (shen/if
                                                                          (shen/cons?
                                                                           W5666)
                                                                          (shen/let
                                                                           W5667
                                                                           (shen/shen.lazyderef
                                                                            (shen/hd
                                                                             W5666)
                                                                            V5655)
                                                                           (shen/if
                                                                            (shen/=
                                                                             W5667
                                                                             '-->)
                                                                            (shen/let
                                                                             W5668
                                                                             (shen/shen.lazyderef
                                                                              (nthcdr
                                                                               1
                                                                               W5666)
                                                                              V5655)
                                                                             (shen/if
                                                                              (shen/cons?
                                                                               W5668)
                                                                              (shen/let
                                                                               W5669
                                                                               (shen/hd
                                                                                W5668)
                                                                               (shen/let
                                                                                W5670
                                                                                (shen/shen.lazyderef
                                                                                 (nthcdr
                                                                                  1
                                                                                  W5668)
                                                                                 V5655)
                                                                                (shen/if
                                                                                 (shen/internal/predicate->shen
                                                                                  (null
                                                                                   W5670))
                                                                                 (shen/do
                                                                                  (shen/shen.incinfs)
                                                                                  (shen/shen.system-S-h
                                                                                   W5662
                                                                                   W5665
                                                                                   V5653
                                                                                   V5655
                                                                                   V5656
                                                                                   V5657
                                                                                   (shen/freeze
                                                                                    (shen/shen.t*-integrity
                                                                                     W5663
                                                                                     W5669
                                                                                     V5653
                                                                                     V5654
                                                                                     V5655
                                                                                     V5656
                                                                                     V5657
                                                                                     V5658))))
                                                                                 'false)))
                                                                              'false))
                                                                            'false))
                                                                          'false)))
                                                                       'false))))
                                                 'false))
                              'false)
                     W5659)))
(defun shen/shen.freshterm? (V5671)
  (shen/and (shen/absvector? V5671)
            (shen/and (shen/not (shen/string? V5671))
                      (shen/= (shen/<-address V5671 0) 'shen.print-freshterm))))
(defun shen/compile (V107 V108)
  (shen/let W109 (shen/internal/apply-higher-order-function V107 (list V108))
            (shen/if (shen/shen.parse-failure? W109)
                     (shen/simple-error "parse failure\n")
                     (shen/if (shen/cons? (shen/shen.in-> W109))
                              (shen/simple-error
                               (shen/cn "syntax error here: "
                                        (shen/shen.app
                                         (shen/hd (shen/shen.in-> W109)) " ..."
                                         'shen.s)))
                              (shen/shen.<-out W109)))))
(defun shen/shen.parse-failure? (V110) (shen/= V110 (shen/fail)))
(defun shen/shen.objectcode (V113)
  (shen/cond
   ((shen/and (shen/cons? V113)
              (shen/and (shen/cons? (nthcdr 1 V113))
                        (shen/internal/predicate->shen (null (nthcdr 2 V113)))))
    (shen/hd (nthcdr 1 V113)))
   (shen/true
    (shen/simple-error (shen/shen.app V113 " is not a YACC stream\n" 'shen.s)))))
(defun shen/shen.yacc->shen (V114)
  (shen/compile (shen/lambda Z115 (shen/shen.<yacc> Z115)) V114))
(defun shen/shen.<yacc> (V116)
  (shen/let W117
            (shen/if (shen/cons? V116)
                     (shen/let W118 (shen/head V116)
                               (shen/let W119 (shen/tail V116)
                                         (shen/let W120
                                                   (shen/shen.<yaccsig> W119)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W120)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W121
                                                              (shen/shen.<-out
                                                               W120)
                                                              (shen/let W122
                                                                        (shen/shen.in->
                                                                         W120)
                                                                        (shen/let
                                                                         W123
                                                                         (shen/shen.<c-rules>
                                                                          W122)
                                                                         (shen/if
                                                                          (shen/shen.parse-failure?
                                                                           W123)
                                                                          (shen/shen.parse-failure)
                                                                          (shen/let
                                                                           W124
                                                                           (shen/shen.<-out
                                                                            W123)
                                                                           (shen/let
                                                                            W125
                                                                            (shen/shen.in->
                                                                             W123)
                                                                            (shen/shen.comb
                                                                             W125
                                                                             (shen/let
                                                                              W126
                                                                              (shen/gensym
                                                                               'S)
                                                                              (shen/let
                                                                               W127
                                                                               (shen/append
                                                                                (list
                                                                                 'define
                                                                                 W118)
                                                                                (shen/append
                                                                                 W121
                                                                                 (list
                                                                                  W126
                                                                                  '->
                                                                                  (shen/shen.c-rules->shen
                                                                                   W121
                                                                                   W126
                                                                                   W124))))
                                                                               W127)))))))))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W117) (shen/shen.parse-failure)
                     W117)))
(defun shen/shen.<yaccsig> (V128)
  (shen/let W129
            (shen/if (shen/cons? V128)
                     (shen/let W130 (shen/head V128)
                               (shen/let W131 (shen/tail V128)
                                         (shen/if (shen/shen.ccons? W131)
                                                  (shen/let W132
                                                            (shen/head W131)
                                                            (shen/let W133
                                                                      (shen/tail
                                                                       W131)
                                                                      (shen/if
                                                                       (shen/shen.hds=?
                                                                        W132
                                                                        'list)
                                                                       (shen/let
                                                                        W134
                                                                        (shen/tail
                                                                         W132)
                                                                        (shen/if
                                                                         (shen/cons?
                                                                          W134)
                                                                         (shen/let
                                                                          W135
                                                                          (shen/head
                                                                           W134)
                                                                          (shen/let
                                                                           W136
                                                                           (shen/tail
                                                                            W134)
                                                                           (shen/let
                                                                            W137
                                                                            (shen/<end>
                                                                             W136)
                                                                            (shen/if
                                                                             (shen/shen.parse-failure?
                                                                              W137)
                                                                             (shen/shen.parse-failure)
                                                                             (shen/let
                                                                              W138
                                                                              (shen/shen.in->
                                                                               W137)
                                                                              (shen/if
                                                                               (shen/shen.hds=?
                                                                                W133
                                                                                '==>)
                                                                               (shen/let
                                                                                W139
                                                                                (shen/tail
                                                                                 W133)
                                                                                (shen/if
                                                                                 (shen/cons?
                                                                                  W139)
                                                                                 (shen/let
                                                                                  W140
                                                                                  (shen/head
                                                                                   W139)
                                                                                  (shen/let
                                                                                   W141
                                                                                   (shen/tail
                                                                                    W139)
                                                                                   (shen/if
                                                                                    (shen/cons?
                                                                                     W141)
                                                                                    (shen/let
                                                                                     W142
                                                                                     (shen/head
                                                                                      W141)
                                                                                     (shen/let
                                                                                      W143
                                                                                      (shen/tail
                                                                                       W141)
                                                                                      (shen/if
                                                                                       (shen/and
                                                                                        (shen/=
                                                                                         '{
                                                                                         W130)
                                                                                        (shen/=
                                                                                         '}
                                                                                         W142))
                                                                                       (shen/shen.comb
                                                                                        W143
                                                                                        (list
                                                                                         '{
                                                                                         (list
                                                                                          'list
                                                                                          W135)
                                                                                         '-->
                                                                                         (list
                                                                                          'str
                                                                                          (list
                                                                                           'list
                                                                                           W135)
                                                                                          W140)
                                                                                         '}))
                                                                                       (shen/shen.parse-failure))))
                                                                                    (shen/shen.parse-failure))))
                                                                                 (shen/shen.parse-failure)))
                                                                               (shen/shen.parse-failure)))))))
                                                                         (shen/shen.parse-failure)))
                                                                       (shen/shen.parse-failure))))
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W129)
                     (shen/let W144
                               (shen/let W145 (shen/<e> V128)
                                         (shen/if
                                          (shen/shen.parse-failure? W145)
                                          (shen/shen.parse-failure)
                                          (shen/let W146 (shen/shen.in-> W145)
                                                    (shen/shen.comb W146 nil))))
                               (shen/if (shen/shen.parse-failure? W144)
                                        (shen/shen.parse-failure) W144))
                     W129)))
(defun shen/shen.<c-rules> (V147)
  (shen/let W148
            (shen/let W149 (shen/shen.<c-rule> V147)
                      (shen/if (shen/shen.parse-failure? W149)
                               (shen/shen.parse-failure)
                               (shen/let W150 (shen/shen.<-out W149)
                                         (shen/let W151 (shen/shen.in-> W149)
                                                   (shen/let W152
                                                             (shen/shen.<c-rules>
                                                              W151)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W152)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W153
                                                                        (shen/shen.<-out
                                                                         W152)
                                                                        (shen/let
                                                                         W154
                                                                         (shen/shen.in->
                                                                          W152)
                                                                         (shen/shen.comb
                                                                          W154
                                                                          (append
                                                                           (list
                                                                            W150)
                                                                           W153))))))))))
            (shen/if (shen/shen.parse-failure? W148)
                     (shen/let W155
                               (shen/let W156 (shen/<!> V147)
                                         (shen/if
                                          (shen/shen.parse-failure? W156)
                                          (shen/shen.parse-failure)
                                          (shen/let W157 (shen/shen.<-out W156)
                                                    (shen/let W158
                                                              (shen/shen.in->
                                                               W156)
                                                              (shen/shen.comb
                                                               W158
                                                               (shen/if
                                                                (shen/empty?
                                                                 W157)
                                                                nil
                                                                (shen/simple-error
                                                                 (shen/cn
                                                                  "YACC syntax error here:\n "
                                                                  (shen/shen.app
                                                                   W157 "\n ..."
                                                                   'shen.r)))))))))
                               (shen/if (shen/shen.parse-failure? W155)
                                        (shen/shen.parse-failure) W155))
                     W148)))
(defun shen/shen.<c-rule> (V159)
  (shen/let W160
            (shen/let W161 (shen/shen.<syntax> V159)
                      (shen/if (shen/shen.parse-failure? W161)
                               (shen/shen.parse-failure)
                               (shen/let W162 (shen/shen.<-out W161)
                                         (shen/let W163 (shen/shen.in-> W161)
                                                   (shen/let W164
                                                             (shen/shen.<semantics>
                                                              W163)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W164)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W165
                                                                        (shen/shen.<-out
                                                                         W164)
                                                                        (shen/let
                                                                         W166
                                                                         (shen/shen.in->
                                                                          W164)
                                                                         (shen/let
                                                                          W167
                                                                          (shen/shen.<sc>
                                                                           W166)
                                                                          (shen/if
                                                                           (shen/shen.parse-failure?
                                                                            W167)
                                                                           (shen/shen.parse-failure)
                                                                           (shen/let
                                                                            W168
                                                                            (shen/shen.in->
                                                                             W167)
                                                                            (shen/shen.comb
                                                                             W168
                                                                             (list
                                                                              W162
                                                                              W165)))))))))))))
            (shen/if (shen/shen.parse-failure? W160)
                     (shen/let W169
                               (shen/let W170 (shen/shen.<syntax> V159)
                                         (shen/if
                                          (shen/shen.parse-failure? W170)
                                          (shen/shen.parse-failure)
                                          (shen/let W171 (shen/shen.<-out W170)
                                                    (shen/let W172
                                                              (shen/shen.in->
                                                               W170)
                                                              (shen/let W173
                                                                        (shen/shen.<sc>
                                                                         W172)
                                                                        (shen/if
                                                                         (shen/shen.parse-failure?
                                                                          W173)
                                                                         (shen/shen.parse-failure)
                                                                         (shen/let
                                                                          W174
                                                                          (shen/shen.in->
                                                                           W173)
                                                                          (shen/shen.comb
                                                                           W174
                                                                           (list
                                                                            W171
                                                                            (shen/shen.autocomplete
                                                                             W171))))))))))
                               (shen/if (shen/shen.parse-failure? W169)
                                        (shen/shen.parse-failure) W169))
                     W160)))
(defun shen/shen.autocomplete (V175)
  (shen/cond
   ((shen/and (shen/cons? V175)
              (shen/and (shen/internal/predicate->shen (null (nthcdr 1 V175)))
                        (shen/shen.non-terminal? (shen/hd V175))))
    (shen/hd V175))
   ((shen/and (shen/cons? V175) (shen/shen.non-terminal? (shen/hd V175)))
    (list 'append (shen/hd V175) (shen/shen.autocomplete (nthcdr 1 V175))))
   ((shen/cons? V175)
    (list 'cons (shen/shen.autocomplete (shen/hd V175))
          (shen/shen.autocomplete (nthcdr 1 V175))))
   (shen/true V175)))
(defun shen/shen.non-terminal? (V176)
  (shen/and (shen/symbol? V176)
            (shen/let W177 (shen/explode V176)
                      (shen/compile
                       (shen/lambda Z178 (shen/shen.<non-terminal?> Z178)) W177))))
(defun shen/shen.<non-terminal?> (V179)
  (shen/let W180
            (shen/let W181 (shen/shen.<packagenames> V179)
                      (shen/if (shen/shen.parse-failure? W181)
                               (shen/shen.parse-failure)
                               (shen/let W182 (shen/shen.in-> W181)
                                         (shen/let W183
                                                   (shen/shen.<non-terminal-name>
                                                    W182)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W183)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W184
                                                              (shen/shen.in->
                                                               W183)
                                                              (shen/shen.comb
                                                               W184 'true)))))))
            (shen/if (shen/shen.parse-failure? W180)
                     (shen/let W185
                               (shen/let W186
                                         (shen/shen.<non-terminal-name> V179)
                                         (shen/if
                                          (shen/shen.parse-failure? W186)
                                          (shen/shen.parse-failure)
                                          (shen/let W187 (shen/shen.in-> W186)
                                                    (shen/shen.comb W187 'true))))
                               (shen/if (shen/shen.parse-failure? W185)
                                        (shen/let W188
                                                  (shen/let W189 (shen/<!> V179)
                                                            (shen/if
                                                             (shen/shen.parse-failure?
                                                              W189)
                                                             (shen/shen.parse-failure)
                                                             (shen/let W190
                                                                       (shen/shen.in->
                                                                        W189)
                                                                       (shen/shen.comb
                                                                        W190
                                                                        'false))))
                                                  (shen/if
                                                   (shen/shen.parse-failure?
                                                    W188)
                                                   (shen/shen.parse-failure)
                                                   W188))
                                        W185))
                     W180)))
(defun shen/shen.<packagenames> (V191)
  (shen/let W192
            (shen/let W193 (shen/shen.<packagename> V191)
                      (shen/if (shen/shen.parse-failure? W193)
                               (shen/shen.parse-failure)
                               (shen/let W194 (shen/shen.in-> W193)
                                         (shen/if (shen/shen.hds=? W194 ".")
                                                  (shen/let W195
                                                            (shen/tail W194)
                                                            (shen/let W196
                                                                      (shen/shen.<packagenames>
                                                                       W195)
                                                                      (shen/if
                                                                       (shen/shen.parse-failure?
                                                                        W196)
                                                                       (shen/shen.parse-failure)
                                                                       (shen/let
                                                                        W197
                                                                        (shen/shen.in->
                                                                         W196)
                                                                        (shen/shen.comb
                                                                         W197
                                                                         'shen.skip)))))
                                                  (shen/shen.parse-failure)))))
            (shen/if (shen/shen.parse-failure? W192)
                     (shen/let W198
                               (shen/let W199 (shen/shen.<packagename> V191)
                                         (shen/if
                                          (shen/shen.parse-failure? W199)
                                          (shen/shen.parse-failure)
                                          (shen/let W200 (shen/shen.in-> W199)
                                                    (shen/if
                                                     (shen/shen.hds=? W200 ".")
                                                     (shen/let W201
                                                               (shen/tail W200)
                                                               (shen/shen.comb
                                                                W201 'shen.skip))
                                                     (shen/shen.parse-failure)))))
                               (shen/if (shen/shen.parse-failure? W198)
                                        (shen/shen.parse-failure) W198))
                     W192)))
(defun shen/shen.<packagename> (V202)
  (shen/let W203
            (shen/let W204 (shen/shen.<packagechar> V202)
                      (shen/if (shen/shen.parse-failure? W204)
                               (shen/shen.parse-failure)
                               (shen/let W205 (shen/shen.in-> W204)
                                         (shen/let W206
                                                   (shen/shen.<packagename> W205)
                                                   (shen/if
                                                    (shen/shen.parse-failure?
                                                     W206)
                                                    (shen/shen.parse-failure)
                                                    (shen/let W207
                                                              (shen/shen.in->
                                                               W206)
                                                              (shen/shen.comb
                                                               W207 'shen.skip)))))))
            (shen/if (shen/shen.parse-failure? W203)
                     (shen/let W208
                               (shen/let W209 (shen/<e> V202)
                                         (shen/if
                                          (shen/shen.parse-failure? W209)
                                          (shen/shen.parse-failure)
                                          (shen/let W210 (shen/shen.in-> W209)
                                                    (shen/shen.comb W210
                                                                    'shen.skip))))
                               (shen/if (shen/shen.parse-failure? W208)
                                        (shen/shen.parse-failure) W208))
                     W203)))
(defun shen/shen.<packagechar> (V211)
  (shen/let W212
            (shen/if (shen/cons? V211)
                     (shen/let W213 (shen/head V211)
                               (shen/let W214 (shen/tail V211)
                                         (shen/if (shen/not (shen/= W213 "."))
                                                  (shen/shen.comb W214
                                                                  'shen.skip)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W212) (shen/shen.parse-failure)
                     W212)))
(defun shen/shen.<non-terminal-name> (V215)
  (shen/let W216
            (shen/if (shen/shen.hds=? V215 "<")
                     (shen/let W217 (shen/tail V215)
                               (shen/let W218 (shen/<!> W217)
                                         (shen/if
                                          (shen/shen.parse-failure? W218)
                                          (shen/shen.parse-failure)
                                          (shen/let W219 (shen/shen.<-out W218)
                                                    (shen/let W220
                                                              (shen/shen.in->
                                                               W218)
                                                              (shen/if
                                                               (shen/let W221
                                                                         (shen/reverse
                                                                          W219)
                                                                         (shen/and
                                                                          (shen/cons?
                                                                           W221)
                                                                          (shen/=
                                                                           (shen/hd
                                                                            W221)
                                                                           ">")))
                                                               (shen/shen.comb
                                                                W220 'shen.skip)
                                                               (shen/shen.parse-failure)))))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W216) (shen/shen.parse-failure)
                     W216)))
(defun shen/shen.semicolon? (V222) (shen/= V222 (shen/intern ";")))
(defun shen/shen.<colon-equal> (V223)
  (shen/let W224
            (shen/if (shen/cons? V223)
                     (shen/let W225 (shen/head V223)
                               (shen/let W226 (shen/tail V223)
                                         (shen/if (shen/shen.colon-equal? W225)
                                                  (shen/shen.comb W226
                                                                  'shen.skip)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W224) (shen/shen.parse-failure)
                     W224)))
(defun shen/shen.colon-equal? (V227) (shen/= (shen/intern ":=") V227))
(defun shen/shen.<syntax> (V228)
  (shen/let W229
            (shen/let W230 (shen/shen.<syntax-item> V228)
                      (shen/if (shen/shen.parse-failure? W230)
                               (shen/shen.parse-failure)
                               (shen/let W231 (shen/shen.<-out W230)
                                         (shen/let W232 (shen/shen.in-> W230)
                                                   (shen/let W233
                                                             (shen/shen.<syntax>
                                                              W232)
                                                             (shen/if
                                                              (shen/shen.parse-failure?
                                                               W233)
                                                              (shen/shen.parse-failure)
                                                              (shen/let W234
                                                                        (shen/shen.<-out
                                                                         W233)
                                                                        (shen/let
                                                                         W235
                                                                         (shen/shen.in->
                                                                          W233)
                                                                         (shen/shen.comb
                                                                          W235
                                                                          (append
                                                                           (list
                                                                            W231)
                                                                           W234))))))))))
            (shen/if (shen/shen.parse-failure? W229)
                     (shen/let W236
                               (shen/let W237 (shen/shen.<syntax-item> V228)
                                         (shen/if
                                          (shen/shen.parse-failure? W237)
                                          (shen/shen.parse-failure)
                                          (shen/let W238 (shen/shen.<-out W237)
                                                    (shen/let W239
                                                              (shen/shen.in->
                                                               W237)
                                                              (shen/shen.comb
                                                               W239 (list W238))))))
                               (shen/if (shen/shen.parse-failure? W236)
                                        (shen/shen.parse-failure) W236))
                     W229)))
(defun shen/shen.<syntax-item> (V240)
  (shen/let W241
            (shen/if (shen/cons? V240)
                     (shen/let W242 (shen/head V240)
                               (shen/let W243 (shen/tail V240)
                                         (shen/if (shen/shen.syntax-item? W242)
                                                  (shen/shen.comb W243 W242)
                                                  (shen/shen.parse-failure))))
                     (shen/shen.parse-failure))
            (shen/if (shen/shen.parse-failure? W241) (shen/shen.parse-failure)
                     W241)))
(defun shen/shen.syntax-item? (V246)
  (shen/cond ((shen/shen.colon-equal? V246) 'false)
             ((shen/shen.semicolon? V246) 'false) ((shen/atom? V246) 'true)
             ((shen/and (shen/cons? V246)
                        (shen/and (shen/= 'cons (shen/hd V246))
                                  (shen/and (shen/cons? (nthcdr 1 V246))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V246))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V246)))))))
              (shen/and (shen/shen.syntax-item? (shen/hd (nthcdr 1 V246)))
                        (shen/shen.syntax-item? (shen/hd (nthcdr 2 V246)))))
             (shen/true 'false)))
(defun shen/shen.<semantics> (V247)
  (shen/let W248
            (shen/let W249 (shen/shen.<colon-equal> V247)
                      (shen/if (shen/shen.parse-failure? W249)
                               (shen/shen.parse-failure)
                               (shen/let W250 (shen/shen.in-> W249)
                                         (shen/if (shen/cons? W250)
                                                  (shen/let W251
                                                            (shen/head W250)
                                                            (shen/let W252
                                                                      (shen/tail
                                                                       W250)
                                                                      (shen/if
                                                                       (shen/shen.hds=?
                                                                        W252
                                                                        'where)
                                                                       (shen/let
                                                                        W253
                                                                        (shen/tail
                                                                         W252)
                                                                        (shen/if
                                                                         (shen/cons?
                                                                          W253)
                                                                         (shen/let
                                                                          W254
                                                                          (shen/head
                                                                           W253)
                                                                          (shen/let
                                                                           W255
                                                                           (shen/tail
                                                                            W253)
                                                                           (shen/if
                                                                            (shen/not
                                                                             (shen/shen.semicolon?
                                                                              W251))
                                                                            (shen/shen.comb
                                                                             W255
                                                                             (list
                                                                              'where
                                                                              W254
                                                                              W251))
                                                                            (shen/shen.parse-failure))))
                                                                         (shen/shen.parse-failure)))
                                                                       (shen/shen.parse-failure))))
                                                  (shen/shen.parse-failure)))))
            (shen/if (shen/shen.parse-failure? W248)
                     (shen/let W256
                               (shen/let W257 (shen/shen.<colon-equal> V247)
                                         (shen/if
                                          (shen/shen.parse-failure? W257)
                                          (shen/shen.parse-failure)
                                          (shen/let W258 (shen/shen.in-> W257)
                                                    (shen/if (shen/cons? W258)
                                                             (shen/let W259
                                                                       (shen/head
                                                                        W258)
                                                                       (shen/let
                                                                        W260
                                                                        (shen/tail
                                                                         W258)
                                                                        (shen/if
                                                                         (shen/not
                                                                          (shen/shen.semicolon?
                                                                           W259))
                                                                         (shen/shen.comb
                                                                          W260
                                                                          W259)
                                                                         (shen/shen.parse-failure))))
                                                             (shen/shen.parse-failure)))))
                               (shen/if (shen/shen.parse-failure? W256)
                                        (shen/shen.parse-failure) W256))
                     W248)))
(defun shen/shen.c-rules->shen (V269 V270 V271)
  (shen/cond
   ((shen/internal/predicate->shen (null V271)) (list 'shen.parse-failure))
   ((shen/cons? V271)
    (shen/shen.combine-c-code (shen/shen.c-rule->shen V269 (shen/hd V271) V270)
                              (shen/shen.c-rules->shen V269 V270 (nthcdr 1 V271))))
   (shen/true (shen/simple-error "implementation error in shen.c-rules->shen\n"))))
(defun shen/shen.parse-failure nil (shen/fail))
(defun shen/shen.combine-c-code (V272 V273)
  (list 'let 'Result V272
        (list 'if (list 'shen.parse-failure? 'Result) V273 'Result)))
(defun shen/shen.c-rule->shen (V280 V281 V282)
  (shen/cond
   ((shen/and (shen/cons? V281)
              (shen/and (shen/cons? (nthcdr 1 V281))
                        (shen/internal/predicate->shen (null (nthcdr 2 V281)))))
    (shen/shen.yacc-syntax V280 V282 (shen/hd V281) (shen/hd (nthcdr 1 V281))))
   (shen/true (shen/simple-error "implementation error in shen.c-rule->shen\n"))))
(defun shen/shen.yacc-syntax (V291 V292 V293 V294)
  (shen/cond
   ((shen/and (shen/internal/predicate->shen (null V293))
              (shen/and (shen/cons? V294)
                        (shen/and (shen/= 'where (shen/hd V294))
                                  (shen/and (shen/cons? (nthcdr 1 V294))
                                            (shen/and
                                             (shen/cons? (nthcdr 2 V294))
                                             (shen/internal/predicate->shen
                                              (null (nthcdr 3 V294))))))))
    (list 'if (shen/shen.process-yacc-semantics (shen/hd (nthcdr 1 V294)))
          (shen/shen.yacc-syntax V291 V292 nil (shen/hd (nthcdr 2 V294)))
          (list 'shen.parse-failure)))
   ((shen/internal/predicate->shen (null V293))
    (shen/shen.yacc-semantics V291 V292 V294))
   ((shen/cons? V293)
    (shen/if (shen/shen.non-terminal? (shen/hd V293))
             (shen/shen.non-terminalcode V291 V292 (shen/hd V293)
                                         (nthcdr 1 V293) V294)
             (shen/if (shen/variable? (shen/hd V293))
                      (shen/shen.variablecode V291 V292 (shen/hd V293)
                                              (nthcdr 1 V293) V294)
                      (shen/if (shen/= '_ (shen/hd V293))
                               (shen/shen.wildcardcode V291 V292 (shen/hd V293)
                                                       (nthcdr 1 V293) V294)
                               (shen/if (shen/atom? (shen/hd V293))
                                        (shen/shen.terminalcode V291 V292
                                                                (shen/hd V293)
                                                                (nthcdr 1 V293)
                                                                V294)
                                        (shen/if (shen/cons? (shen/hd V293))
                                                 (shen/shen.conscode V291 V292
                                                                     (shen/hd
                                                                      V293)
                                                                     (nthcdr 1
                                                                             V293)
                                                                     V294)
                                                 (shen/simple-error
                                                  "implementation error in shen.yacc-syntax\n")))))))
   (shen/true (shen/simple-error "implementation error in shen.yacc-syntax\n"))))
(defun shen/shen.non-terminalcode (V295 V296 V297 V298 V299)
  (shen/let W300 (shen/concat 'Parse V297)
            (shen/let W301 (shen/concat 'Action V297)
                      (shen/let W302 (shen/concat 'Remainder V297)
                                (list 'let W300 (list V297 V296)
                                      (list 'if (list 'shen.parse-failure? W300)
                                            (list 'shen.parse-failure)
                                            (shen/let W303
                                                      (list 'let W302
                                                            (list 'shen.in->
                                                                  W300)
                                                            (shen/shen.yacc-syntax
                                                             V295 W302 V298 V299))
                                                      (shen/if
                                                       (shen/or
                                                        (shen/shen.occurs? V297
                                                                           V299)
                                                        (shen/shen.occurs? W301
                                                                           V299))
                                                       (list 'let W301
                                                             (list 'shen.<-out
                                                                   W300)
                                                             W303)
                                                       W303))))))))
(defun shen/shen.variablecode (V304 V305 V306 V307 V308)
  (shen/let W309 (shen/gensym 'Remainder)
            (list 'if (list 'cons? V305)
                  (shen/let W310
                            (list 'let W309 (list 'tail V305)
                                  (shen/shen.yacc-syntax V304 W309 V307 V308))
                            (shen/if (shen/shen.occurs? V306 V308)
                                     (list 'let V306 (list 'head V305) W310)
                                     W310))
                  (list 'shen.parse-failure))))
(defun shen/shen.wildcardcode (V311 V312 V313 V314 V315)
  (shen/let W316 (shen/gensym 'Remainder)
            (list 'if (list 'cons? V312)
                  (list 'let W316 (list 'tail V312)
                        (shen/shen.yacc-syntax V311 W316 V314 V315))
                  (list 'shen.parse-failure))))
(defun shen/shen.terminalcode (V317 V318 V319 V320 V321)
  (shen/let W322 (shen/gensym 'Remainder)
            (list 'if (list 'shen.hds=? V318 V319)
                  (list 'let W322 (list 'tail V318)
                        (shen/shen.yacc-syntax V317 W322 V320 V321))
                  (list 'shen.parse-failure))))
(defun shen/shen.hds=? (V330 V331)
  (shen/cond ((shen/and (shen/cons? V330) (shen/= (shen/hd V330) V331)) 'true)
             (shen/true 'false)))
(defun shen/shen.conscode (V332 V333 V334 V335 V336)
  (shen/let W337 (shen/gensym 'Remainder)
            (shen/let W338 (shen/gensym 'Hd)
                      (shen/let W339 (shen/gensym 'Tl)
                                (list 'if (list 'shen.ccons? V333)
                                      (list 'let W338 (list 'head V333) W339
                                            (list 'tail V333)
                                            (shen/shen.yacc-syntax V332 W338
                                                                   (shen/append
                                                                    (shen/shen.decons
                                                                     V334)
                                                                    (list '<end>))
                                                                   (list
                                                                    'shen.processed
                                                                    (shen/shen.yacc-syntax
                                                                     V332 W339
                                                                     V335 V336))))
                                      (list 'shen.parse-failure))))))
(defun shen/shen.ccons? (V348)
  (shen/cond ((shen/and (shen/cons? V348) (shen/cons? (shen/hd V348))) 'true)
             (shen/true 'false)))
(defun shen/shen.decons (V349)
  (shen/cond
   ((shen/and (shen/cons? V349)
              (shen/and (shen/= 'cons (shen/hd V349))
                        (shen/and (shen/cons? (nthcdr 1 V349))
                                  (shen/and (shen/cons? (nthcdr 2 V349))
                                            (shen/internal/predicate->shen
                                             (null (nthcdr 3 V349)))))))
    (append (list (shen/hd (nthcdr 1 V349)))
            (shen/shen.decons (shen/hd (nthcdr 2 V349)))))
   (shen/true V349)))
(defun shen/shen.comb (V350 V351) (list V350 V351))
(defun shen/shen.yacc-semantics (V356 V357 V358)
  (shen/cond
   ((shen/and (shen/cons? V358)
              (shen/and (shen/= 'shen.processed (shen/hd V358))
                        (shen/and (shen/cons? (nthcdr 1 V358))
                                  (shen/internal/predicate->shen
                                   (null (nthcdr 2 V358))))))
    (shen/hd (nthcdr 1 V358)))
   (shen/true
    (shen/let W359 (shen/shen.process-yacc-semantics V358)
              (shen/let W360 (shen/shen.use-type-info V356 W359)
                        (list 'shen.comb V357 W360))))))
(defun shen/shen.use-type-info (V364 V365)
  (shen/cond
   ((shen/and (shen/cons? V364)
              (shen/and (shen/= '{ (shen/hd V364))
                        (shen/and (shen/cons? (nthcdr 1 V364))
                                  (shen/and
                                   (shen/cons? (shen/hd (nthcdr 1 V364)))
                                   (shen/and
                                    (shen/= 'list
                                            (shen/hd (shen/hd (nthcdr 1 V364))))
                                    (shen/and
                                     (shen/cons?
                                      (nthcdr 1 (shen/hd (nthcdr 1 V364))))
                                     (shen/and
                                      (shen/internal/predicate->shen
                                       (null
                                        (nthcdr 2 (shen/hd (nthcdr 1 V364)))))
                                      (shen/and (shen/cons? (nthcdr 2 V364))
                                                (shen/and
                                                 (shen/= '-->
                                                         (shen/hd
                                                          (nthcdr 2 V364)))
                                                 (shen/and
                                                  (shen/cons? (nthcdr 3 V364))
                                                  (shen/and
                                                   (shen/cons?
                                                    (shen/hd (nthcdr 3 V364)))
                                                   (shen/and
                                                    (shen/= 'str
                                                            (shen/hd
                                                             (shen/hd
                                                              (nthcdr 3 V364))))
                                                    (shen/and
                                                     (shen/cons?
                                                      (nthcdr 1
                                                              (shen/hd
                                                               (nthcdr 3 V364))))
                                                     (shen/and
                                                      (shen/cons?
                                                       (shen/hd
                                                        (nthcdr 1
                                                                (shen/hd
                                                                 (nthcdr 3 V364)))))
                                                      (shen/and
                                                       (shen/= 'list
                                                               (shen/hd
                                                                (shen/hd
                                                                 (nthcdr 1
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           3
                                                                           V364))))))
                                                       (shen/and
                                                        (shen/cons?
                                                         (nthcdr 1
                                                                 (shen/hd
                                                                  (nthcdr 1
                                                                          (shen/hd
                                                                           (nthcdr
                                                                            3
                                                                            V364))))))
                                                        (shen/and
                                                         (shen/internal/predicate->shen
                                                          (null
                                                           (nthcdr 2
                                                                   (shen/hd
                                                                    (nthcdr 1
                                                                            (shen/hd
                                                                             (nthcdr
                                                                              3
                                                                              V364)))))))
                                                         (shen/and
                                                          (shen/cons?
                                                           (nthcdr 2
                                                                   (shen/hd
                                                                    (nthcdr 3
                                                                            V364))))
                                                          (shen/and
                                                           (shen/internal/predicate->shen
                                                            (null
                                                             (nthcdr 3
                                                                     (shen/hd
                                                                      (nthcdr 3
                                                                              V364)))))
                                                           (shen/and
                                                            (shen/cons?
                                                             (nthcdr 4 V364))
                                                            (shen/and
                                                             (shen/= '}
                                                                     (shen/hd
                                                                      (nthcdr 4
                                                                              V364)))
                                                             (shen/and
                                                              (shen/internal/predicate->shen
                                                               (null
                                                                (nthcdr 5 V364)))
                                                              (shen/and
                                                               (shen/=
                                                                (shen/hd
                                                                 (nthcdr 1
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           1
                                                                           V364))))
                                                                (shen/hd
                                                                 (nthcdr 1
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           1
                                                                           (shen/hd
                                                                            (nthcdr
                                                                             3
                                                                             V364)))))))
                                                               (shen/shen.monomorphic?
                                                                (shen/hd
                                                                 (nthcdr 2
                                                                         (shen/hd
                                                                          (nthcdr
                                                                           3
                                                                           V364))))))))))))))))))))))))))))
    (append (list 'type V365) (nthcdr 2 (shen/hd (nthcdr 3 V364)))))
   (shen/true V365)))
(defun shen/shen.monomorphic? (V368)
  (shen/cond ((shen/variable? V368) 'false)
             ((shen/cons? V368)
              (shen/and (shen/shen.monomorphic? (shen/hd V368))
                        (shen/shen.monomorphic? (nthcdr 1 V368))))
             (shen/true 'true)))
(defun shen/shen.process-yacc-semantics (V369)
  (shen/cond
   ((shen/and (shen/cons? V369)
              (shen/and (shen/= 'protect (shen/hd V369))
                        (shen/and (shen/cons? (nthcdr 1 V369))
                                  (shen/and
                                   (shen/internal/predicate->shen
                                    (null (nthcdr 2 V369)))
                                   (shen/shen.non-terminal?
                                    (shen/hd (nthcdr 1 V369)))))))
    (shen/hd (nthcdr 1 V369)))
   ((shen/cons? V369)
    (shen/map (shen/lambda Z370 (shen/shen.process-yacc-semantics Z370)) V369))
   ((shen/shen.non-terminal? V369) (shen/concat 'Action V369)) (shen/true V369)))
(defun shen/shen.<-out (V373)
  (shen/cond
   ((shen/and (shen/cons? V373)
              (shen/and (shen/cons? (nthcdr 1 V373))
                        (shen/internal/predicate->shen (null (nthcdr 2 V373)))))
    (shen/hd (nthcdr 1 V373)))
   (shen/true (shen/hd (nthcdr 1 V373)))))
(defun shen/shen.in-> (V374) (shen/hd V374))
(defun shen/<!> (V375) (list nil V375))
(defun shen/<e> (V376) (list V376 nil))
(defun shen/<end> (V379)
  (shen/cond ((shen/internal/predicate->shen (null V379)) (list nil nil))
             (shen/true (shen/shen.parse-failure))))
(defun shen/declare (V5938 V5939)
  (shen/let W5940 (shen/shen.rectify-type V5939)
            (shen/let W5941
                      (shen/internal/apply-function-expression
                       (shen/internal/apply-function-expression
                        (shen/internal/apply-function-expression
                         (shen/internal/apply-function-expression
                          (shen/lambda Z5942
                                       (shen/lambda Z5943
                                                    (shen/lambda Z5944
                                                                 (shen/lambda
                                                                  Z5945
                                                                  (shen/do
                                                                   (shen/shen.incinfs)
                                                                   (shen/shen.variancy
                                                                    (shen/receive
                                                                     (shen/shen.deref
                                                                      V5938
                                                                      Z5942))
                                                                    (shen/receive
                                                                     (shen/shen.deref
                                                                      W5940
                                                                      Z5942))
                                                                    Z5942 Z5943
                                                                    Z5944 Z5945))))))
                          (list (shen/shen.prolog-vector)))
                         (list (shen/@v 'true (shen/@v 0 (shen/vector 0)))))
                        (list 0))
                       (list (shen/freeze 'true)))
                      (shen/let W5946
                                (shen/eval-kl
                                 (shen/shen.prolog-abstraction V5939))
                                (shen/let W5947
                                          (shen/set 'shen.*sigf*
                                                    (shen/shen.assoc-> V5938
                                                                       W5946
                                                                       (shen/value
                                                                        'shen.*sigf*)))
                                          V5938)))))
(defun shen/shen.variancy (V5948 V5949 V5950 V5951 V5952 V5953)
  (shen/if (shen/shen.unlocked? V5951)
           (shen/let W5954 (shen/shen.newpv V5950)
                     (shen/shen.gc V5950
                                   (shen/do (shen/shen.incinfs)
                                            (shen/shen.system-S-h V5948 W5954
                                                                  nil V5950
                                                                  V5951 V5952
                                                                  (shen/freeze
                                                                   (shen/shen.variants?
                                                                    V5948 W5954
                                                                    V5949 V5950
                                                                    V5951 V5952
                                                                    V5953))))))
           'false))
(defun shen/shen.variants? (V5955 V5956 V5957 V5958 V5959 V5960 V5961)
  (shen/let W5962 (1+ V5960)
            (shen/let W5963
                      (shen/if (shen/shen.unlocked? V5959)
                               (shen/let W5964 (shen/shen.lazyderef V5956 V5958)
                                         (shen/let W5965
                                                   (shen/freeze
                                                    (shen/do (shen/shen.incinfs)
                                                             (shen/shen.cut
                                                              V5958 V5959 W5962
                                                              V5961)))
                                                   (shen/if
                                                    (shen/= W5964 'symbol)
                                                    (shen/thaw W5965)
                                                    (shen/if
                                                     (shen/shen.pvar? W5964)
                                                     (shen/shen.bind! W5964
                                                                      'symbol
                                                                      V5958
                                                                      W5965)
                                                     'false))))
                               'false)
                      (shen/if (shen/= W5963 'false)
                               (shen/let W5966
                                         (shen/if (shen/shen.unlocked? V5959)
                                                  (shen/do (shen/shen.incinfs)
                                                           (shen/is! V5956 V5957
                                                                     V5958 V5959
                                                                     W5962 V5961))
                                                  'false)
                                         (shen/if (shen/= W5966 'false)
                                                  (shen/let W5967
                                                            (shen/if
                                                             (shen/shen.unlocked?
                                                              V5959)
                                                             (shen/let W5968
                                                                       (shen/shen.newpv
                                                                        V5958)
                                                                       (shen/shen.gc
                                                                        V5958
                                                                        (shen/do
                                                                         (shen/shen.incinfs)
                                                                         (shen/is
                                                                          W5968
                                                                          (shen/pr
                                                                           (shen/cn
                                                                            "warning: changing the type of "
                                                                            (shen/shen.app
                                                                             (shen/shen.deref
                                                                              V5955
                                                                              V5958)
                                                                             " may create errors\n"
                                                                             'shen.a))
                                                                           (shen/stoutput))
                                                                          V5958
                                                                          V5959
                                                                          W5962
                                                                          V5961))))
                                                             'false)
                                                            (shen/if
                                                             (shen/= W5967
                                                                     'false)
                                                             (shen/shen.unlock
                                                              V5959 W5962)
                                                             W5967))
                                                  W5966))
                               W5963))))
(defun shen/shen.prolog-abstraction (V5969)
  (shen/let W5970 (shen/gensym 'B)
            (shen/let W5971 (shen/gensym 'L)
                      (shen/let W5972 (shen/gensym 'Key)
                                (shen/let W5973 (shen/gensym 'C)
                                          (shen/let W5974 (shen/gensym 'V)
                                                    (shen/let W5975
                                                              (shen/shen.extract-vars
                                                               V5969)
                                                              (list 'lambda
                                                                    W5974
                                                                    (list
                                                                     'lambda
                                                                     W5970
                                                                     (list
                                                                      'lambda
                                                                      W5971
                                                                      (list
                                                                       'lambda
                                                                       W5972
                                                                       (list
                                                                        'lambda
                                                                        W5973
                                                                        (shen/shen.stpart
                                                                         W5975
                                                                         (list
                                                                          'is!
                                                                          W5974
                                                                          (shen/shen.rcons_form
                                                                           V5969)
                                                                          W5970
                                                                          W5971
                                                                          W5972
                                                                          W5973)
                                                                         W5970)))))))))))))
(defun shen/shen.demod (V5976)
  (shen/let W5977 (shen/value 'shen.*demodulation-function*)
            (shen/internal/apply-higher-order-function W5977 (list V5976))))
(provide 'shen-elisp)
